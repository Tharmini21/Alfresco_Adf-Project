/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { AuthenticationService, ThumbnailService, SearchTextInputComponent } from '@alfresco/adf-core';
import { Component, EventEmitter, Input, Output, QueryList, ViewEncapsulation, ViewChild, ViewChildren, ContentChild } from '@angular/core';
import { Subject } from 'rxjs';
import { SearchComponent } from './search.component';
import { MatListItem } from '@angular/material/list';
import { EmptySearchResultComponent } from './empty-search-result.component';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@alfresco/adf-core';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from './search.component';
import * as ɵngcc4 from '@angular/material/list';
import * as ɵngcc5 from '@angular/material/icon';
import * as ɵngcc6 from '@angular/material/core';
import * as ɵngcc7 from '@ngx-translate/core';

const _c0 = ["searchTextInput"];
const _c1 = ["search"];
function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_h4_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "h4", 15);
    ɵngcc0.ɵɵpipe(1, "highlight");
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r14 = ɵngcc0.ɵɵnextContext();
    const idx_r10 = ctx_r14.index;
    const item_r9 = ctx_r14.$implicit;
    const ctx_r11 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵpropertyInterpolate1("id", "result_name_", idx_r10, "");
    ɵngcc0.ɵɵproperty("innerHtml", ɵngcc0.ɵɵpipeBind2(1, 3, item_r9.entry.name, ctx_r11.searchTerm), ɵngcc0.ɵɵsanitizeHtml);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate1(" ", item_r9 == null ? null : item_r9.entry.name, " ");
} }
function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_ng_template_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "h4", 15);
} if (rf & 2) {
    const ctx_r15 = ɵngcc0.ɵɵnextContext();
    const idx_r10 = ctx_r15.index;
    const item_r9 = ctx_r15.$implicit;
    ɵngcc0.ɵɵpropertyInterpolate1("id", "result_name_", idx_r10, "");
    ɵngcc0.ɵɵproperty("innerHtml", item_r9.entry.name, ɵngcc0.ɵɵsanitizeHtml);
} }
function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template(rf, ctx) { if (rf & 1) {
    const _r17 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "mat-list-item", 9);
    ɵngcc0.ɵɵlistener("blur", function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template_mat_list_item_blur_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r17); const ctx_r16 = ɵngcc0.ɵɵnextContext(4); return ctx_r16.onBlur($event); })("keyup.arrowdown", function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template_mat_list_item_keyup_arrowdown_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r17); const ctx_r18 = ɵngcc0.ɵɵnextContext(4); return ctx_r18.onRowArrowDown($event); })("keyup.arrowup", function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template_mat_list_item_keyup_arrowup_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r17); const ctx_r19 = ɵngcc0.ɵɵnextContext(4); return ctx_r19.onRowArrowUp($event); })("click", function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template_mat_list_item_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r17); const item_r9 = ctx.$implicit; const ctx_r20 = ɵngcc0.ɵɵnextContext(4); return ctx_r20.elementClicked(item_r9); })("keyup.enter", function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template_mat_list_item_keyup_enter_0_listener() { ɵngcc0.ɵɵrestoreView(_r17); const item_r9 = ctx.$implicit; const ctx_r21 = ɵngcc0.ɵɵnextContext(4); return ctx_r21.elementClicked(item_r9); })("touchend", function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template_mat_list_item_touchend_0_listener() { ɵngcc0.ɵɵrestoreView(_r17); const item_r9 = ctx.$implicit; const ctx_r22 = ɵngcc0.ɵɵnextContext(4); return ctx_r22.elementClicked(item_r9); });
    ɵngcc0.ɵɵelementStart(1, "mat-icon", 10);
    ɵngcc0.ɵɵelement(2, "img", 11);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(3, SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_h4_3_Template, 3, 6, "h4", 12);
    ɵngcc0.ɵɵtemplate(4, SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_ng_template_4_Template, 1, 2, "ng-template", null, 13, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵelementStart(6, "p", 14);
    ɵngcc0.ɵɵtext(7);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r9 = ctx.$implicit;
    const idx_r10 = ctx.index;
    const _r12 = ɵngcc0.ɵɵreference(5);
    const ctx_r7 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵpropertyInterpolate1("id", "result_option_", idx_r10, "");
    ɵngcc0.ɵɵproperty("tabindex", 0);
    ɵngcc0.ɵɵattribute("data-automation-id", "autocomplete_for_" + item_r9.entry.name);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("alt", ctx_r7.getMimeType(item_r9))("src", ctx_r7.getMimeTypeIcon(item_r9), ɵngcc0.ɵɵsanitizeUrl);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r7.highlight)("ngIfElse", _r12);
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵtextInterpolate1(" ", item_r9 == null ? null : item_r9.entry.createdByUser.displayName, " ");
} }
function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_2_ng_content_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵprojection(0, 0, ["selector", "adf-empty-search-result", "*ngIf", "isNoSearchTemplatePresent() else defaultNoResult"]);
} }
const _c2 = function (a0) { return { searchTerm: a0 }; };
function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_2_ng_template_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "p", 14);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r25 = ɵngcc0.ɵɵnextContext(5);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind2(2, 1, "SEARCH.RESULTS.NONE", ɵngcc0.ɵɵpureFunction1(4, _c2, ctx_r25.searchTerm)));
} }
function SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "mat-list-item", 16);
    ɵngcc0.ɵɵtemplate(1, SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_2_ng_content_1_Template, 1, 0, "ng-content", 17);
    ɵngcc0.ɵɵtemplate(2, SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_2_ng_template_2_Template, 3, 6, "ng-template", null, 18, ɵngcc0.ɵɵtemplateRefExtractor);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const _r24 = ɵngcc0.ɵɵreference(3);
    const ctx_r8 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r8.isNoSearchTemplatePresent())("ngIfElse", _r24);
} }
function SearchControlComponent_div_0_ng_template_6_mat_list_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "mat-list", 6);
    ɵngcc0.ɵɵtemplate(1, SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_1_Template, 8, 8, "mat-list-item", 7);
    ɵngcc0.ɵɵtemplate(2, SearchControlComponent_div_0_ng_template_6_mat_list_0_mat_list_item_2_Template, 4, 2, "mat-list-item", 8);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const data_r5 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", data_r5 == null ? null : data_r5.list == null ? null : data_r5.list.entries);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", (data_r5 == null ? null : data_r5.list == null ? null : data_r5.list.entries.length) === 0);
} }
function SearchControlComponent_div_0_ng_template_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, SearchControlComponent_div_0_ng_template_6_mat_list_0_Template, 3, 2, "mat-list", 5);
} if (rf & 2) {
    ɵngcc0.ɵɵnextContext();
    const _r1 = ɵngcc0.ɵɵreference(2);
    ɵngcc0.ɵɵproperty("ngIf", _r1 == null ? null : _r1.isSearchBarActive());
} }
function SearchControlComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r28 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div");
    ɵngcc0.ɵɵelementStart(1, "adf-search-text-input", 1, 2);
    ɵngcc0.ɵɵlistener("searchChange", function SearchControlComponent_div_0_Template_adf_search_text_input_searchChange_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r28); const ctx_r27 = ɵngcc0.ɵɵnextContext(); return ctx_r27.inputChange($event); })("reset", function SearchControlComponent_div_0_Template_adf_search_text_input_reset_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r28); const ctx_r29 = ɵngcc0.ɵɵnextContext(); return ctx_r29.onReset($event); })("selectResult", function SearchControlComponent_div_0_Template_adf_search_text_input_selectResult_1_listener() { ɵngcc0.ɵɵrestoreView(_r28); const ctx_r30 = ɵngcc0.ɵɵnextContext(); return ctx_r30.onSelectFirstResult(); })("submit", function SearchControlComponent_div_0_Template_adf_search_text_input_submit_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r28); const ctx_r31 = ɵngcc0.ɵɵnextContext(); return ctx_r31.submit.emit($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(3, "adf-search", 3, 4);
    ɵngcc0.ɵɵtemplate(6, SearchControlComponent_div_0_ng_template_6_Template, 1, 1, "ng-template");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const _r3 = ɵngcc0.ɵɵreference(5);
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("searchTerm", ctx_r0.searchTerm)("expandable", ctx_r0.expandable)("autocomplete", ctx_r0.autocomplete)("liveSearchEnabled", ctx_r0.liveSearchEnabled)("focusListener", ctx_r0.focusSubject.asObservable())("searchAutocomplete", _r3);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("maxResults", ctx_r0.liveSearchMaxResults);
} }
const _c3 = ["*"];
export class SearchControlComponent {
    constructor(authService, thumbnailService) {
        this.authService = authService;
        this.thumbnailService = thumbnailService;
        this.highlight = false;
        this.inputType = 'text';
        this.liveSearchEnabled = true;
        this.autocomplete = false;
        this.expandable = true;
        this.liveSearchMaxResults = 5;
        this.submit = new EventEmitter();
        this.searchChange = new EventEmitter();
        this.optionClicked = new EventEmitter();
        this.focusSubject = new Subject();
        this.noSearchResultTemplate = null;
        this.searchTerm = '';
        this.onDestroy$ = new Subject();
    }
    isNoSearchTemplatePresent() {
        return !!this.emptySearchTemplate;
    }
    ngOnDestroy() {
        this.onDestroy$.next(true);
        this.onDestroy$.complete();
    }
    isLoggedIn() {
        return this.authService.isEcmLoggedIn();
    }
    inputChange(value) {
        this.searchTerm = value;
        this.searchChange.emit(value);
    }
    getMimeTypeIcon(node) {
        const mimeType = this.getMimeType(node);
        return this.thumbnailService.getMimeTypeIcon(mimeType);
    }
    getMimeType(node) {
        let mimeType;
        if (node.entry.content && node.entry.content.mimeType) {
            mimeType = node.entry.content.mimeType;
        }
        if (node.entry.isFolder) {
            mimeType = 'folder';
        }
        return mimeType;
    }
    elementClicked(item) {
        if (item.entry) {
            this.optionClicked.next(item);
            this.focusSubject.next(new FocusEvent('blur'));
        }
    }
    onFocus(event) {
        this.focusSubject.next(event);
    }
    onBlur(event) {
        const nextElement = this.getNextElementSibling(event.target);
        if (!nextElement && !this.isListElement(event)) {
            this.focusSubject.next(event);
        }
    }
    onSelectFirstResult() {
        if (this.listResultElement && this.listResultElement.length > 0) {
            const firstElement = this.listResultElement.first;
            firstElement._getHostElement().focus();
        }
    }
    onRowArrowDown(event) {
        const nextElement = this.getNextElementSibling(event.target);
        if (nextElement) {
            nextElement.focus();
        }
    }
    onRowArrowUp(event) {
        const previousElement = this.getPreviousElementSibling(event.target);
        if (previousElement) {
            previousElement.focus();
        }
        else {
            this.focusSubject.next(new FocusEvent('focus'));
        }
    }
    onReset(status) {
        if (status) {
            this.searchAutocomplete.resetResults();
        }
    }
    isListElement(event) {
        return event.relatedTarget && event.relatedTarget.children[0] && event.relatedTarget.children[0].className === 'mat-list-item-content';
    }
    getNextElementSibling(node) {
        return node.nextElementSibling;
    }
    getPreviousElementSibling(node) {
        return node.previousElementSibling;
    }
}
SearchControlComponent.ɵfac = function SearchControlComponent_Factory(t) { return new (t || SearchControlComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AuthenticationService), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.ThumbnailService)); };
SearchControlComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SearchControlComponent, selectors: [["adf-search-control"]], contentQueries: function SearchControlComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, EmptySearchResultComponent, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.emptySearchTemplate = _t.first);
    } }, viewQuery: function SearchControlComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, true);
        ɵngcc0.ɵɵviewQuery(_c1, true);
        ɵngcc0.ɵɵviewQuery(MatListItem, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.searchTextInput = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.searchAutocomplete = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.listResultElement = _t);
    } }, hostAttrs: [1, "adf-search-control"], inputs: { highlight: "highlight", inputType: "inputType", liveSearchEnabled: "liveSearchEnabled", autocomplete: "autocomplete", expandable: "expandable", liveSearchMaxResults: "liveSearchMaxResults" }, outputs: { submit: "submit", searchChange: "searchChange", optionClicked: "optionClicked" }, ngContentSelectors: _c3, decls: 1, vars: 1, consts: [[4, "ngIf"], [3, "searchTerm", "expandable", "autocomplete", "liveSearchEnabled", "focusListener", "searchAutocomplete", "searchChange", "reset", "selectResult", "submit"], ["searchTextInput", ""], [1, "adf-search-result-autocomplete", 3, "maxResults"], ["search", "", "auto", "searchAutocomplete"], ["id", "autocomplete-search-result-list", 4, "ngIf"], ["id", "autocomplete-search-result-list"], ["class", "adf-search-autocomplete-item", 3, "id", "tabindex", "blur", "keyup.arrowdown", "keyup.arrowup", "click", "keyup.enter", "touchend", 4, "ngFor", "ngForOf"], ["id", "search_no_result", "data-automation-id", "search_no_result_found", 4, "ngIf"], [1, "adf-search-autocomplete-item", 3, "id", "tabindex", "blur", "keyup.arrowdown", "keyup.arrowup", "click", "keyup.enter", "touchend"], ["mat-list-icon", ""], [3, "alt", "src"], ["mat-line", "", "class", "adf-search-fixed-text", 3, "id", "innerHtml", 4, "ngIf", "ngIfElse"], ["elseBlock", ""], ["mat-line", "", 1, "adf-search-fixed-text"], ["mat-line", "", 1, "adf-search-fixed-text", 3, "id", "innerHtml"], ["id", "search_no_result", "data-automation-id", "search_no_result_found"], [4, "ngIf", "ngIfElse"], ["defaultNoResult", ""]], template: function SearchControlComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef();
        ɵngcc0.ɵɵtemplate(0, SearchControlComponent_div_0_Template, 7, 7, "div", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.isLoggedIn());
    } }, directives: [ɵngcc2.NgIf, ɵngcc1.SearchTextInputComponent, ɵngcc3.SearchComponent, ɵngcc4.MatList, ɵngcc2.NgForOf, ɵngcc4.MatListItem, ɵngcc5.MatIcon, ɵngcc4.MatListIconCssMatStyler, ɵngcc6.MatLine], pipes: [ɵngcc1.HighlightPipe, ɵngcc7.TranslatePipe], encapsulation: 2 });
SearchControlComponent.ctorParameters = () => [
    { type: AuthenticationService },
    { type: ThumbnailService }
];
SearchControlComponent.propDecorators = {
    highlight: [{ type: Input }],
    inputType: [{ type: Input }],
    liveSearchEnabled: [{ type: Input }],
    autocomplete: [{ type: Input }],
    expandable: [{ type: Input }],
    liveSearchMaxResults: [{ type: Input }],
    submit: [{ type: Output }],
    searchChange: [{ type: Output }],
    optionClicked: [{ type: Output }],
    searchTextInput: [{ type: ViewChild, args: ['searchTextInput',] }],
    searchAutocomplete: [{ type: ViewChild, args: ['search',] }],
    listResultElement: [{ type: ViewChildren, args: [MatListItem,] }],
    emptySearchTemplate: [{ type: ContentChild, args: [EmptySearchResultComponent,] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(SearchControlComponent, [{
        type: Component,
        args: [{
                selector: 'adf-search-control',
                template: "<div *ngIf=\"isLoggedIn()\">\n    <adf-search-text-input  #searchTextInput\n                            [searchTerm]= \"searchTerm\"\n                            [expandable]=\"expandable\"\n                            [autocomplete]=\"autocomplete\"\n                            [liveSearchEnabled]=\"liveSearchEnabled\"\n                            [focusListener]=\"focusSubject.asObservable()\"\n                            [searchAutocomplete]=\"auto\"\n                            (searchChange)=\"inputChange($event)\"\n                            (reset)=\"onReset($event)\"\n                            (selectResult)=\"onSelectFirstResult()\"\n                            (submit)=\"submit.emit($event)\"></adf-search-text-input>\n\n    <adf-search #search\n                #auto=\"searchAutocomplete\"\n                class=\"adf-search-result-autocomplete\"\n                [maxResults]=\"liveSearchMaxResults\">\n        <ng-template let-data>\n            <mat-list *ngIf=\"searchTextInput?.isSearchBarActive()\" id=\"autocomplete-search-result-list\">\n                <mat-list-item\n                    *ngFor=\"let item of data?.list?.entries; let idx = index\"\n                    id=\"result_option_{{idx}}\"\n                    [attr.data-automation-id]=\"'autocomplete_for_' + item.entry.name\"\n                    [tabindex]=\"0\"\n                    (blur)=\"onBlur($event)\"\n                    (keyup.arrowdown)=\"onRowArrowDown($event)\"\n                    (keyup.arrowup)=\"onRowArrowUp($event)\"\n                    class=\"adf-search-autocomplete-item\"\n                    (click)=\"elementClicked(item)\"\n                    (keyup.enter)=\"elementClicked(item)\"\n                    (touchend)=\"elementClicked(item)\">\n                    <!-- This is a comment -->\n                    <mat-icon mat-list-icon>\n                        <img [alt]=\"getMimeType(item)\" [src]=\"getMimeTypeIcon(item)\"/>\n                    </mat-icon>\n                    <h4 mat-line id=\"result_name_{{idx}}\"\n                        *ngIf=\"highlight; else elseBlock\"\n                        class=\"adf-search-fixed-text\"\n                        [innerHtml]=\"item.entry.name | highlight: searchTerm\">\n                        {{ item?.entry.name }}\n                    </h4>\n                    <ng-template #elseBlock>\n                        <h4 class=\"adf-search-fixed-text\" mat-line id=\"result_name_{{idx}}\"\n                            [innerHtml]=\"item.entry.name\"></h4>\n                    </ng-template>\n                    <p mat-line class=\"adf-search-fixed-text\"> {{item?.entry.createdByUser.displayName}} </p>\n                </mat-list-item>\n                <mat-list-item id=\"search_no_result\"\n                            data-automation-id=\"search_no_result_found\"\n                            *ngIf=\"data?.list?.entries.length === 0\">\n                    <ng-content\n                        selector=\"adf-empty-search-result\"\n                        *ngIf=\"isNoSearchTemplatePresent() else defaultNoResult\">\n                    </ng-content>\n                    <ng-template #defaultNoResult>\n                        <p mat-line class=\"adf-search-fixed-text\">{{ 'SEARCH.RESULTS.NONE' | translate:{searchTerm:\n                            searchTerm} }}</p>\n                    </ng-template>\n                </mat-list-item>\n            </mat-list>\n        </ng-template>\n    </adf-search>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                host: { class: 'adf-search-control' }
            }]
    }], function () { return [{ type: ɵngcc1.AuthenticationService }, { type: ɵngcc1.ThumbnailService }]; }, { highlight: [{
            type: Input
        }], inputType: [{
            type: Input
        }], liveSearchEnabled: [{
            type: Input
        }], autocomplete: [{
            type: Input
        }], expandable: [{
            type: Input
        }], liveSearchMaxResults: [{
            type: Input
        }], submit: [{
            type: Output
        }], searchChange: [{
            type: Output
        }], optionClicked: [{
            type: Output
        }], searchTextInput: [{
            type: ViewChild,
            args: ['searchTextInput']
        }], searchAutocomplete: [{
            type: ViewChild,
            args: ['search']
        }], listResultElement: [{
            type: ViewChildren,
            args: [MatListItem]
        }], emptySearchTemplate: [{
            type: ContentChild,
            args: [EmptySearchResultComponent]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VhcmNoLWNvbnRyb2wuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9ob21lL3RyYXZpcy9idWlsZC9BbGZyZXNjby9hbGZyZXNjby1uZzItY29tcG9uZW50cy9saWIvY29udGVudC1zZXJ2aWNlcy9zcmMvbGliL3NlYXJjaC9jb21wb25lbnRzL3NlYXJjaC1jb250cm9sLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBRUgsT0FBTyxFQUFFLHFCQUFxQixFQUFFLGdCQUFnQixFQUFFLHdCQUF3QixFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFDdkcsT0FBTyxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsS0FBSyxFQUFhLE1BQU0sRUFDakQsU0FBUyxFQUFFLGlCQUFpQixFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQWUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRWpILE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDL0IsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBQ3JELE9BQU8sRUFBRSxXQUFXLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVE3RSxNQUFNLE9BQU8sc0JBQXNCO0FBQUcsSUFnRWxDLFlBQ1csV0FBa0MsRUFDakMsZ0JBQWtDO0FBQy9DLFFBRlksZ0JBQVcsR0FB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RUcsU0FBUyxTQUFDLGlCQUFpQjtBQUMzQixpQ0FFQSxTQUFTLFNBQUMsUUFBUTtBQUNsQixnQ0FFQSxZQUFZLFNBQUMsV0FBVztBQUN4QixrQ0FFQSxZQUFZLFNBQUMsMEJBQTBCO0FBQ3hDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IEF1dGhlbnRpY2F0aW9uU2VydmljZSwgVGh1bWJuYWlsU2VydmljZSwgU2VhcmNoVGV4dElucHV0Q29tcG9uZW50IH0gZnJvbSAnQGFsZnJlc2NvL2FkZi1jb3JlJztcbmltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBJbnB1dCwgT25EZXN0cm95LCBPdXRwdXQsXG4gICAgICAgICBRdWVyeUxpc3QsIFZpZXdFbmNhcHN1bGF0aW9uLCBWaWV3Q2hpbGQsIFZpZXdDaGlsZHJlbiwgVGVtcGxhdGVSZWYsIENvbnRlbnRDaGlsZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgTm9kZUVudHJ5IH0gZnJvbSAnQGFsZnJlc2NvL2pzLWFwaSc7XG5pbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBTZWFyY2hDb21wb25lbnQgfSBmcm9tICcuL3NlYXJjaC5jb21wb25lbnQnO1xuaW1wb3J0IHsgTWF0TGlzdEl0ZW0gfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9saXN0JztcbmltcG9ydCB7IEVtcHR5U2VhcmNoUmVzdWx0Q29tcG9uZW50IH0gZnJvbSAnLi9lbXB0eS1zZWFyY2gtcmVzdWx0LmNvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLXNlYXJjaC1jb250cm9sJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vc2VhcmNoLWNvbnRyb2wuY29tcG9uZW50Lmh0bWwnLFxuICAgIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmUsXG4gICAgaG9zdDogeyBjbGFzczogJ2FkZi1zZWFyY2gtY29udHJvbCcgfVxufSlcbmV4cG9ydCBjbGFzcyBTZWFyY2hDb250cm9sQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95IHtcblxuICAgIC8qKiBUb2dnbGVzIGhpZ2hsaWdodGluZyBvZiB0aGUgc2VhcmNoIHRlcm0gaW4gdGhlIHJlc3VsdHMuICovXG4gICAgQElucHV0KClcbiAgICBoaWdobGlnaHQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBUeXBlIG9mIHRoZSBpbnB1dCBmaWVsZCB0byByZW5kZXIsIGUuZy4gXCJzZWFyY2hcIiBvciBcInRleHRcIiAoZGVmYXVsdCkuICovXG4gICAgQElucHV0KClcbiAgICBpbnB1dFR5cGU6IHN0cmluZyA9ICd0ZXh0JztcblxuICAgIC8qKiBUb2dnbGVzIFwiZmluZC1hcy15b3UtdHlwZVwiIHN1Z2dlc3Rpb25zIGZvciBwb3NzaWJsZSBtYXRjaGVzLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgbGl2ZVNlYXJjaEVuYWJsZWQ6IGJvb2xlYW4gPSB0cnVlO1xuXG4gICAgLyoqIFRvZ2dsZXMgYXV0by1jb21wbGV0aW9uIG9mIHRoZSBzZWFyY2ggaW5wdXQgZmllbGQuICovXG4gICAgQElucHV0KClcbiAgICBhdXRvY29tcGxldGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBUb2dnbGVzIHdoZXRoZXIgdG8gdXNlIGFuIGV4cGFuZGluZyBzZWFyY2ggY29udHJvbC4gSWYgZmFsc2VcbiAgICAgKiB0aGVuIGEgcmVndWxhciBpbnB1dCBpcyB1c2VkLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgZXhwYW5kYWJsZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgICAvKiogTWF4aW11bSBudW1iZXIgb2YgcmVzdWx0cyB0byBzaG93IGluIHRoZSBsaXZlIHNlYXJjaC4gKi9cbiAgICBASW5wdXQoKVxuICAgIGxpdmVTZWFyY2hNYXhSZXN1bHRzOiBudW1iZXIgPSA1O1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiB0aGUgc2VhcmNoIGlzIHN1Ym1pdHRlZCBieSBwcmVzc2luZyB0aGUgRU5URVIga2V5LlxuICAgICAqIFRoZSBzZWFyY2ggdGVybSBpcyBwcm92aWRlZCBhcyB0aGUgdmFsdWUgb2YgdGhlIGV2ZW50LlxuICAgICAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHN1Ym1pdDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBzZWFyY2ggdGVybSBpcyBjaGFuZ2VkLiBUaGUgc2VhcmNoIHRlcm0gaXMgcHJvdmlkZWRcbiAgICAgKiBpbiB0aGUgJ3ZhbHVlJyBwcm9wZXJ0eSBvZiB0aGUgcmV0dXJuZWQgb2JqZWN0LiAgSWYgdGhlIHRlcm0gaXMgbGVzc1xuICAgICAqIHRoYW4gdGhyZWUgY2hhcmFjdGVycyBpbiBsZW5ndGggdGhlbiBpdCBpcyB0cnVuY2F0ZWQgdG8gYW4gZW1wdHlcbiAgICAgKiBzdHJpbmcuXG4gICAgICovXG4gICAgQE91dHB1dCgpXG4gICAgc2VhcmNoQ2hhbmdlOiBFdmVudEVtaXR0ZXI8c3RyaW5nPiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gYSBmaWxlIGl0ZW0gZnJvbSB0aGUgbGlzdCBvZiBcImZpbmQtYXMteW91LXR5cGVcIiByZXN1bHRzIGlzIHNlbGVjdGVkLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIG9wdGlvbkNsaWNrZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgQFZpZXdDaGlsZCgnc2VhcmNoVGV4dElucHV0JylcbiAgICBzZWFyY2hUZXh0SW5wdXQ6IFNlYXJjaFRleHRJbnB1dENvbXBvbmVudDtcblxuICAgIEBWaWV3Q2hpbGQoJ3NlYXJjaCcpXG4gICAgc2VhcmNoQXV0b2NvbXBsZXRlOiBTZWFyY2hDb21wb25lbnQ7XG5cbiAgICBAVmlld0NoaWxkcmVuKE1hdExpc3RJdGVtKVxuICAgIHByaXZhdGUgbGlzdFJlc3VsdEVsZW1lbnQ6IFF1ZXJ5TGlzdDxNYXRMaXN0SXRlbT47XG5cbiAgICBAQ29udGVudENoaWxkKEVtcHR5U2VhcmNoUmVzdWx0Q29tcG9uZW50KVxuICAgIGVtcHR5U2VhcmNoVGVtcGxhdGU6IEVtcHR5U2VhcmNoUmVzdWx0Q29tcG9uZW50O1xuXG4gICAgZm9jdXNTdWJqZWN0ID0gbmV3IFN1YmplY3Q8Rm9jdXNFdmVudD4oKTtcbiAgICBub1NlYXJjaFJlc3VsdFRlbXBsYXRlOiBUZW1wbGF0ZVJlZiA8YW55PiA9IG51bGw7XG4gICAgc2VhcmNoVGVybTogc3RyaW5nID0gJyc7XG5cbiAgICBwcml2YXRlIG9uRGVzdHJveSQgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHB1YmxpYyBhdXRoU2VydmljZTogQXV0aGVudGljYXRpb25TZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHRodW1ibmFpbFNlcnZpY2U6IFRodW1ibmFpbFNlcnZpY2VcbiAgICApIHt9XG5cbiAgICBpc05vU2VhcmNoVGVtcGxhdGVQcmVzZW50KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gISF0aGlzLmVtcHR5U2VhcmNoVGVtcGxhdGU7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIHRoaXMub25EZXN0cm95JC5uZXh0KHRydWUpO1xuICAgICAgICB0aGlzLm9uRGVzdHJveSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBpc0xvZ2dlZEluKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5pc0VjbUxvZ2dlZEluKCk7XG4gICAgfVxuXG4gICAgaW5wdXRDaGFuZ2UodmFsdWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnNlYXJjaFRlcm0gPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5zZWFyY2hDaGFuZ2UuZW1pdCh2YWx1ZSk7XG4gICAgfVxuXG4gICAgZ2V0TWltZVR5cGVJY29uKG5vZGU6IE5vZGVFbnRyeSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG1pbWVUeXBlID0gdGhpcy5nZXRNaW1lVHlwZShub2RlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMudGh1bWJuYWlsU2VydmljZS5nZXRNaW1lVHlwZUljb24obWltZVR5cGUpO1xuICAgIH1cblxuICAgIGdldE1pbWVUeXBlKG5vZGU6IE5vZGVFbnRyeSk6IHN0cmluZyB7XG4gICAgICAgIGxldCBtaW1lVHlwZTogc3RyaW5nO1xuXG4gICAgICAgIGlmIChub2RlLmVudHJ5LmNvbnRlbnQgJiYgbm9kZS5lbnRyeS5jb250ZW50Lm1pbWVUeXBlKSB7XG4gICAgICAgICAgICBtaW1lVHlwZSA9IG5vZGUuZW50cnkuY29udGVudC5taW1lVHlwZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS5lbnRyeS5pc0ZvbGRlcikge1xuICAgICAgICAgICAgbWltZVR5cGUgPSAnZm9sZGVyJztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbWltZVR5cGU7XG4gICAgfVxuXG4gICAgZWxlbWVudENsaWNrZWQoaXRlbTogYW55KSB7XG4gICAgICAgIGlmIChpdGVtLmVudHJ5KSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbkNsaWNrZWQubmV4dChpdGVtKTtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNTdWJqZWN0Lm5leHQobmV3IEZvY3VzRXZlbnQoJ2JsdXInKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkZvY3VzKGV2ZW50OiBGb2N1c0V2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuZm9jdXNTdWJqZWN0Lm5leHQoZXZlbnQpO1xuICAgIH1cblxuICAgIG9uQmx1cihldmVudDogRm9jdXNFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBuZXh0RWxlbWVudDogYW55ID0gdGhpcy5nZXROZXh0RWxlbWVudFNpYmxpbmcoPEVsZW1lbnQ+IGV2ZW50LnRhcmdldCk7XG4gICAgICAgIGlmICghbmV4dEVsZW1lbnQgJiYgIXRoaXMuaXNMaXN0RWxlbWVudChldmVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuZm9jdXNTdWJqZWN0Lm5leHQoZXZlbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25TZWxlY3RGaXJzdFJlc3VsdCgpIHtcbiAgICAgICAgaWYgKCB0aGlzLmxpc3RSZXN1bHRFbGVtZW50ICYmIHRoaXMubGlzdFJlc3VsdEVsZW1lbnQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZmlyc3RFbGVtZW50OiBNYXRMaXN0SXRlbSA9IDxNYXRMaXN0SXRlbT4gdGhpcy5saXN0UmVzdWx0RWxlbWVudC5maXJzdDtcbiAgICAgICAgICAgIGZpcnN0RWxlbWVudC5fZ2V0SG9zdEVsZW1lbnQoKS5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25Sb3dBcnJvd0Rvd24oZXZlbnQ6IEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG5leHRFbGVtZW50OiBhbnkgPSB0aGlzLmdldE5leHRFbGVtZW50U2libGluZyg8RWxlbWVudD4gZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgaWYgKG5leHRFbGVtZW50KSB7XG4gICAgICAgICAgICBuZXh0RWxlbWVudC5mb2N1cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25Sb3dBcnJvd1VwKGV2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBwcmV2aW91c0VsZW1lbnQ6IGFueSA9IHRoaXMuZ2V0UHJldmlvdXNFbGVtZW50U2libGluZyg8RWxlbWVudD4gZXZlbnQudGFyZ2V0KTtcbiAgICAgICAgaWYgKHByZXZpb3VzRWxlbWVudCkge1xuICAgICAgICAgICAgcHJldmlvdXNFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZvY3VzU3ViamVjdC5uZXh0KG5ldyBGb2N1c0V2ZW50KCdmb2N1cycpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uUmVzZXQoc3RhdHVzOiBib29sZWFuKSB7XG4gICAgICAgIGlmIChzdGF0dXMpIHtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoQXV0b2NvbXBsZXRlLnJlc2V0UmVzdWx0cygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0xpc3RFbGVtZW50KGV2ZW50OiBhbnkpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgZXZlbnQucmVsYXRlZFRhcmdldC5jaGlsZHJlblswXSAmJiBldmVudC5yZWxhdGVkVGFyZ2V0LmNoaWxkcmVuWzBdLmNsYXNzTmFtZSA9PT0gJ21hdC1saXN0LWl0ZW0tY29udGVudCc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXROZXh0RWxlbWVudFNpYmxpbmcobm9kZTogRWxlbWVudCk6IEVsZW1lbnQge1xuICAgICAgICByZXR1cm4gbm9kZS5uZXh0RWxlbWVudFNpYmxpbmc7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXRQcmV2aW91c0VsZW1lbnRTaWJsaW5nKG5vZGU6IEVsZW1lbnQpOiBFbGVtZW50IHtcbiAgICAgICAgcmV0dXJuIG5vZGUucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICB9XG59XG4iXX0=
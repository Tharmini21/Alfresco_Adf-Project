/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Component, EventEmitter, Input, Output, ViewChild, ViewEncapsulation, Inject } from '@angular/core';
import { HighlightDirective, UserPreferencesService, UserPreferenceValues, InfinitePaginationComponent, NodesApiService, SitesService, UploadService, AppConfigService, ShowHeaderMode } from '@alfresco/adf-core';
import { FormControl } from '@angular/forms';
import { Pagination, SiteEntry, SitePaging } from '@alfresco/js-api';
import { DocumentListComponent } from '../document-list/components/document-list.component';
import { debounceTime, takeUntil } from 'rxjs/operators';
import { CustomResourcesService } from '../document-list/services/custom-resources.service';
import { Subject } from 'rxjs';
import { SEARCH_QUERY_SERVICE_TOKEN } from '../search/search-query-service.token';
import { SearchQueryBuilderService } from '../search/services/search-query-builder.service';
import { ContentNodeSelectorPanelService } from './content-node-selector-panel.service';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../document-list/services/custom-resources.service';
import * as ɵngcc2 from '@alfresco/adf-core';
import * as ɵngcc3 from './content-node-selector-panel.service';
import * as ɵngcc4 from '@angular/common';
import * as ɵngcc5 from '../document-list/components/document-list.component';
import * as ɵngcc6 from '@angular/material/form-field';
import * as ɵngcc7 from '@angular/material/input';
import * as ɵngcc8 from '@angular/forms';
import * as ɵngcc9 from '@angular/material/icon';
import * as ɵngcc10 from '../site-dropdown/sites-dropdown.component';
import * as ɵngcc11 from '@angular/material/button';
import * as ɵngcc12 from '../search/components/search-panel/search-panel.component';
import * as ɵngcc13 from '../breadcrumb/dropdown-breadcrumb.component';
import * as ɵngcc14 from '../directives/node-counter.directive';
import * as ɵngcc15 from './name-location-cell/name-location-cell.component';
import * as ɵngcc16 from '@ngx-translate/core';
import * as ɵngcc17 from '../search/services/search-query-builder.service';

const _c0 = ["documentList"];
function ContentNodeSelectorPanelComponent_mat_form_field_1_mat_icon_3_Template(rf, ctx) { if (rf & 1) {
    const _r12 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "mat-icon", 22);
    ɵngcc0.ɵɵlistener("click", function ContentNodeSelectorPanelComponent_mat_form_field_1_mat_icon_3_Template_mat_icon_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r12); const ctx_r11 = ɵngcc0.ɵɵnextContext(2); return ctx_r11.clear(); });
    ɵngcc0.ɵɵtext(1, "clear ");
    ɵngcc0.ɵɵelementEnd();
} }
function ContentNodeSelectorPanelComponent_mat_form_field_1_mat_icon_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "mat-icon", 23);
    ɵngcc0.ɵɵtext(1, "search ");
    ɵngcc0.ɵɵelementEnd();
} }
function ContentNodeSelectorPanelComponent_mat_form_field_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "mat-form-field", 18);
    ɵngcc0.ɵɵelement(1, "input", 19);
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵtemplate(3, ContentNodeSelectorPanelComponent_mat_form_field_1_mat_icon_3_Template, 2, 0, "mat-icon", 20);
    ɵngcc0.ɵɵtemplate(4, ContentNodeSelectorPanelComponent_mat_form_field_1_mat_icon_4_Template, 2, 0, "mat-icon", 21);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("placeholder", ɵngcc0.ɵɵpipeBind1(2, 5, "NODE_SELECTOR.SEARCH"));
    ɵngcc0.ɵɵproperty("formControl", ctx_r0.searchInput)("value", ctx_r0.searchTerm);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.searchTerm.length > 0);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.searchTerm.length === 0);
} }
function ContentNodeSelectorPanelComponent_adf_sites_dropdown_2_Template(rf, ctx) { if (rf & 1) {
    const _r14 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "adf-sites-dropdown", 24);
    ɵngcc0.ɵɵlistener("change", function ContentNodeSelectorPanelComponent_adf_sites_dropdown_2_Template_adf_sites_dropdown_change_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r14); const ctx_r13 = ɵngcc0.ɵɵnextContext(); return ctx_r13.siteChanged($event); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("placeholder", "NODE_SELECTOR.SELECT_LOCATION")("hideMyFiles", ctx_r1.dropdownHideMyFiles)("siteList", ctx_r1.dropdownSiteList)("value", ctx_r1.startSiteGuid);
} }
function ContentNodeSelectorPanelComponent_button_3_Template(rf, ctx) { if (rf & 1) {
    const _r16 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 25);
    ɵngcc0.ɵɵlistener("click", function ContentNodeSelectorPanelComponent_button_3_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r16); const ctx_r15 = ɵngcc0.ɵɵnextContext(); return ctx_r15.toggleSearchPanel(); });
    ɵngcc0.ɵɵelementStart(1, "mat-icon");
    ɵngcc0.ɵɵtext(2, "filter_list");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(4, 1, "SEARCH.SEARCH_HEADER.TITLE"), " ");
} }
function ContentNodeSelectorPanelComponent_adf_search_panel_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "adf-search-panel");
} }
function ContentNodeSelectorPanelComponent_ng_container_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "span", 26);
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(3, 1, "NODE_SELECTOR.SEARCH_RESULTS"));
} }
function ContentNodeSelectorPanelComponent_adf_dropdown_breadcrumb_10_Template(rf, ctx) { if (rf & 1) {
    const _r18 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "adf-dropdown-breadcrumb", 27);
    ɵngcc0.ɵɵlistener("navigate", function ContentNodeSelectorPanelComponent_adf_dropdown_breadcrumb_10_Template_adf_dropdown_breadcrumb_navigate_0_listener() { ɵngcc0.ɵɵrestoreView(_r18); const ctx_r17 = ɵngcc0.ɵɵnextContext(); return ctx_r17.clearSearch(); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext();
    const _r7 = ɵngcc0.ɵɵreference(14);
    ɵngcc0.ɵɵproperty("target", _r7)("rootId", ctx_r5.breadcrumbRootId)("transform", ctx_r5.breadcrumbTransform)("folderNode", ctx_r5.breadcrumbFolderNode)("root", ctx_r5.breadcrumbFolderTitle);
} }
function ContentNodeSelectorPanelComponent_ng_container_11_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 28);
} if (rf & 2) {
    const ctx_r6 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("adf-node-counter", ctx_r6.getSelectedCount());
} }
function ContentNodeSelectorPanelComponent_ng_template_22_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "adf-name-location-cell", 29);
} if (rf & 2) {
    const context_r19 = ctx.$implicit;
    ɵngcc0.ɵɵproperty("row", context_r19.row);
} }
export const defaultValidation = () => true;
export class ContentNodeSelectorPanelComponent {
    constructor(customResourcesService, queryBuilderService, userPreferencesService, nodesApiService, uploadService, sitesService, appConfigService, contentNodeSelectorPanelService) {
        this.customResourcesService = customResourcesService;
        this.queryBuilderService = queryBuilderService;
        this.userPreferencesService = userPreferencesService;
        this.nodesApiService = nodesApiService;
        this.uploadService = uploadService;
        this.sitesService = sitesService;
        this.appConfigService = appConfigService;
        this.contentNodeSelectorPanelService = contentNodeSelectorPanelService;
        this.DEFAULT_PAGINATION = new Pagination({
            maxItems: 25,
            skipCount: 0
        });
        this.showSiteList = true;
        this.showSearchField = true;
        this.showCounter = false;
        this.restrictRootToCurrentFolderId = false;
        this.currentFolderId = null;
        this.dropdownHideMyFiles = false;
        this.dropdownSiteList = null;
        this._rowFilter = defaultValidation;
        this._excludeSiteContent = [];
        this.imageResolver = null;
        this.pageSize = this.DEFAULT_PAGINATION.maxItems;
        this.selectionMode = 'single';
        this.isSelectionValid = defaultValidation;
        this.select = new EventEmitter();
        this.navigationChange = new EventEmitter();
        this.siteChange = new EventEmitter();
        this.showingSearch = new EventEmitter();
        this.currentFolder = new EventEmitter();
        this.folderLoaded = new EventEmitter();
        this.nodePaging = null;
        this.searchTerm = '';
        this.showingSearchResults = false;
        this.loadingSearchResults = false;
        this.inDialog = false;
        this._chosenNode = null;
        this.folderIdToShow = null;
        this.breadcrumbFolderTitle = null;
        this.startSiteGuid = null;
        this.hasValidQuery = false;
        this.showHeader = ShowHeaderMode.Never;
        this.infiniteScroll = false;
        this.debounceSearch = 200;
        this.searchInput = new FormControl();
        this.preselectedNodes = [];
        this.currentUploadBatch = [];
        this.searchPanelExpanded = false;
        this.onDestroy$ = new Subject();
    }
    set rowFilter(rowFilter) {
        this.createRowFilter(rowFilter);
    }
    get rowFilter() {
        return this._rowFilter;
    }
    set excludeSiteContent(excludeSiteContent) {
        this._excludeSiteContent = excludeSiteContent;
        this.createRowFilter(this._rowFilter);
    }
    get excludeSiteContent() {
        return this._excludeSiteContent;
    }
    set showSearch(value) {
        if (value !== undefined && value !== null) {
            this.showSearchField = value;
        }
    }
    get showSearch() {
        return this.showSearchField;
    }
    set showDropdownSiteList(value) {
        if (value !== undefined && value !== null) {
            this.showSiteList = value;
        }
    }
    get showDropdownSiteList() {
        return this.showSiteList;
    }
    set showFilesInResult(value) {
        if (value !== undefined && value !== null) {
            const showFilesQuery = `TYPE:'cm:folder'${value ? " OR TYPE:'cm:content'" : ''}`;
            this.queryBuilderService.addFilterQuery(showFilesQuery);
        }
    }
    set showNodeCounter(value) {
        this.showCounter = value !== null && value !== void 0 ? value : false;
    }
    get showNodeCounter() {
        return this.showCounter;
    }
    set chosenNode(value) {
        this._chosenNode = value;
        this.select.next(value);
    }
    get chosenNode() {
        return this._chosenNode;
    }
    getSelectedCount() {
        var _a;
        return ((_a = this.chosenNode) === null || _a === void 0 ? void 0 : _a.length) || 0;
    }
    ngOnInit() {
        this.searchInput.valueChanges
            .pipe(debounceTime(this.debounceSearch), takeUntil(this.onDestroy$))
            .subscribe((searchValue) => {
            this.searchTerm = searchValue;
            this.queryBuilderService.userQuery = searchValue.length > 0 ? `${searchValue}*` : searchValue;
            this.queryBuilderService.update();
        });
        this.queryBuilderService.updated
            .pipe(takeUntil(this.onDestroy$))
            .subscribe((queryBody) => {
            if (queryBody) {
                this.hasValidQuery = true;
                this.prepareDialogForNewSearch(queryBody);
                this.queryBuilderService.execute(queryBody);
            }
            else {
                this.hasValidQuery = false;
                this.resetFolderToShow();
                this.clearSearch();
            }
        });
        this.queryBuilderService.executed
            .pipe(takeUntil(this.onDestroy$))
            .subscribe((results) => {
            if (this.hasValidQuery) {
                this.showSearchResults(results);
            }
        });
        this.userPreferencesService
            .select(UserPreferenceValues.PaginationSize)
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(pagSize => this.pageSize = pagSize);
        this.target = this.documentList;
        this.folderIdToShow = this.currentFolderId;
        if (this.currentFolderId) {
            if (this.restrictRootToCurrentFolderId) {
                this.breadcrumbRootId = this.currentFolderId;
                this.siteId = this.currentFolderId;
            }
            else {
                this.getStartSite();
            }
        }
        this.breadcrumbTransform = this.breadcrumbTransform ? this.breadcrumbTransform : null;
        this.isSelectionValid = this.isSelectionValid ? this.isSelectionValid : defaultValidation;
        this.onFileUploadEvent();
        this.onFileUploadDeletedEvent();
        this.resetPagination();
        this.setSearchScopeToNodes();
        this.documentList.$folderNode
            .pipe(takeUntil(this.onDestroy$))
            .subscribe((currentNode) => {
            this.currentFolder.emit(currentNode);
        });
        this.sorting = this.appConfigService.get('adf-content-node-selector.sorting', ['createdAt', 'desc']);
    }
    ngOnDestroy() {
        this.onDestroy$.next(true);
        this.onDestroy$.complete();
    }
    toggleSearchPanel() {
        this.searchPanelExpanded = !this.searchPanelExpanded;
    }
    hasCustomModels() {
        var _a, _b;
        return ((_b = (_a = this.contentNodeSelectorPanelService) === null || _a === void 0 ? void 0 : _a.customModels) === null || _b === void 0 ? void 0 : _b.length) > 0;
    }
    onFileUploadEvent() {
        this.uploadService.fileUploadComplete
            .pipe(debounceTime(500), takeUntil(this.onDestroy$))
            .subscribe((fileUploadEvent) => {
            this.currentUploadBatch.push(fileUploadEvent.data);
            if (!this.uploadService.isUploading()) {
                this.preselectedNodes = this.getPreselectNodesBasedOnSelectionMode();
                this.currentUploadBatch = [];
                this.documentList.reloadWithoutResettingSelection();
            }
        });
    }
    onFileUploadDeletedEvent() {
        this.uploadService.fileUploadDeleted
            .pipe(takeUntil(this.onDestroy$))
            .subscribe((deletedFileEvent) => {
            this.documentList.unselectRowFromNodeId(deletedFileEvent.file.data.entry.id);
            this.documentList.reloadWithoutResettingSelection();
        });
    }
    getStartSite() {
        this.nodesApiService.getNode(this.currentFolderId).subscribe((startNodeEntry) => {
            this.startSiteGuid = this.sitesService.getSiteNameFromNodePath(startNodeEntry);
            if (this.startSiteGuid) {
                this.sitesService.getSite(this.startSiteGuid).subscribe((startSiteEntry) => {
                    if (startSiteEntry instanceof SiteEntry) {
                        this.siteChange.emit(startSiteEntry.entry.title);
                    }
                });
            }
        });
    }
    createRowFilter(filter) {
        if (!filter) {
            filter = () => true;
        }
        this._rowFilter = (value, index, array) => {
            return filter(value, index, array) &&
                !this.isExcludedSiteContent(value);
        };
    }
    isExcludedSiteContent(row) {
        const entry = row.node.entry;
        if (this._excludeSiteContent && this._excludeSiteContent.length &&
            entry &&
            entry.properties &&
            entry.properties['st:componentId']) {
            const excludedItem = this._excludeSiteContent.find((id) => entry.properties['st:componentId'] === id);
            return !!excludedItem;
        }
        return false;
    }
    siteChanged(chosenSite) {
        this.siteId = chosenSite.entry.guid;
        this.setTitleIfCustomSite(chosenSite);
        this.siteChange.emit(chosenSite.entry.title);
        this.queryBuilderService.update();
    }
    get breadcrumbFolderNode() {
        let folderNode;
        if (this.showingSearchResults && this.chosenNode) {
            folderNode = this.chosenNode[0];
        }
        else {
            folderNode = this.documentList.folderNode;
        }
        return folderNode;
    }
    prepareDialogForNewSearch(queryBody) {
        this.target = queryBody ? null : this.documentList;
        if (this.target) {
            this.infinitePaginationComponent.reset();
        }
        this.folderIdToShow = null;
        this.preselectedNodes = [];
        this.loadingSearchResults = true;
        this.addCorrespondingNodeIdsQuery();
        this.resetChosenNode();
    }
    clear() {
        this.searchTerm = '';
        this.queryBuilderService.userQuery = '';
        this.queryBuilderService.update();
    }
    resetFolderToShow() {
        this.folderIdToShow = this.siteId || this.currentFolderId;
    }
    clearSearch() {
        this.searchTerm = '';
        this.nodePaging = null;
        this.resetPagination();
        this.resetChosenNode();
        this.showingSearchResults = false;
        this.showingSearch.emit(this.showingSearchResults);
    }
    addCorrespondingNodeIdsQuery() {
        let extraParentFiltering = '';
        if (this.customResourcesService.hasCorrespondingNodeIds(this.siteId)) {
            this.customResourcesService.getCorrespondingNodeIds(this.siteId)
                .subscribe((nodeIds) => {
                if (nodeIds && nodeIds.length) {
                    nodeIds
                        .filter((id) => id !== this.siteId)
                        .forEach((extraId) => {
                        extraParentFiltering += ` OR ANCESTOR:'workspace://SpacesStore/${extraId}'`;
                    });
                }
                const parentFiltering = this.siteId ? `ANCESTOR:'workspace://SpacesStore/${this.siteId}'${extraParentFiltering}` : '';
                this.queryBuilderService.addFilterQuery(parentFiltering);
            });
        }
        else {
            const parentFiltering = this.siteId ? `ANCESTOR:'workspace://SpacesStore/${this.siteId}'` : '';
            this.queryBuilderService.addFilterQuery(parentFiltering);
        }
    }
    setSearchScopeToNodes() {
        const scope = {
            locations: 'nodes'
        };
        this.queryBuilderService.setScope(scope);
    }
    showSearchResults(results) {
        this.showingSearchResults = true;
        this.loadingSearchResults = false;
        this.showingSearch.emit(this.showingSearchResults);
        this.nodePaging = results;
    }
    onFolderChange($event) {
        this.folderIdToShow = $event.value.id;
        this.showingSearchResults = false;
        this.infiniteScroll = false;
        this.breadcrumbFolderTitle = null;
        this.preselectedNodes = [];
        this.clearSearch();
        this.navigationChange.emit($event);
    }
    onFolderLoaded(nodePaging) {
        this.updatePaginationAfterRowFilter(nodePaging);
        if (!this.showingSearchResults) {
            this.attemptNodeSelection(this.documentList.folderNode);
        }
        this.folderLoaded.emit();
    }
    updatePaginationAfterRowFilter(nodePaging) {
        if (this.documentList.data.getRows().length < nodePaging.list.pagination.maxItems) {
            nodePaging.list.pagination.hasMoreItems = false;
        }
    }
    showBreadcrumbs() {
        return !this.showingSearchResults || this.chosenNode;
    }
    getNextPageOfSearch(pagination) {
        this.infiniteScroll = true;
        this.queryBuilderService.paging.maxItems = pagination.maxItems;
        this.queryBuilderService.paging.skipCount = pagination.skipCount;
        if (this.searchTerm.length > 0) {
            this.queryBuilderService.update();
        }
    }
    attemptNodeSelection(entry) {
        if (entry && this.isSelectionValid(entry)) {
            this.chosenNode = [entry];
        }
    }
    resetChosenNode() {
        this.chosenNode = null;
    }
    onCurrentSelection(nodesEntries) {
        const validNodesEntity = nodesEntries.filter((node) => this.isSelectionValid(node.entry));
        this.chosenNode = validNodesEntity.map((node) => node.entry);
    }
    setTitleIfCustomSite(site) {
        if (this.customResourcesService.isCustomSource(site.entry.guid)) {
            this.breadcrumbFolderTitle = site.entry.title;
            if (this.documentList.folderNode.path.elements) {
                this.breadcrumbFolderNode.name = site.entry.title;
                this.documentList.folderNode.path.elements = null;
            }
        }
        else {
            this.breadcrumbFolderTitle = null;
        }
    }
    hasPreselectNodes() {
        var _a;
        return ((_a = this.preselectedNodes) === null || _a === void 0 ? void 0 : _a.length) > 0;
    }
    isSingleSelectionMode() {
        return this.selectionMode === 'single';
    }
    getPreselectNodesBasedOnSelectionMode() {
        var _a;
        let selectedNodes = [];
        if ((_a = this.currentUploadBatch) === null || _a === void 0 ? void 0 : _a.length) {
            if (this.isSingleSelectionMode()) {
                selectedNodes = [this.currentUploadBatch[this.currentUploadBatch.length - 1]];
            }
            else {
                selectedNodes = this.currentUploadBatch;
            }
        }
        return selectedNodes;
    }
    resetPagination() {
        this.queryBuilderService.paging = {
            maxItems: this.pageSize,
            skipCount: this.DEFAULT_PAGINATION.skipCount
        };
    }
}
ContentNodeSelectorPanelComponent.ɵfac = function ContentNodeSelectorPanelComponent_Factory(t) { return new (t || ContentNodeSelectorPanelComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.CustomResourcesService), ɵngcc0.ɵɵdirectiveInject(SEARCH_QUERY_SERVICE_TOKEN), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.UserPreferencesService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.NodesApiService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.UploadService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.SitesService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.AppConfigService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.ContentNodeSelectorPanelService)); };
ContentNodeSelectorPanelComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ContentNodeSelectorPanelComponent, selectors: [["adf-content-node-selector-panel"]], viewQuery: function ContentNodeSelectorPanelComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(_c0, true);
        ɵngcc0.ɵɵstaticViewQuery(HighlightDirective, true);
        ɵngcc0.ɵɵstaticViewQuery(InfinitePaginationComponent, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.documentList = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.highlighter = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.infinitePaginationComponent = _t.first);
    } }, hostAttrs: [1, "adf-content-node-selector-panel"], inputs: { restrictRootToCurrentFolderId: "restrictRootToCurrentFolderId", currentFolderId: "currentFolderId", dropdownHideMyFiles: "dropdownHideMyFiles", dropdownSiteList: "dropdownSiteList", imageResolver: "imageResolver", pageSize: "pageSize", selectionMode: "selectionMode", isSelectionValid: "isSelectionValid", rowFilter: "rowFilter", excludeSiteContent: "excludeSiteContent", showSearch: "showSearch", showDropdownSiteList: "showDropdownSiteList", showFilesInResult: "showFilesInResult", showNodeCounter: "showNodeCounter", breadcrumbTransform: "breadcrumbTransform", where: "where" }, outputs: { select: "select", navigationChange: "navigationChange", siteChange: "siteChange", showingSearch: "showingSearch", currentFolder: "currentFolder", folderLoaded: "folderLoaded" }, features: [ɵngcc0.ɵɵProvidersFeature([{
                provide: SEARCH_QUERY_SERVICE_TOKEN,
                useClass: SearchQueryBuilderService
            }])], decls: 29, vars: 31, consts: [[1, "adf-content-node-selector-content"], ["floatPlaceholder", "never", "class", "adf-content-node-selector-content-input", 4, "ngIf"], ["class", "full-width", "data-automation-id", "content-node-selector-sites-combo", 3, "placeholder", "hideMyFiles", "siteList", "value", "change", 4, "ngIf"], ["data-automation-id", "adf-toggle-search-panel-button", "mat-icon-button", "", 3, "click", 4, "ngIf"], [1, "adf-content-node-selector-search-panel-container"], [4, "ngIf"], [1, "adf-content-node-selector-document-list-container"], ["class", "adf-content-node-selector-content-breadcrumb", "data-automation-id", "content-node-selector-content-breadcrumb", 3, "target", "rootId", "transform", "folderNode", "root", "navigate", 4, "ngIf"], [3, "adf-node-counter", 4, "ngIf"], ["data-automation-id", "content-node-selector-content-list", 1, "adf-content-node-selector-content-list"], ["adf-highlight-selector", ".adf-name-location-cell-name", "sortingMode", "server", "data-automation-id", "content-node-selector-document-list", 3, "adf-highlight", "showHeader", "node", "preselectNodes", "maxItems", "rowFilter", "imageResolver", "currentFolderId", "selectionMode", "contextMenuActions", "contentActions", "allowDropFiles", "sorting", "where", "folderChange", "ready", "nodeSelected"], ["documentList", ""], ["key", "$thumbnail", "type", "image"], ["key", "name", "type", "text", "title", "ADF-DOCUMENT-LIST.LAYOUT.NAME", 1, "adf-full-width", "adf-ellipsis-cell"], ["key", "modifiedAt", "type", "date", "title", "ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON", "format", "timeAgo", 1, "adf-content-selector-modified-cell"], ["key", "createdByUser.displayName", "type", "text", "title", "ADF-DOCUMENT-LIST.LAYOUT.CREATED_BY", 1, "adf-content-selector-modifier-cell"], ["key", "visibility", "type", "text", "title", "ADF-DOCUMENT-LIST.LAYOUT.STATUS", 1, "adf-content-selector-visibility-cell"], ["data-automation-id", "content-node-selector-search-pagination", 3, "target", "loading", "loadMore"], ["floatPlaceholder", "never", 1, "adf-content-node-selector-content-input"], ["matInput", "", "id", "searchInput", "type", "text", "data-automation-id", "content-node-selector-search-input", 3, "formControl", "placeholder", "value"], ["matSuffix", "", "class", "adf-content-node-selector-content-input-icon", "data-automation-id", "content-node-selector-search-clear", 3, "click", 4, "ngIf"], ["matSuffix", "", "class", "adf-content-node-selector-content-input-icon", "data-automation-id", "content-node-selector-search-icon", 4, "ngIf"], ["matSuffix", "", "data-automation-id", "content-node-selector-search-clear", 1, "adf-content-node-selector-content-input-icon", 3, "click"], ["matSuffix", "", "data-automation-id", "content-node-selector-search-icon", 1, "adf-content-node-selector-content-input-icon"], ["data-automation-id", "content-node-selector-sites-combo", 1, "full-width", 3, "placeholder", "hideMyFiles", "siteList", "value", "change"], ["data-automation-id", "adf-toggle-search-panel-button", "mat-icon-button", "", 3, "click"], ["role", "heading", "aria-level", "3", 1, "adf-search-results-label"], ["data-automation-id", "content-node-selector-content-breadcrumb", 1, "adf-content-node-selector-content-breadcrumb", 3, "target", "rootId", "transform", "folderNode", "root", "navigate"], [3, "adf-node-counter"], [3, "row"]], template: function ContentNodeSelectorPanelComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "div", 0);
        ɵngcc0.ɵɵtemplate(1, ContentNodeSelectorPanelComponent_mat_form_field_1_Template, 5, 7, "mat-form-field", 1);
        ɵngcc0.ɵɵtemplate(2, ContentNodeSelectorPanelComponent_adf_sites_dropdown_2_Template, 1, 4, "adf-sites-dropdown", 2);
        ɵngcc0.ɵɵtemplate(3, ContentNodeSelectorPanelComponent_button_3_Template, 5, 3, "button", 3);
        ɵngcc0.ɵɵelementStart(4, "div", 4);
        ɵngcc0.ɵɵtemplate(5, ContentNodeSelectorPanelComponent_adf_search_panel_5_Template, 1, 0, "adf-search-panel", 5);
        ɵngcc0.ɵɵelementStart(6, "div", 6);
        ɵngcc0.ɵɵelementStart(7, "adf-toolbar");
        ɵngcc0.ɵɵelementStart(8, "adf-toolbar-title");
        ɵngcc0.ɵɵtemplate(9, ContentNodeSelectorPanelComponent_ng_container_9_Template, 4, 3, "ng-container", 5);
        ɵngcc0.ɵɵtemplate(10, ContentNodeSelectorPanelComponent_adf_dropdown_breadcrumb_10_Template, 1, 5, "adf-dropdown-breadcrumb", 7);
        ɵngcc0.ɵɵtemplate(11, ContentNodeSelectorPanelComponent_ng_container_11_Template, 1, 1, "ng-container", 8);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(12, "div", 9);
        ɵngcc0.ɵɵelementStart(13, "adf-document-list", 10, 11);
        ɵngcc0.ɵɵlistener("folderChange", function ContentNodeSelectorPanelComponent_Template_adf_document_list_folderChange_13_listener($event) { return ctx.onFolderChange($event); })("ready", function ContentNodeSelectorPanelComponent_Template_adf_document_list_ready_13_listener($event) { return ctx.onFolderLoaded($event); })("nodeSelected", function ContentNodeSelectorPanelComponent_Template_adf_document_list_nodeSelected_13_listener($event) { return ctx.onCurrentSelection($event); });
        ɵngcc0.ɵɵelementStart(15, "adf-custom-empty-content-template");
        ɵngcc0.ɵɵelementStart(16, "div");
        ɵngcc0.ɵɵtext(17);
        ɵngcc0.ɵɵpipe(18, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(19, "data-columns");
        ɵngcc0.ɵɵelement(20, "data-column", 12);
        ɵngcc0.ɵɵelementStart(21, "data-column", 13);
        ɵngcc0.ɵɵtemplate(22, ContentNodeSelectorPanelComponent_ng_template_22_Template, 1, 1, "ng-template");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelement(23, "data-column", 14);
        ɵngcc0.ɵɵelement(24, "data-column", 15);
        ɵngcc0.ɵɵelement(25, "data-column", 16);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(26, "adf-infinite-pagination", 17);
        ɵngcc0.ɵɵlistener("loadMore", function ContentNodeSelectorPanelComponent_Template_adf_infinite_pagination_loadMore_26_listener($event) { return ctx.getNextPageOfSearch($event); });
        ɵngcc0.ɵɵtext(27);
        ɵngcc0.ɵɵpipe(28, "translate");
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showSearch);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showDropdownSiteList);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.hasCustomModels());
        ɵngcc0.ɵɵadvance(2);
        ɵngcc0.ɵɵproperty("ngIf", ctx.searchPanelExpanded);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵproperty("ngIf", !ctx.showBreadcrumbs());
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showBreadcrumbs());
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.showNodeCounter);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵclassProp("adf-content-node-selector-content-list-searchLayout", ctx.showingSearchResults);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("adf-highlight", ctx.searchTerm)("showHeader", ctx.showHeader)("node", ctx.nodePaging)("preselectNodes", ctx.preselectedNodes)("maxItems", ctx.pageSize)("rowFilter", ctx._rowFilter)("imageResolver", ctx.imageResolver)("currentFolderId", ctx.folderIdToShow)("selectionMode", ctx.selectionMode)("contextMenuActions", false)("contentActions", false)("allowDropFiles", false)("sorting", ctx.sorting)("where", ctx.where);
        ɵngcc0.ɵɵadvance(4);
        ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(18, 27, "NODE_SELECTOR.NO_RESULTS"));
        ɵngcc0.ɵɵadvance(9);
        ɵngcc0.ɵɵproperty("target", ctx.target)("loading", ctx.loadingSearchResults);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(28, 29, "ADF-DOCUMENT-LIST.LAYOUT.LOAD_MORE"), " ");
    } }, directives: [ɵngcc4.NgIf, ɵngcc2.ToolbarComponent, ɵngcc2.ToolbarTitleComponent, ɵngcc5.DocumentListComponent, ɵngcc2.HighlightDirective, ɵngcc2.CustomEmptyContentTemplateDirective, ɵngcc2.DataColumnListComponent, ɵngcc2.DataColumnComponent, ɵngcc2.InfinitePaginationComponent, ɵngcc6.MatFormField, ɵngcc7.MatInput, ɵngcc8.DefaultValueAccessor, ɵngcc8.NgControlStatus, ɵngcc8.FormControlDirective, ɵngcc9.MatIcon, ɵngcc6.MatSuffix, ɵngcc10.DropdownSitesComponent, ɵngcc11.MatButton, ɵngcc12.SearchPanelComponent, ɵngcc13.DropdownBreadcrumbComponent, ɵngcc14.NodeCounterDirective, ɵngcc15.NameLocationCellComponent], pipes: [ɵngcc16.TranslatePipe], encapsulation: 2 });
ContentNodeSelectorPanelComponent.ctorParameters = () => [
    { type: CustomResourcesService },
    { type: SearchQueryBuilderService, decorators: [{ type: Inject, args: [SEARCH_QUERY_SERVICE_TOKEN,] }] },
    { type: UserPreferencesService },
    { type: NodesApiService },
    { type: UploadService },
    { type: SitesService },
    { type: AppConfigService },
    { type: ContentNodeSelectorPanelService }
];
ContentNodeSelectorPanelComponent.propDecorators = {
    restrictRootToCurrentFolderId: [{ type: Input }],
    currentFolderId: [{ type: Input }],
    dropdownHideMyFiles: [{ type: Input }],
    dropdownSiteList: [{ type: Input }],
    where: [{ type: Input }],
    rowFilter: [{ type: Input }],
    excludeSiteContent: [{ type: Input }],
    imageResolver: [{ type: Input }],
    pageSize: [{ type: Input }],
    selectionMode: [{ type: Input }],
    isSelectionValid: [{ type: Input }],
    breadcrumbTransform: [{ type: Input }],
    showSearch: [{ type: Input }],
    showDropdownSiteList: [{ type: Input }],
    showFilesInResult: [{ type: Input }],
    showNodeCounter: [{ type: Input }],
    select: [{ type: Output }],
    navigationChange: [{ type: Output }],
    siteChange: [{ type: Output }],
    showingSearch: [{ type: Output }],
    currentFolder: [{ type: Output }],
    folderLoaded: [{ type: Output }],
    documentList: [{ type: ViewChild, args: ['documentList', { static: true },] }],
    highlighter: [{ type: ViewChild, args: [HighlightDirective, { static: true },] }],
    infinitePaginationComponent: [{ type: ViewChild, args: [InfinitePaginationComponent, { static: true },] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ContentNodeSelectorPanelComponent, [{
        type: Component,
        args: [{
                selector: 'adf-content-node-selector-panel',
                template: "<div class=\"adf-content-node-selector-content\">\n    <mat-form-field floatPlaceholder=\"never\" class=\"adf-content-node-selector-content-input\" *ngIf=\"showSearch\">\n        <input matInput\n            id=\"searchInput\"\n            [formControl]=\"searchInput\"\n            type=\"text\"\n            placeholder=\"{{'NODE_SELECTOR.SEARCH' | translate}}\"\n            [value]=\"searchTerm\"\n            data-automation-id=\"content-node-selector-search-input\">\n\n        <mat-icon *ngIf=\"searchTerm.length > 0\"\n            matSuffix (click)=\"clear()\"\n            class=\"adf-content-node-selector-content-input-icon\"\n            data-automation-id=\"content-node-selector-search-clear\">clear\n        </mat-icon>\n\n        <mat-icon *ngIf=\"searchTerm.length === 0\"\n            matSuffix\n            class=\"adf-content-node-selector-content-input-icon\"\n            data-automation-id=\"content-node-selector-search-icon\">search\n        </mat-icon>\n\n    </mat-form-field>\n    <adf-sites-dropdown\n        *ngIf=\"showDropdownSiteList\"\n        class=\"full-width\"\n        (change)=\"siteChanged($event)\"\n        [placeholder]=\"'NODE_SELECTOR.SELECT_LOCATION'\"\n        [hideMyFiles]=\"dropdownHideMyFiles\"\n        [siteList]=\"dropdownSiteList\"\n        [value]=\"startSiteGuid\"\n        data-automation-id=\"content-node-selector-sites-combo\">\n    </adf-sites-dropdown>\n    <button *ngIf=\"hasCustomModels()\"\n        data-automation-id=\"adf-toggle-search-panel-button\"\n        mat-icon-button\n        (click)=\"toggleSearchPanel()\">\n        <mat-icon>filter_list</mat-icon>\n        {{ 'SEARCH.SEARCH_HEADER.TITLE' | translate }}\n    </button>\n    <div class=\"adf-content-node-selector-search-panel-container\">\n        <adf-search-panel *ngIf=\"searchPanelExpanded\">\n        </adf-search-panel>\n        <div class=\"adf-content-node-selector-document-list-container\">\n    <adf-toolbar>\n        <adf-toolbar-title>\n            <ng-container *ngIf=\"!showBreadcrumbs()\">\n                <span role=\"heading\" aria-level=\"3\" class=\"adf-search-results-label\">{{ 'NODE_SELECTOR.SEARCH_RESULTS' | translate }}</span>\n            </ng-container>\n            <adf-dropdown-breadcrumb *ngIf=\"showBreadcrumbs()\"\n                class=\"adf-content-node-selector-content-breadcrumb\"\n                (navigate)=\"clearSearch()\"\n                [target]=\"documentList\"\n                [rootId]=\"breadcrumbRootId\"\n                [transform]=\"breadcrumbTransform\"\n                [folderNode]=\"breadcrumbFolderNode\"\n                [root]=\"breadcrumbFolderTitle\"\n                data-automation-id=\"content-node-selector-content-breadcrumb\">\n            </adf-dropdown-breadcrumb>\n            <ng-container *ngIf=\"showNodeCounter\" [adf-node-counter]=\"getSelectedCount()\"></ng-container>\n        </adf-toolbar-title>\n    </adf-toolbar>\n\n    <div\n        class=\"adf-content-node-selector-content-list\"\n        [class.adf-content-node-selector-content-list-searchLayout]=\"showingSearchResults\"\n        data-automation-id=\"content-node-selector-content-list\">\n        <adf-document-list\n            #documentList\n            [adf-highlight]=\"searchTerm\"\n            adf-highlight-selector=\".adf-name-location-cell-name\"\n            [showHeader]=\"showHeader\"\n            [node]=\"nodePaging\"\n            [preselectNodes]=\"preselectedNodes\"\n            [maxItems]=\"pageSize\"\n            [rowFilter]=\"_rowFilter\"\n            [imageResolver]=\"imageResolver\"\n            [currentFolderId]=\"folderIdToShow\"\n            [selectionMode]=\"selectionMode\"\n            [contextMenuActions]=\"false\"\n            [contentActions]=\"false\"\n            [allowDropFiles]=\"false\"\n            [sorting]=\"sorting\"\n            sortingMode=\"server\"\n            [where]=\"where\"\n            (folderChange)=\"onFolderChange($event)\"\n            (ready)=\"onFolderLoaded($event)\"\n            (nodeSelected)=\"onCurrentSelection($event)\"\n            data-automation-id=\"content-node-selector-document-list\">\n\n            <adf-custom-empty-content-template>\n                <div>{{ 'NODE_SELECTOR.NO_RESULTS' | translate }}</div>\n            </adf-custom-empty-content-template>\n\n            <data-columns>\n                <data-column key=\"$thumbnail\" type=\"image\"></data-column>\n                <data-column key=\"name\" type=\"text\" title=\"ADF-DOCUMENT-LIST.LAYOUT.NAME\" class=\"adf-full-width adf-ellipsis-cell\">\n                    <ng-template let-context>\n                        <adf-name-location-cell [row]=\"context.row\"></adf-name-location-cell>\n                    </ng-template>\n                </data-column>\n                <data-column key=\"modifiedAt\" type=\"date\" title=\"ADF-DOCUMENT-LIST.LAYOUT.MODIFIED_ON\" format=\"timeAgo\" class=\"adf-content-selector-modified-cell\"></data-column>\n                <data-column key=\"createdByUser.displayName\" type=\"text\" title=\"ADF-DOCUMENT-LIST.LAYOUT.CREATED_BY\" class=\"adf-content-selector-modifier-cell\"></data-column>\n                <data-column key=\"visibility\" type=\"text\" title=\"ADF-DOCUMENT-LIST.LAYOUT.STATUS\" class=\"adf-content-selector-visibility-cell\"></data-column>\n            </data-columns>\n\n        </adf-document-list>\n\n        <adf-infinite-pagination\n            [target]=\"target\"\n            [loading]=\"loadingSearchResults\"\n            (loadMore)=\"getNextPageOfSearch($event)\"\n            data-automation-id=\"content-node-selector-search-pagination\">\n            {{ 'ADF-DOCUMENT-LIST.LAYOUT.LOAD_MORE' | translate }}\n        </adf-infinite-pagination>\n    </div>\n        </div>\n    </div>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                host: { 'class': 'adf-content-node-selector-panel' },
                providers: [{
                        provide: SEARCH_QUERY_SERVICE_TOKEN,
                        useClass: SearchQueryBuilderService
                    }]
            }]
    }], function () { return [{ type: ɵngcc1.CustomResourcesService }, { type: ɵngcc17.SearchQueryBuilderService, decorators: [{
                type: Inject,
                args: [SEARCH_QUERY_SERVICE_TOKEN]
            }] }, { type: ɵngcc2.UserPreferencesService }, { type: ɵngcc2.NodesApiService }, { type: ɵngcc2.UploadService }, { type: ɵngcc2.SitesService }, { type: ɵngcc2.AppConfigService }, { type: ɵngcc3.ContentNodeSelectorPanelService }]; }, { restrictRootToCurrentFolderId: [{
            type: Input
        }], currentFolderId: [{
            type: Input
        }], dropdownHideMyFiles: [{
            type: Input
        }], dropdownSiteList: [{
            type: Input
        }], imageResolver: [{
            type: Input
        }], pageSize: [{
            type: Input
        }], selectionMode: [{
            type: Input
        }], isSelectionValid: [{
            type: Input
        }], select: [{
            type: Output
        }], navigationChange: [{
            type: Output
        }], siteChange: [{
            type: Output
        }], showingSearch: [{
            type: Output
        }], currentFolder: [{
            type: Output
        }], folderLoaded: [{
            type: Output
        }], rowFilter: [{
            type: Input
        }], excludeSiteContent: [{
            type: Input
        }], showSearch: [{
            type: Input
        }], showDropdownSiteList: [{
            type: Input
        }], showFilesInResult: [{
            type: Input
        }], showNodeCounter: [{
            type: Input
        }], breadcrumbTransform: [{
            type: Input
        }], where: [{
            type: Input
        }], documentList: [{
            type: ViewChild,
            args: ['documentList', { static: true }]
        }], highlighter: [{
            type: ViewChild,
            args: [HighlightDirective, { static: true }]
        }], infinitePaginationComponent: [{
            type: ViewChild,
            args: [InfinitePaginationComponent, { static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udGVudC1ub2RlLXNlbGVjdG9yLXBhbmVsLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vaG9tZS90cmF2aXMvYnVpbGQvQWxmcmVzY28vYWxmcmVzY28tbmcyLWNvbXBvbmVudHMvbGliL2NvbnRlbnQtc2VydmljZXMvc3JjL2xpYi9jb250ZW50LW5vZGUtc2VsZWN0b3IvY29udGVudC1ub2RlLXNlbGVjdG9yLXBhbmVsLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBRUgsT0FBTyxFQUNILFNBQVMsRUFDVCxZQUFZLEVBQ1osS0FBSyxFQUVMLE1BQU0sRUFDTixTQUFTLEVBQ1QsaUJBQWlCLEVBRWpCLE1BQU0sRUFDVCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQ0gsa0JBQWtCLEVBQ2xCLHNCQUFzQixFQUN0QixvQkFBb0IsRUFDcEIsMkJBQTJCLEVBQzNCLGVBQWUsRUFDZixZQUFZLEVBQ1osYUFBYSxFQUdiLGdCQUFnQixFQUVoQixjQUFjLEVBQ2pCLE1BQU0sb0JBQW9CLENBQUM7QUFDNUIsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzdDLE9BQU8sRUFBb0IsVUFBVSxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQXNDLE1BQU0sa0JBQWtCLENBQUM7QUFDM0gsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0scURBQXFELENBQUM7QUFHNUYsT0FBTyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUN6RCxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxvREFBb0QsQ0FBQztBQUU1RixPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQy9CLE9B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R0csS0FBSztBQUNSLCtCQUtHLEtBQUs7QUFDUixrQ0FPRyxLQUFLO0FBQ1IseUJBR0csS0FBSztBQUNSLG1DQVdHLEtBQUs7QUFDUixnQ0FXRyxLQUFLO0FBQ1IsOEJBUUcsS0FBSztBQUNSLHFCQVNHLE1BQU07QUFDVCwrQkFHRyxNQUFNO0FBQ1QseUJBR0csTUFBTTtBQUNULDRCQUdHLE1BQU07QUFDVCw0QkFHRyxNQUFNO0FBQ1QsMkJBR0csTUFBTTtBQUNULDJCQUVHLFNBQVMsU0FBQyxjQUFjLEVBQUUsRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFO0FBQzFDLDBCQUVBLFNBQVMsU0FBQyxrQkFBa0IsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDOUMsMENBZ0JBLFNBQVMsU0FBQywyQkFBMkIsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDeEQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztvQkFBRTtBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHtcbiAgICBDb21wb25lbnQsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIElucHV0LFxuICAgIE9uSW5pdCxcbiAgICBPdXRwdXQsXG4gICAgVmlld0NoaWxkLFxuICAgIFZpZXdFbmNhcHN1bGF0aW9uLFxuICAgIE9uRGVzdHJveSxcbiAgICBJbmplY3Rcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICAgIEhpZ2hsaWdodERpcmVjdGl2ZSxcbiAgICBVc2VyUHJlZmVyZW5jZXNTZXJ2aWNlLFxuICAgIFVzZXJQcmVmZXJlbmNlVmFsdWVzLFxuICAgIEluZmluaXRlUGFnaW5hdGlvbkNvbXBvbmVudCwgUGFnaW5hdGVkQ29tcG9uZW50LFxuICAgIE5vZGVzQXBpU2VydmljZSxcbiAgICBTaXRlc1NlcnZpY2UsXG4gICAgVXBsb2FkU2VydmljZSxcbiAgICBGaWxlVXBsb2FkQ29tcGxldGVFdmVudCxcbiAgICBGaWxlVXBsb2FkRGVsZXRlRXZlbnQsXG4gICAgQXBwQ29uZmlnU2VydmljZSxcbiAgICBEYXRhU29ydGluZyxcbiAgICBTaG93SGVhZGVyTW9kZVxufSBmcm9tICdAYWxmcmVzY28vYWRmLWNvcmUnO1xuaW1wb3J0IHsgRm9ybUNvbnRyb2wgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBOb2RlLCBOb2RlUGFnaW5nLCBQYWdpbmF0aW9uLCBTaXRlRW50cnksIFNpdGVQYWdpbmcsIE5vZGVFbnRyeSwgUXVlcnlCb2R5LCBSZXF1ZXN0U2NvcGUgfSBmcm9tICdAYWxmcmVzY28vanMtYXBpJztcbmltcG9ydCB7IERvY3VtZW50TGlzdENvbXBvbmVudCB9IGZyb20gJy4uL2RvY3VtZW50LWxpc3QvY29tcG9uZW50cy9kb2N1bWVudC1saXN0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBSb3dGaWx0ZXIgfSBmcm9tICcuLi9kb2N1bWVudC1saXN0L2RhdGEvcm93LWZpbHRlci5tb2RlbCc7XG5pbXBvcnQgeyBJbWFnZVJlc29sdmVyIH0gZnJvbSAnLi4vZG9jdW1lbnQtbGlzdC9kYXRhL2ltYWdlLXJlc29sdmVyLm1vZGVsJztcbmltcG9ydCB7IGRlYm91bmNlVGltZSwgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgQ3VzdG9tUmVzb3VyY2VzU2VydmljZSB9IGZyb20gJy4uL2RvY3VtZW50LWxpc3Qvc2VydmljZXMvY3VzdG9tLXJlc291cmNlcy5zZXJ2aWNlJztcbmltcG9ydCB7IE5vZGVFbnRyeUV2ZW50LCBTaGFyZURhdGFSb3cgfSBmcm9tICcuLi9kb2N1bWVudC1saXN0JztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IFNFQVJDSF9RVUVSWV9TRVJWSUNFX1RPS0VOIH0gZnJvbSAnLi4vc2VhcmNoL3NlYXJjaC1xdWVyeS1zZXJ2aWNlLnRva2VuJztcbmltcG9ydCB7IFNlYXJjaFF1ZXJ5QnVpbGRlclNlcnZpY2UgfSBmcm9tICcuLi9zZWFyY2gvc2VydmljZXMvc2VhcmNoLXF1ZXJ5LWJ1aWxkZXIuc2VydmljZSc7XG5pbXBvcnQgeyBDb250ZW50Tm9kZVNlbGVjdG9yUGFuZWxTZXJ2aWNlIH0gZnJvbSAnLi9jb250ZW50LW5vZGUtc2VsZWN0b3ItcGFuZWwuc2VydmljZSc7XG5cbmV4cG9ydCB0eXBlIFZhbGlkYXRpb25GdW5jdGlvbiA9IChlbnRyeTogTm9kZSkgPT4gYm9vbGVhbjtcblxuZXhwb3J0IGNvbnN0IGRlZmF1bHRWYWxpZGF0aW9uID0gKCkgPT4gdHJ1ZTtcblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICdhZGYtY29udGVudC1ub2RlLXNlbGVjdG9yLXBhbmVsJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vY29udGVudC1ub2RlLXNlbGVjdG9yLXBhbmVsLmNvbXBvbmVudC5odG1sJyxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICAgIGhvc3Q6IHsgJ2NsYXNzJzogJ2FkZi1jb250ZW50LW5vZGUtc2VsZWN0b3ItcGFuZWwnIH0sXG4gICAgcHJvdmlkZXJzOiBbe1xuICAgICAgICBwcm92aWRlOiBTRUFSQ0hfUVVFUllfU0VSVklDRV9UT0tFTixcbiAgICAgICAgdXNlQ2xhc3M6IFNlYXJjaFF1ZXJ5QnVpbGRlclNlcnZpY2VcbiAgICB9XVxufSlcbmV4cG9ydCBjbGFzcyBDb250ZW50Tm9kZVNlbGVjdG9yUGFuZWxDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG5cbiAgICBERUZBVUxUX1BBR0lOQVRJT046IFBhZ2luYXRpb24gPSBuZXcgUGFnaW5hdGlvbih7XG4gICAgICAgIG1heEl0ZW1zOiAyNSxcbiAgICAgICAgc2tpcENvdW50OiAwXG4gICAgfSk7XG5cbiAgICBwcml2YXRlIHNob3dTaXRlTGlzdCA9IHRydWU7XG4gICAgcHJpdmF0ZSBzaG93U2VhcmNoRmllbGQgPSB0cnVlO1xuICAgIHByaXZhdGUgc2hvd0NvdW50ZXIgPSBmYWxzZTtcblxuICAgIC8qKiBJZiB0cnVlIHdpbGwgcmVzdHJpY3QgdGhlIHNlYXJjaCBhbmQgYnJlYWRjcnVtYnMgdG8gdGhlIGN1cnJlbnRGb2xkZXJJZCAqL1xuICAgIEBJbnB1dCgpXG4gICAgcmVzdHJpY3RSb290VG9DdXJyZW50Rm9sZGVySWQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBOb2RlIElEIG9mIHRoZSBmb2xkZXIgY3VycmVudGx5IGxpc3RlZC4gKi9cbiAgICBASW5wdXQoKVxuICAgIGN1cnJlbnRGb2xkZXJJZDogc3RyaW5nID0gbnVsbDtcblxuICAgIC8qKiBIaWRlIHRoZSBcIk15IEZpbGVzXCIgb3B0aW9uIGFkZGVkIHRvIHRoZSBzaXRlIGxpc3QgYnkgZGVmYXVsdC5cbiAgICAgKiBTZWUgdGhlIFtTaXRlcyBEcm9wZG93biBjb21wb25lbnRdKHNpdGVzLWRyb3Bkb3duLmNvbXBvbmVudC5tZClcbiAgICAgKiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIGRyb3Bkb3duSGlkZU15RmlsZXM6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBDdXN0b20gc2l0ZSBmb3Igc2l0ZSBkcm9wZG93bi4gVGhpcyBpcyB0aGUgc2FtZSBhcyB0aGUgYHNpdGVMaXN0YC5cbiAgICAgKiBwcm9wZXJ0eSBvZiB0aGUgU2l0ZXMgRHJvcGRvd24gY29tcG9uZW50IChzZWUgaXRzIGRvYyBwYWdlXG4gICAgICogZm9yIG1vcmUgaW5mb3JtYXRpb24pLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgZHJvcGRvd25TaXRlTGlzdDogU2l0ZVBhZ2luZyA9IG51bGw7XG5cbiAgICBfcm93RmlsdGVyOiBSb3dGaWx0ZXIgPSBkZWZhdWx0VmFsaWRhdGlvbjtcblxuICAgIC8qKiBDdXN0b20gKndoZXJlKiBmaWx0ZXIgZnVuY3Rpb24uIFNlZSB0aGVcbiAgICAgKiBEb2N1bWVudCBMaXN0IGNvbXBvbmVudFxuICAgICAqIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgd2hlcmU6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqIEN1c3RvbSByb3cgZmlsdGVyIGZ1bmN0aW9uLiBTZWUgdGhlXG4gICAgICogW1JvdyBGaWx0ZXIgTW9kZWxdKHJvdy1maWx0ZXIubW9kZWwubWQpIHBhZ2VcbiAgICAgKiBmb3IgbW9yZSBpbmZvcm1hdGlvbi5cbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCByb3dGaWx0ZXIocm93RmlsdGVyOiBSb3dGaWx0ZXIpIHtcbiAgICAgICAgdGhpcy5jcmVhdGVSb3dGaWx0ZXIocm93RmlsdGVyKTtcbiAgICB9XG5cbiAgICBnZXQgcm93RmlsdGVyKCk6IFJvd0ZpbHRlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yb3dGaWx0ZXI7XG4gICAgfVxuXG4gICAgX2V4Y2x1ZGVTaXRlQ29udGVudDogc3RyaW5nW10gPSBbXTtcblxuICAgIC8qKiBDdXN0b20gbGlzdCBvZiBzaXRlIGNvbnRlbnQgY29tcG9uZW50SWRzLlxuICAgICAqIFVzZWQgdG8gZmlsdGVyIG91dCB0aGUgY29ycmVzcG9uZGluZyBpdGVtcyBmcm9tIHRoZSBkaXNwbGF5ZWQgbm9kZXNcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHNldCBleGNsdWRlU2l0ZUNvbnRlbnQoZXhjbHVkZVNpdGVDb250ZW50OiBzdHJpbmdbXSkge1xuICAgICAgICB0aGlzLl9leGNsdWRlU2l0ZUNvbnRlbnQgPSBleGNsdWRlU2l0ZUNvbnRlbnQ7XG4gICAgICAgIHRoaXMuY3JlYXRlUm93RmlsdGVyKHRoaXMuX3Jvd0ZpbHRlcik7XG4gICAgfVxuXG4gICAgZ2V0IGV4Y2x1ZGVTaXRlQ29udGVudCgpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9leGNsdWRlU2l0ZUNvbnRlbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3VzdG9tIGltYWdlIHJlc29sdmVyIGZ1bmN0aW9uLiBTZWUgdGhlXG4gICAgICogW0ltYWdlIFJlc29sdmVyIE1vZGVsXShpbWFnZS1yZXNvbHZlci5tb2RlbC5tZCkgcGFnZVxuICAgICAqIGZvciBtb3JlIGluZm9ybWF0aW9uLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgaW1hZ2VSZXNvbHZlcjogSW1hZ2VSZXNvbHZlciA9IG51bGw7XG5cbiAgICAvKiogTnVtYmVyIG9mIGl0ZW1zIHNob3duIHBlciBwYWdlIGluIHRoZSBsaXN0LiAqL1xuICAgIEBJbnB1dCgpXG4gICAgcGFnZVNpemU6IG51bWJlciA9IHRoaXMuREVGQVVMVF9QQUdJTkFUSU9OLm1heEl0ZW1zO1xuXG4gICAgLyoqIERlZmluZSB0aGUgc2VsZWN0aW9uIG1vZGUgZm9yIGRvY3VtZW50IGxpc3QuIFRoZSBhbGxvd2VkIHZhbHVlcyBhcmUgc2luZ2xlIG9yIG11bHRpcGxlICovXG4gICAgQElucHV0KClcbiAgICBzZWxlY3Rpb25Nb2RlOiAnc2luZ2xlJyB8ICdtdWx0aXBsZScgPSAnc2luZ2xlJztcblxuICAgIC8qKiBGdW5jdGlvbiB1c2VkIHRvIGRlY2lkZSBpZiB0aGUgc2VsZWN0ZWQgbm9kZSBoYXMgcGVybWlzc2lvbiB0byBiZSBzZWxlY3RlZC5cbiAgICAgKiBEZWZhdWx0IHZhbHVlIGlzIGEgZnVuY3Rpb24gdGhhdCBhbHdheXMgcmV0dXJucyB0cnVlLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgaXNTZWxlY3Rpb25WYWxpZDogVmFsaWRhdGlvbkZ1bmN0aW9uID0gZGVmYXVsdFZhbGlkYXRpb247XG5cbiAgICAvKiogVHJhbnNmb3JtYXRpb24gdG8gYmUgcGVyZm9ybWVkIG9uIHRoZSBjaG9zZW4vZm9sZGVyIG5vZGUgYmVmb3JlIGJ1aWxkaW5nIHRoZVxuICAgICAqIGJyZWFkY3J1bWIgVUkuIENhbiBiZSB1c2VmdWwgd2hlbiBjdXN0b20gZm9ybWF0dGluZyBpcyBuZWVkZWQgZm9yIHRoZSBicmVhZGNydW1iLlxuICAgICAqIFlvdSBjYW4gY2hhbmdlIHRoZSBwYXRoIGVsZW1lbnRzIGZyb20gdGhlIG5vZGUgdGhhdCBhcmUgdXNlZCB0byBidWlsZCB0aGVcbiAgICAgKiBicmVhZGNydW1iIHVzaW5nIHRoaXMgZnVuY3Rpb24uXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBicmVhZGNydW1iVHJhbnNmb3JtOiAobm9kZSkgPT4gYW55O1xuXG4gICAgLyoqIFRvZ2dsZSBzZWFyY2ggaW5wdXQgcmVuZGVyaW5nICovXG4gICAgQElucHV0KClcbiAgICBzZXQgc2hvd1NlYXJjaCh2YWx1ZTogYm9vbGVhbikge1xuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCAmJiB2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5zaG93U2VhcmNoRmllbGQgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBzaG93U2VhcmNoKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zaG93U2VhcmNoRmllbGQ7XG4gICAgfVxuXG4gICAgLyoqIFRvZ2dsZSBzaXRlcyBsaXN0IGRyb3Bkb3duIHJlbmRlcmluZyAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IHNob3dEcm9wZG93blNpdGVMaXN0KHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnNob3dTaXRlTGlzdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IHNob3dEcm9wZG93blNpdGVMaXN0KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zaG93U2l0ZUxpc3Q7XG4gICAgfVxuXG4gICAgLyoqIFNob3dzIHRoZSBmaWxlcyBhbmQgZm9sZGVycyBpbiB0aGUgc2VhcmNoIHJlc3VsdCAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2V0IHNob3dGaWxlc0luUmVzdWx0KHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICAgICAgICBjb25zdCBzaG93RmlsZXNRdWVyeSA9IGBUWVBFOidjbTpmb2xkZXInJHt2YWx1ZSA/IFwiIE9SIFRZUEU6J2NtOmNvbnRlbnQnXCIgOiAnJ31gO1xuICAgICAgICAgICAgdGhpcy5xdWVyeUJ1aWxkZXJTZXJ2aWNlLmFkZEZpbHRlclF1ZXJ5KHNob3dGaWxlc1F1ZXJ5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKiBTaG93cyB0aGUgbm9kZSBjb3VudGVyIGluIHRoZSBicmVhZGNydW1iICovXG4gICAgQElucHV0KClcbiAgICBzZXQgc2hvd05vZGVDb3VudGVyKHZhbHVlOiBib29sZWFuKSB7XG4gICAgICAgIHRoaXMuc2hvd0NvdW50ZXIgPSB2YWx1ZSA/PyBmYWxzZTtcbiAgICB9XG5cbiAgICBnZXQgc2hvd05vZGVDb3VudGVyKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5zaG93Q291bnRlcjtcbiAgICB9XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSB1c2VyIGhhcyBjaG9zZW4gYW4gaXRlbS4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBzZWxlY3QgPSBuZXcgRXZlbnRFbWl0dGVyPE5vZGVbXT4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gdGhlIG5hdmlnYXRpb24gY2hhbmdlcy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBuYXZpZ2F0aW9uQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxOb2RlRW50cnlFdmVudD4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gdGhlIHNlbGVjdCBzaXRlIGNoYW5nZXMuICovXG4gICAgQE91dHB1dCgpXG4gICAgc2l0ZUNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8c3RyaW5nPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBzZWFyY2ggaXMgcnVubmluZy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBzaG93aW5nU2VhcmNoID0gbmV3IEV2ZW50RW1pdHRlcjxib29sZWFuPigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiBjdXJyZW50IGZvbGRlciBsb2FkZWQuICovXG4gICAgQE91dHB1dCgpXG4gICAgY3VycmVudEZvbGRlciA9IG5ldyBFdmVudEVtaXR0ZXI8Tm9kZT4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gZm9sZGVyIGxvYWRlZC4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBmb2xkZXJMb2FkZWQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBAVmlld0NoaWxkKCdkb2N1bWVudExpc3QnLCB7IHN0YXRpYzogdHJ1ZSB9KVxuICAgIGRvY3VtZW50TGlzdDogRG9jdW1lbnRMaXN0Q29tcG9uZW50O1xuXG4gICAgQFZpZXdDaGlsZChIaWdobGlnaHREaXJlY3RpdmUsIHsgc3RhdGljOiB0cnVlIH0pXG4gICAgaGlnaGxpZ2h0ZXI6IEhpZ2hsaWdodERpcmVjdGl2ZTtcblxuICAgIG5vZGVQYWdpbmc6IE5vZGVQYWdpbmcgfCBudWxsID0gbnVsbDtcbiAgICBzaXRlSWQ6IG51bGwgfCBzdHJpbmc7XG4gICAgYnJlYWRjcnVtYlJvb3RJZDogbnVsbCB8IHN0cmluZztcbiAgICBzZWFyY2hUZXJtOiBzdHJpbmcgPSAnJztcbiAgICBzaG93aW5nU2VhcmNoUmVzdWx0czogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGxvYWRpbmdTZWFyY2hSZXN1bHRzOiBib29sZWFuID0gZmFsc2U7XG4gICAgaW5EaWFsb2c6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBfY2hvc2VuTm9kZTogTm9kZSBbXSA9IG51bGw7XG4gICAgZm9sZGVySWRUb1Nob3c6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAgIGJyZWFkY3J1bWJGb2xkZXJUaXRsZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgc3RhcnRTaXRlR3VpZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XG4gICAgaGFzVmFsaWRRdWVyeTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHNob3dIZWFkZXIgPSBTaG93SGVhZGVyTW9kZS5OZXZlcjtcblxuICAgIEBWaWV3Q2hpbGQoSW5maW5pdGVQYWdpbmF0aW9uQ29tcG9uZW50LCB7IHN0YXRpYzogdHJ1ZSB9KVxuICAgIGluZmluaXRlUGFnaW5hdGlvbkNvbXBvbmVudDogSW5maW5pdGVQYWdpbmF0aW9uQ29tcG9uZW50O1xuXG4gICAgaW5maW5pdGVTY3JvbGw6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBkZWJvdW5jZVNlYXJjaDogbnVtYmVyID0gMjAwO1xuICAgIHNlYXJjaElucHV0OiBGb3JtQ29udHJvbCA9IG5ldyBGb3JtQ29udHJvbCgpO1xuXG4gICAgdGFyZ2V0OiBQYWdpbmF0ZWRDb21wb25lbnQ7XG4gICAgcHJlc2VsZWN0ZWROb2RlczogTm9kZUVudHJ5W10gPSBbXTtcbiAgICBjdXJyZW50VXBsb2FkQmF0Y2g6IE5vZGVFbnRyeVtdID0gW107XG5cbiAgICBzb3J0aW5nOiBzdHJpbmdbXSB8IERhdGFTb3J0aW5nO1xuXG4gICAgc2VhcmNoUGFuZWxFeHBhbmRlZDogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgcHJpdmF0ZSBvbkRlc3Ryb3kkID0gbmV3IFN1YmplY3Q8Ym9vbGVhbj4oKTtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgY3VzdG9tUmVzb3VyY2VzU2VydmljZTogQ3VzdG9tUmVzb3VyY2VzU2VydmljZSxcbiAgICAgICAgICAgICAgICBASW5qZWN0KFNFQVJDSF9RVUVSWV9TRVJWSUNFX1RPS0VOKSBwdWJsaWMgcXVlcnlCdWlsZGVyU2VydmljZTogU2VhcmNoUXVlcnlCdWlsZGVyU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIHVzZXJQcmVmZXJlbmNlc1NlcnZpY2U6IFVzZXJQcmVmZXJlbmNlc1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBub2Rlc0FwaVNlcnZpY2U6IE5vZGVzQXBpU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIHVwbG9hZFNlcnZpY2U6IFVwbG9hZFNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBzaXRlc1NlcnZpY2U6IFNpdGVzU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGFwcENvbmZpZ1NlcnZpY2U6IEFwcENvbmZpZ1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBjb250ZW50Tm9kZVNlbGVjdG9yUGFuZWxTZXJ2aWNlOiBDb250ZW50Tm9kZVNlbGVjdG9yUGFuZWxTZXJ2aWNlKSB7XG4gICAgfVxuXG4gICAgc2V0IGNob3Nlbk5vZGUodmFsdWU6IE5vZGVbXSkge1xuICAgICAgICB0aGlzLl9jaG9zZW5Ob2RlID0gdmFsdWU7XG4gICAgICAgIHRoaXMuc2VsZWN0Lm5leHQodmFsdWUpO1xuICAgIH1cblxuICAgIGdldCBjaG9zZW5Ob2RlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2hvc2VuTm9kZTtcbiAgICB9XG5cbiAgICBnZXRTZWxlY3RlZENvdW50KCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmNob3Nlbk5vZGU/Lmxlbmd0aCB8fCAwO1xuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLnNlYXJjaElucHV0LnZhbHVlQ2hhbmdlc1xuICAgICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICAgICAgZGVib3VuY2VUaW1lKHRoaXMuZGVib3VuY2VTZWFyY2gpLFxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChzZWFyY2hWYWx1ZTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2hUZXJtID0gc2VhcmNoVmFsdWU7XG4gICAgICAgICAgICAgICAgdGhpcy5xdWVyeUJ1aWxkZXJTZXJ2aWNlLnVzZXJRdWVyeSA9IHNlYXJjaFZhbHVlLmxlbmd0aCA+IDAgPyBgJHtzZWFyY2hWYWx1ZX0qYCA6IHNlYXJjaFZhbHVlIDtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXJ5QnVpbGRlclNlcnZpY2UudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnF1ZXJ5QnVpbGRlclNlcnZpY2UudXBkYXRlZFxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMub25EZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChxdWVyeUJvZHk6IFF1ZXJ5Qm9keSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChxdWVyeUJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNWYWxpZFF1ZXJ5ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVwYXJlRGlhbG9nRm9yTmV3U2VhcmNoKHF1ZXJ5Qm9keSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlcnlCdWlsZGVyU2VydmljZS5leGVjdXRlKHF1ZXJ5Qm9keSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNWYWxpZFF1ZXJ5ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVzZXRGb2xkZXJUb1Nob3coKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlYXJjaCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucXVlcnlCdWlsZGVyU2VydmljZS5leGVjdXRlZFxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMub25EZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChyZXN1bHRzOiBOb2RlUGFnaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGFzVmFsaWRRdWVyeSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNob3dTZWFyY2hSZXN1bHRzKHJlc3VsdHMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudXNlclByZWZlcmVuY2VzU2VydmljZVxuICAgICAgICAgICAgLnNlbGVjdChVc2VyUHJlZmVyZW5jZVZhbHVlcy5QYWdpbmF0aW9uU2l6ZSlcbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZShwYWdTaXplID0+IHRoaXMucGFnZVNpemUgPSBwYWdTaXplKTtcblxuICAgICAgICB0aGlzLnRhcmdldCA9IHRoaXMuZG9jdW1lbnRMaXN0O1xuICAgICAgICB0aGlzLmZvbGRlcklkVG9TaG93ID0gdGhpcy5jdXJyZW50Rm9sZGVySWQ7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGb2xkZXJJZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMucmVzdHJpY3RSb290VG9DdXJyZW50Rm9sZGVySWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJyZWFkY3J1bWJSb290SWQgPSB0aGlzLmN1cnJlbnRGb2xkZXJJZDtcbiAgICAgICAgICAgICAgICB0aGlzLnNpdGVJZCA9IHRoaXMuY3VycmVudEZvbGRlcklkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLmdldFN0YXJ0U2l0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5icmVhZGNydW1iVHJhbnNmb3JtID0gdGhpcy5icmVhZGNydW1iVHJhbnNmb3JtID8gdGhpcy5icmVhZGNydW1iVHJhbnNmb3JtIDogbnVsbDtcbiAgICAgICAgdGhpcy5pc1NlbGVjdGlvblZhbGlkID0gdGhpcy5pc1NlbGVjdGlvblZhbGlkID8gdGhpcy5pc1NlbGVjdGlvblZhbGlkIDogZGVmYXVsdFZhbGlkYXRpb247XG4gICAgICAgIHRoaXMub25GaWxlVXBsb2FkRXZlbnQoKTtcbiAgICAgICAgdGhpcy5vbkZpbGVVcGxvYWREZWxldGVkRXZlbnQoKTtcbiAgICAgICAgdGhpcy5yZXNldFBhZ2luYXRpb24oKTtcbiAgICAgICAgdGhpcy5zZXRTZWFyY2hTY29wZVRvTm9kZXMoKTtcblxuICAgICAgICB0aGlzLmRvY3VtZW50TGlzdC4kZm9sZGVyTm9kZVxuICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKSlcbiAgICAgICAgLnN1YnNjcmliZSgoY3VycmVudE5vZGU6IE5vZGUpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY3VycmVudEZvbGRlci5lbWl0KGN1cnJlbnROb2RlKTtcbiAgICB9KTtcblxuICAgICAgICB0aGlzLnNvcnRpbmcgPSB0aGlzLmFwcENvbmZpZ1NlcnZpY2UuZ2V0KCdhZGYtY29udGVudC1ub2RlLXNlbGVjdG9yLnNvcnRpbmcnLCBbJ2NyZWF0ZWRBdCcsICdkZXNjJ10pO1xuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLm9uRGVzdHJveSQubmV4dCh0cnVlKTtcbiAgICAgICAgdGhpcy5vbkRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gICAgfVxuXG4gICAgdG9nZ2xlU2VhcmNoUGFuZWwoKSB7XG4gICAgICAgIHRoaXMuc2VhcmNoUGFuZWxFeHBhbmRlZCA9ICF0aGlzLnNlYXJjaFBhbmVsRXhwYW5kZWQ7XG4gICAgfVxuXG4gICAgaGFzQ3VzdG9tTW9kZWxzKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb250ZW50Tm9kZVNlbGVjdG9yUGFuZWxTZXJ2aWNlPy5jdXN0b21Nb2RlbHM/Lmxlbmd0aCA+IDA7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkZpbGVVcGxvYWRFdmVudCgpIHtcbiAgICAgICAgdGhpcy51cGxvYWRTZXJ2aWNlLmZpbGVVcGxvYWRDb21wbGV0ZVxuICAgICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICAgICAgZGVib3VuY2VUaW1lKDUwMCksXG4gICAgICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMub25EZXN0cm95JClcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKGZpbGVVcGxvYWRFdmVudDogRmlsZVVwbG9hZENvbXBsZXRlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVcGxvYWRCYXRjaC5wdXNoKGZpbGVVcGxvYWRFdmVudC5kYXRhKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudXBsb2FkU2VydmljZS5pc1VwbG9hZGluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlc2VsZWN0ZWROb2RlcyA9IHRoaXMuZ2V0UHJlc2VsZWN0Tm9kZXNCYXNlZE9uU2VsZWN0aW9uTW9kZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVcGxvYWRCYXRjaCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50TGlzdC5yZWxvYWRXaXRob3V0UmVzZXR0aW5nU2VsZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkZpbGVVcGxvYWREZWxldGVkRXZlbnQoKSB7XG4gICAgICAgIHRoaXMudXBsb2FkU2VydmljZS5maWxlVXBsb2FkRGVsZXRlZFxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMub25EZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKChkZWxldGVkRmlsZUV2ZW50OiBGaWxlVXBsb2FkRGVsZXRlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRvY3VtZW50TGlzdC51bnNlbGVjdFJvd0Zyb21Ob2RlSWQoZGVsZXRlZEZpbGVFdmVudC5maWxlLmRhdGEuZW50cnkuaWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRMaXN0LnJlbG9hZFdpdGhvdXRSZXNldHRpbmdTZWxlY3Rpb24oKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0U3RhcnRTaXRlKCkge1xuICAgICAgICB0aGlzLm5vZGVzQXBpU2VydmljZS5nZXROb2RlKHRoaXMuY3VycmVudEZvbGRlcklkKS5zdWJzY3JpYmUoKHN0YXJ0Tm9kZUVudHJ5KSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0U2l0ZUd1aWQgPSB0aGlzLnNpdGVzU2VydmljZS5nZXRTaXRlTmFtZUZyb21Ob2RlUGF0aChzdGFydE5vZGVFbnRyeSk7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFydFNpdGVHdWlkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zaXRlc1NlcnZpY2UuZ2V0U2l0ZSh0aGlzLnN0YXJ0U2l0ZUd1aWQpLnN1YnNjcmliZSgoc3RhcnRTaXRlRW50cnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0U2l0ZUVudHJ5IGluc3RhbmNlb2YgU2l0ZUVudHJ5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNpdGVDaGFuZ2UuZW1pdChzdGFydFNpdGVFbnRyeS5lbnRyeS50aXRsZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVSb3dGaWx0ZXIoZmlsdGVyPzogUm93RmlsdGVyKSB7XG4gICAgICAgIGlmICghZmlsdGVyKSB7XG4gICAgICAgICAgICBmaWx0ZXIgPSAoKSA9PiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3Jvd0ZpbHRlciA9ICh2YWx1ZTogU2hhcmVEYXRhUm93LCBpbmRleDogbnVtYmVyLCBhcnJheTogU2hhcmVEYXRhUm93W10pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXIodmFsdWUsIGluZGV4LCBhcnJheSkgJiZcbiAgICAgICAgICAgICAgICAhdGhpcy5pc0V4Y2x1ZGVkU2l0ZUNvbnRlbnQodmFsdWUpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgaXNFeGNsdWRlZFNpdGVDb250ZW50KHJvdzogU2hhcmVEYXRhUm93KTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGVudHJ5ID0gcm93Lm5vZGUuZW50cnk7XG4gICAgICAgIGlmICh0aGlzLl9leGNsdWRlU2l0ZUNvbnRlbnQgJiYgdGhpcy5fZXhjbHVkZVNpdGVDb250ZW50Lmxlbmd0aCAmJlxuICAgICAgICAgICAgZW50cnkgJiZcbiAgICAgICAgICAgIGVudHJ5LnByb3BlcnRpZXMgJiZcbiAgICAgICAgICAgIGVudHJ5LnByb3BlcnRpZXNbJ3N0OmNvbXBvbmVudElkJ10pIHtcbiAgICAgICAgICAgIGNvbnN0IGV4Y2x1ZGVkSXRlbSA9IHRoaXMuX2V4Y2x1ZGVTaXRlQ29udGVudC5maW5kKFxuICAgICAgICAgICAgICAgIChpZDogc3RyaW5nKSA9PiBlbnRyeS5wcm9wZXJ0aWVzWydzdDpjb21wb25lbnRJZCddID09PSBpZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHJldHVybiAhIWV4Y2x1ZGVkSXRlbTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgc2l0ZSBhdHRyaWJ1dGUgYW5kIHN0YXJ0cyBhIG5ldyBzZWFyY2hcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjaG9zZW5TaXRlIFNpdGVFbnRyeSB0byBzZWFyY2ggd2l0aGluXG4gICAgICovXG4gICAgc2l0ZUNoYW5nZWQoY2hvc2VuU2l0ZTogU2l0ZUVudHJ5KTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2l0ZUlkID0gY2hvc2VuU2l0ZS5lbnRyeS5ndWlkO1xuICAgICAgICB0aGlzLnNldFRpdGxlSWZDdXN0b21TaXRlKGNob3NlblNpdGUpO1xuICAgICAgICB0aGlzLnNpdGVDaGFuZ2UuZW1pdChjaG9zZW5TaXRlLmVudHJ5LnRpdGxlKTtcbiAgICAgICAgdGhpcy5xdWVyeUJ1aWxkZXJTZXJ2aWNlLnVwZGF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGFjdHVhbGx5IHNlbGVjdGVkfGVudGVyZWQgZm9sZGVyIG5vZGUgb3IgbnVsbCBpbiBjYXNlIG9mIHNlYXJjaGluZyBmb3IgdGhlIGJyZWFkY3J1bWJcbiAgICAgKi9cbiAgICBnZXQgYnJlYWRjcnVtYkZvbGRlck5vZGUoKTogTm9kZSB8IG51bGwge1xuICAgICAgICBsZXQgZm9sZGVyTm9kZTogTm9kZTtcblxuICAgICAgICBpZiAodGhpcy5zaG93aW5nU2VhcmNoUmVzdWx0cyAmJiB0aGlzLmNob3Nlbk5vZGUpIHtcbiAgICAgICAgICAgIGZvbGRlck5vZGUgPSB0aGlzLmNob3Nlbk5vZGVbMF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb2xkZXJOb2RlID0gdGhpcy5kb2N1bWVudExpc3QuZm9sZGVyTm9kZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmb2xkZXJOb2RlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByZXBhcmVzIHRoZSBkaWFsb2cgZm9yIGEgbmV3IHNlYXJjaFxuICAgICAqL1xuICAgIHByZXBhcmVEaWFsb2dGb3JOZXdTZWFyY2gocXVlcnlCb2R5OiBRdWVyeUJvZHkpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50YXJnZXQgPSBxdWVyeUJvZHkgPyBudWxsIDogdGhpcy5kb2N1bWVudExpc3Q7XG4gICAgICAgIGlmICh0aGlzLnRhcmdldCkge1xuICAgICAgICAgICAgdGhpcy5pbmZpbml0ZVBhZ2luYXRpb25Db21wb25lbnQucmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmZvbGRlcklkVG9TaG93ID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcmVzZWxlY3RlZE5vZGVzID0gW107XG4gICAgICAgIHRoaXMubG9hZGluZ1NlYXJjaFJlc3VsdHMgPSB0cnVlO1xuICAgICAgICB0aGlzLmFkZENvcnJlc3BvbmRpbmdOb2RlSWRzUXVlcnkoKTtcbiAgICAgICAgdGhpcy5yZXNldENob3Nlbk5vZGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciB0aGUgc2VhcmNoIGlucHV0IGFuZCByZXNldCB0byBsYXN0IGZvbGRlciBub2RlIGluIHdoaWNoIHNlYXJjaCB3YXMgcGVyZm9ybWVkXG4gICAgICovXG4gICAgY2xlYXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc2VhcmNoVGVybSA9ICcnO1xuICAgICAgICB0aGlzLnF1ZXJ5QnVpbGRlclNlcnZpY2UudXNlclF1ZXJ5ID0gJyc7XG4gICAgICAgIHRoaXMucXVlcnlCdWlsZGVyU2VydmljZS51cGRhdGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGZvbGRlciB0byBiZSBzaG93biB3aXRoIHRoZSBzaXRlIHNlbGVjdGlvbiBvciB0aGUgaW5pdGlhbCBsYW5kaW5nIGZvbGRlclxuICAgICAqL1xuICAgIHJlc2V0Rm9sZGVyVG9TaG93KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmZvbGRlcklkVG9TaG93ID0gdGhpcy5zaXRlSWQgfHwgdGhpcy5jdXJyZW50Rm9sZGVySWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXIgdGhlIHNlYXJjaCBpbnB1dCBhbmQgc2VhcmNoIHJlbGF0ZWQgZGF0YVxuICAgICAqL1xuICAgIGNsZWFyU2VhcmNoKCkge1xuICAgICAgICB0aGlzLnNlYXJjaFRlcm0gPSAnJztcbiAgICAgICAgdGhpcy5ub2RlUGFnaW5nID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZXNldFBhZ2luYXRpb24oKTtcbiAgICAgICAgdGhpcy5yZXNldENob3Nlbk5vZGUoKTtcbiAgICAgICAgdGhpcy5zaG93aW5nU2VhcmNoUmVzdWx0cyA9IGZhbHNlO1xuICAgICAgICB0aGlzLnNob3dpbmdTZWFyY2guZW1pdCh0aGlzLnNob3dpbmdTZWFyY2hSZXN1bHRzKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZENvcnJlc3BvbmRpbmdOb2RlSWRzUXVlcnkoKSB7XG4gICAgICAgIGxldCBleHRyYVBhcmVudEZpbHRlcmluZyA9ICcnO1xuXG4gICAgICAgIGlmICh0aGlzLmN1c3RvbVJlc291cmNlc1NlcnZpY2UuaGFzQ29ycmVzcG9uZGluZ05vZGVJZHModGhpcy5zaXRlSWQpKSB7XG4gICAgICAgICAgICB0aGlzLmN1c3RvbVJlc291cmNlc1NlcnZpY2UuZ2V0Q29ycmVzcG9uZGluZ05vZGVJZHModGhpcy5zaXRlSWQpXG4gICAgICAgICAgICAgICAgLnN1YnNjcmliZSgobm9kZUlkcykgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAobm9kZUlkcyAmJiBub2RlSWRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlkc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoKGlkKSA9PiBpZCAhPT0gdGhpcy5zaXRlSWQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZvckVhY2goKGV4dHJhSWQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFQYXJlbnRGaWx0ZXJpbmcgKz0gYCBPUiBBTkNFU1RPUjond29ya3NwYWNlOi8vU3BhY2VzU3RvcmUvJHtleHRyYUlkfSdgO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcmVudEZpbHRlcmluZyA9IHRoaXMuc2l0ZUlkID8gYEFOQ0VTVE9SOid3b3Jrc3BhY2U6Ly9TcGFjZXNTdG9yZS8ke3RoaXMuc2l0ZUlkfScke2V4dHJhUGFyZW50RmlsdGVyaW5nfWAgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeUJ1aWxkZXJTZXJ2aWNlLmFkZEZpbHRlclF1ZXJ5KHBhcmVudEZpbHRlcmluZyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBwYXJlbnRGaWx0ZXJpbmcgPSB0aGlzLnNpdGVJZCA/IGBBTkNFU1RPUjond29ya3NwYWNlOi8vU3BhY2VzU3RvcmUvJHt0aGlzLnNpdGVJZH0nYCA6ICcnO1xuICAgICAgICAgICAgdGhpcy5xdWVyeUJ1aWxkZXJTZXJ2aWNlLmFkZEZpbHRlclF1ZXJ5KHBhcmVudEZpbHRlcmluZyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFNlYXJjaFNjb3BlVG9Ob2RlcygpIHtcbiAgICAgICAgY29uc3Qgc2NvcGU6IFJlcXVlc3RTY29wZSA9IHtcbiAgICAgICAgICAgIGxvY2F0aW9uczogJ25vZGVzJ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnF1ZXJ5QnVpbGRlclNlcnZpY2Uuc2V0U2NvcGUoc2NvcGUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNob3cgdGhlIHJlc3VsdHMgb2YgdGhlIHNlYXJjaFxuICAgICAqXG4gICAgICogQHBhcmFtIHJlc3VsdHMgU2VhcmNoIHJlc3VsdHNcbiAgICAgKi9cbiAgICBwcml2YXRlIHNob3dTZWFyY2hSZXN1bHRzKHJlc3VsdHM6IE5vZGVQYWdpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zaG93aW5nU2VhcmNoUmVzdWx0cyA9IHRydWU7XG4gICAgICAgIHRoaXMubG9hZGluZ1NlYXJjaFJlc3VsdHMgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zaG93aW5nU2VhcmNoLmVtaXQodGhpcy5zaG93aW5nU2VhcmNoUmVzdWx0cyk7XG5cbiAgICAgICAgdGhpcy5ub2RlUGFnaW5nID0gcmVzdWx0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXRzIHNob3dpbmdTZWFyY2hSZXN1bHRzIHN0YXRlIHRvIGJlIGFibGUgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIHNlYXJjaCByZXN1bHRzIG9yIGZvbGRlciByZXN1bHRzXG4gICAgICovXG4gICAgb25Gb2xkZXJDaGFuZ2UoJGV2ZW50OiBOb2RlRW50cnlFdmVudCk6IHZvaWQge1xuICAgICAgICB0aGlzLmZvbGRlcklkVG9TaG93ID0gJGV2ZW50LnZhbHVlLmlkO1xuICAgICAgICB0aGlzLnNob3dpbmdTZWFyY2hSZXN1bHRzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuaW5maW5pdGVTY3JvbGwgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5icmVhZGNydW1iRm9sZGVyVGl0bGUgPSBudWxsO1xuICAgICAgICB0aGlzLnByZXNlbGVjdGVkTm9kZXMgPSBbXTtcbiAgICAgICAgdGhpcy5jbGVhclNlYXJjaCgpO1xuICAgICAgICB0aGlzLm5hdmlnYXRpb25DaGFuZ2UuZW1pdCgkZXZlbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEF0dGVtcHRzIHRvIHNldCB0aGUgY3VycmVudGx5IGxvYWRlZCBub2RlXG4gICAgICovXG4gICAgb25Gb2xkZXJMb2FkZWQobm9kZVBhZ2luZzogTm9kZVBhZ2luZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnVwZGF0ZVBhZ2luYXRpb25BZnRlclJvd0ZpbHRlcihub2RlUGFnaW5nKTtcbiAgICAgICAgaWYgKCF0aGlzLnNob3dpbmdTZWFyY2hSZXN1bHRzKSB7XG4gICAgICAgICAgICB0aGlzLmF0dGVtcHROb2RlU2VsZWN0aW9uKHRoaXMuZG9jdW1lbnRMaXN0LmZvbGRlck5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZm9sZGVyTG9hZGVkLmVtaXQoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHBhZ2luYXRpb24uaGFzTW9yZUl0ZW1zIHRvIGZhbHNlIGFmdGVyIGZpbHRlcmluZyBvbmx5IGZvbGRlcnMgZHVyaW5nICdDT1BZJyBhbmQgJ01PVkUnIGFjdGlvblxuICAgICAqL1xuICAgIHVwZGF0ZVBhZ2luYXRpb25BZnRlclJvd0ZpbHRlcihub2RlUGFnaW5nOiBOb2RlUGFnaW5nKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmRvY3VtZW50TGlzdC5kYXRhLmdldFJvd3MoKS5sZW5ndGggPCBub2RlUGFnaW5nLmxpc3QucGFnaW5hdGlvbi5tYXhJdGVtcykge1xuICAgICAgICAgICAgbm9kZVBhZ2luZy5saXN0LnBhZ2luYXRpb24uaGFzTW9yZUl0ZW1zID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgYnJlYWRjcnVtYiBoYXMgdG8gYmUgc2hvd24gb3Igbm90XG4gICAgICovXG4gICAgc2hvd0JyZWFkY3J1bWJzKCkge1xuICAgICAgICByZXR1cm4gIXRoaXMuc2hvd2luZ1NlYXJjaFJlc3VsdHMgfHwgdGhpcy5jaG9zZW5Ob2RlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWRzIHRoZSBuZXh0IGJhdGNoIG9mIHNlYXJjaCByZXN1bHRzXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFnaW5hdGlvbiBQYWdpbmF0aW9uIG9iamVjdFxuICAgICAqL1xuICAgIGdldE5leHRQYWdlT2ZTZWFyY2gocGFnaW5hdGlvbjogUGFnaW5hdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmluZmluaXRlU2Nyb2xsID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5xdWVyeUJ1aWxkZXJTZXJ2aWNlLnBhZ2luZy5tYXhJdGVtcyA9IHBhZ2luYXRpb24ubWF4SXRlbXM7XG4gICAgICAgIHRoaXMucXVlcnlCdWlsZGVyU2VydmljZS5wYWdpbmcuc2tpcENvdW50ID0gcGFnaW5hdGlvbi5za2lwQ291bnQ7XG5cbiAgICAgICAgaWYgKHRoaXMuc2VhcmNoVGVybS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0aGlzLnF1ZXJ5QnVpbGRlclNlcnZpY2UudXBkYXRlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWxlY3RzIG5vZGUgYXMgY2hvc2VuIGlmIGl0IGhhcyB0aGUgcmlnaHQgcGVybWlzc2lvbiwgY2xlYXJzIHRoZSBzZWxlY3Rpb24gb3RoZXJ3aXNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZW50cnlcbiAgICAgKi9cbiAgICBwcml2YXRlIGF0dGVtcHROb2RlU2VsZWN0aW9uKGVudHJ5OiBOb2RlKTogdm9pZCB7XG4gICAgICAgIGlmIChlbnRyeSAmJiB0aGlzLmlzU2VsZWN0aW9uVmFsaWQoZW50cnkpKSB7XG4gICAgICAgICAgICB0aGlzLmNob3Nlbk5vZGUgPSBbZW50cnldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2xlYXJzIHRoZSBjaG9zZW4gbm9kZVxuICAgICAqL1xuICAgIHJlc2V0Q2hvc2VuTm9kZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jaG9zZW5Ob2RlID0gbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJdCBmaWx0ZXJzIGFuZCBlbWl0IHRoZSBzZWxlY3Rpb24gY29taW5nIGZyb20gdGhlIGRvY3VtZW50IGxpc3RcbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2Rlc0VudHJpZXNcbiAgICAgKi9cbiAgICBvbkN1cnJlbnRTZWxlY3Rpb24obm9kZXNFbnRyaWVzOiBOb2RlRW50cnlbXSk6IHZvaWQge1xuICAgICAgICBjb25zdCB2YWxpZE5vZGVzRW50aXR5ID0gbm9kZXNFbnRyaWVzLmZpbHRlcigobm9kZSkgPT4gdGhpcy5pc1NlbGVjdGlvblZhbGlkKG5vZGUuZW50cnkpKTtcbiAgICAgICAgdGhpcy5jaG9zZW5Ob2RlID0gdmFsaWROb2Rlc0VudGl0eS5tYXAoKG5vZGUpID0+IG5vZGUuZW50cnkpO1xuICAgIH1cblxuICAgIHNldFRpdGxlSWZDdXN0b21TaXRlKHNpdGU6IFNpdGVFbnRyeSkge1xuICAgICAgICBpZiAodGhpcy5jdXN0b21SZXNvdXJjZXNTZXJ2aWNlLmlzQ3VzdG9tU291cmNlKHNpdGUuZW50cnkuZ3VpZCkpIHtcbiAgICAgICAgICAgIHRoaXMuYnJlYWRjcnVtYkZvbGRlclRpdGxlID0gc2l0ZS5lbnRyeS50aXRsZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmRvY3VtZW50TGlzdC5mb2xkZXJOb2RlLnBhdGguZWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmJyZWFkY3J1bWJGb2xkZXJOb2RlLm5hbWUgPSBzaXRlLmVudHJ5LnRpdGxlO1xuICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRMaXN0LmZvbGRlck5vZGUucGF0aC5lbGVtZW50cyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmJyZWFkY3J1bWJGb2xkZXJUaXRsZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBoYXNQcmVzZWxlY3ROb2RlcygpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJlc2VsZWN0ZWROb2Rlcz8ubGVuZ3RoID4gMDtcbiAgICB9XG5cbiAgICBpc1NpbmdsZVNlbGVjdGlvbk1vZGUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbk1vZGUgPT09ICdzaW5nbGUnO1xuICAgIH1cblxuICAgIGdldFByZXNlbGVjdE5vZGVzQmFzZWRPblNlbGVjdGlvbk1vZGUoKTogTm9kZUVudHJ5W10ge1xuICAgICAgICBsZXQgc2VsZWN0ZWROb2RlczogTm9kZUVudHJ5W10gPSBbXTtcblxuICAgICAgICBpZiAodGhpcy5jdXJyZW50VXBsb2FkQmF0Y2g/Lmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNTaW5nbGVTZWxlY3Rpb25Nb2RlKCkpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGVzID0gW3RoaXMuY3VycmVudFVwbG9hZEJhdGNoW3RoaXMuY3VycmVudFVwbG9hZEJhdGNoLmxlbmd0aCAtIDFdXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0ZWROb2RlcyA9IHRoaXMuY3VycmVudFVwbG9hZEJhdGNoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkTm9kZXM7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSByZXNldFBhZ2luYXRpb24oKTogdm9pZCB7XG4gICAgICAgIHRoaXMucXVlcnlCdWlsZGVyU2VydmljZS5wYWdpbmcgPSB7XG4gICAgICAgICAgICBtYXhJdGVtczogdGhpcy5wYWdlU2l6ZSxcbiAgICAgICAgICAgIHNraXBDb3VudDogdGhpcy5ERUZBVUxUX1BBR0lOQVRJT04uc2tpcENvdW50XG4gICAgICAgIH07XG4gICAgfVxufVxuIl19
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { FileUploadStatus, UploadService, UserPreferencesService } from '@alfresco/adf-core';
import { ChangeDetectorRef, Component, Input, Output, EventEmitter, ViewChild, HostBinding, ElementRef } from '@angular/core';
import { merge, Subject } from 'rxjs';
import { FileUploadingListComponent } from './file-uploading-list.component';
import { takeUntil, delay } from 'rxjs/operators';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@alfresco/adf-core';
import * as ɵngcc2 from '@angular/common';
import * as ɵngcc3 from '@angular/material/button';
import * as ɵngcc4 from '@angular/material/icon';
import * as ɵngcc5 from '@angular/material/list';
import * as ɵngcc6 from './file-uploading-list.component';
import * as ɵngcc7 from './file-uploading-list-row.component';
import * as ɵngcc8 from '@angular/cdk/a11y';
import * as ɵngcc9 from '@ngx-translate/core';

const _c0 = ["uploadList"];
const _c1 = function (a0, a1) { return { completed: a0, total: a1 }; };
function FileUploadingDialogComponent_div_0_span_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 15);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind2(2, 1, "FILE_UPLOAD.MESSAGES.UPLOAD_PROGRESS", ɵngcc0.ɵɵpureFunction2(4, _c1, ctx_r1.totalCompleted, ctx_r1.filesUploadingList.length)), " ");
} }
function FileUploadingDialogComponent_div_0_span_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 15);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(2, 1, "FILE_UPLOAD.MESSAGES.UPLOAD_CANCELED"), " ");
} }
const _c2 = function (a0) { return { total: a0 }; };
function FileUploadingDialogComponent_div_0_section_10_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "section", 16);
    ɵngcc0.ɵɵtext(1);
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind2(2, 1, ctx_r3.totalErrors > 1 ? "FILE_UPLOAD.MESSAGES.UPLOAD_ERRORS" : "FILE_UPLOAD.MESSAGES.UPLOAD_ERROR", ɵngcc0.ɵɵpureFunction1(4, _c2, ctx_r3.totalErrors)), " ");
} }
function FileUploadingDialogComponent_div_0_ng_template_14_Template(rf, ctx) { if (rf & 1) {
    const _r10 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "adf-file-uploading-list-row", 17);
    ɵngcc0.ɵɵlistener("remove", function FileUploadingDialogComponent_div_0_ng_template_14_Template_adf_file_uploading_list_row_remove_0_listener() { ɵngcc0.ɵɵrestoreView(_r10); const file_r8 = ctx.$implicit; ɵngcc0.ɵɵnextContext(); const _r4 = ɵngcc0.ɵɵreference(13); return _r4.removeFile(file_r8); })("cancel", function FileUploadingDialogComponent_div_0_ng_template_14_Template_adf_file_uploading_list_row_cancel_0_listener() { ɵngcc0.ɵɵrestoreView(_r10); const file_r8 = ctx.$implicit; ɵngcc0.ɵɵnextContext(); const _r4 = ɵngcc0.ɵɵreference(13); return _r4.cancelFile(file_r8); });
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const file_r8 = ctx.$implicit;
    ɵngcc0.ɵɵproperty("file", file_r8);
} }
function FileUploadingDialogComponent_div_0_footer_22_button_1_Template(rf, ctx) { if (rf & 1) {
    const _r15 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 21);
    ɵngcc0.ɵɵlistener("click", function FileUploadingDialogComponent_div_0_footer_22_button_1_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r15); const ctx_r14 = ɵngcc0.ɵɵnextContext(3); return ctx_r14.toggleConfirmation(); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_FILE_UPLOAD.ARIA-LABEL.CANCEL_ALL"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(3, 4, "ADF_FILE_UPLOAD.BUTTON.CANCEL_ALL"));
} }
function FileUploadingDialogComponent_div_0_footer_22_button_2_Template(rf, ctx) { if (rf & 1) {
    const _r17 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 22);
    ɵngcc0.ɵɵlistener("click", function FileUploadingDialogComponent_div_0_footer_22_button_2_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r17); const ctx_r16 = ɵngcc0.ɵɵnextContext(3); return ctx_r16.close(); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵtext(2);
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG_CLOSE"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(3, 4, "ADF_FILE_UPLOAD.BUTTON.CLOSE"));
} }
function FileUploadingDialogComponent_div_0_footer_22_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "footer", 18);
    ɵngcc0.ɵɵtemplate(1, FileUploadingDialogComponent_div_0_footer_22_button_1_Template, 4, 6, "button", 19);
    ɵngcc0.ɵɵtemplate(2, FileUploadingDialogComponent_div_0_footer_22_button_2_Template, 4, 6, "button", 20);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r6 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r6.canShowCancelAll());
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r6.canCloseDialog());
} }
function FileUploadingDialogComponent_div_0_footer_23_Template(rf, ctx) { if (rf & 1) {
    const _r19 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "footer", 23);
    ɵngcc0.ɵɵelementStart(1, "button", 24);
    ɵngcc0.ɵɵlistener("click", function FileUploadingDialogComponent_div_0_footer_23_Template_button_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r19); const ctx_r18 = ɵngcc0.ɵɵnextContext(2); return ctx_r18.cancelAllUploads(); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "button", 25);
    ɵngcc0.ɵɵlistener("click", function FileUploadingDialogComponent_div_0_footer_23_Template_button_click_5_listener() { ɵngcc0.ɵɵrestoreView(_r19); const ctx_r20 = ɵngcc0.ɵɵnextContext(2); return ctx_r20.toggleConfirmation(); });
    ɵngcc0.ɵɵpipe(6, "translate");
    ɵngcc0.ɵɵtext(7);
    ɵngcc0.ɵɵpipe(8, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_FILE_UPLOAD.ARIA-LABEL.CONFIRMATION.CANCEL"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(4, 6, "ADF_FILE_UPLOAD.CONFIRMATION.BUTTON.CANCEL"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(6, 8, "ADF_FILE_UPLOAD.ARIA-LABEL.CONFIRMATION.CONTINUE"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(8, 10, "ADF_FILE_UPLOAD.CONFIRMATION.BUTTON.CONTINUE"));
} }
function FileUploadingDialogComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r22 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 1);
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵelementStart(2, "header", 2);
    ɵngcc0.ɵɵelementStart(3, "button", 3);
    ɵngcc0.ɵɵlistener("click", function FileUploadingDialogComponent_div_0_Template_button_click_3_listener() { ɵngcc0.ɵɵrestoreView(_r22); const ctx_r21 = ɵngcc0.ɵɵnextContext(); return ctx_r21.toggleMinimized(); });
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementStart(5, "mat-icon", 4);
    ɵngcc0.ɵɵpipe(6, "translate");
    ɵngcc0.ɵɵtext(7);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(8, FileUploadingDialogComponent_div_0_span_8_Template, 3, 7, "span", 5);
    ɵngcc0.ɵɵtemplate(9, FileUploadingDialogComponent_div_0_span_9_Template, 3, 3, "span", 5);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(10, FileUploadingDialogComponent_div_0_section_10_Template, 3, 6, "section", 6);
    ɵngcc0.ɵɵelementStart(11, "section", 7);
    ɵngcc0.ɵɵelementStart(12, "adf-file-uploading-list", 8, 9);
    ɵngcc0.ɵɵtemplate(14, FileUploadingDialogComponent_div_0_ng_template_14_Template, 1, 1, "ng-template");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(15, "div", 10);
    ɵngcc0.ɵɵelementStart(16, "p", 11);
    ɵngcc0.ɵɵtext(17);
    ɵngcc0.ɵɵpipe(18, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(19, "p", 12);
    ɵngcc0.ɵɵtext(20);
    ɵngcc0.ɵɵpipe(21, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(22, FileUploadingDialogComponent_div_0_footer_22_Template, 3, 2, "footer", 13);
    ɵngcc0.ɵɵtemplate(23, FileUploadingDialogComponent_div_0_footer_23_Template, 9, 12, "footer", 14);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const _r4 = ɵngcc0.ɵɵreference(13);
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassProp("adf-upload-dialog--minimized", ctx_r0.isDialogMinimized);
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 22, "ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG"));
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("disabled", ctx_r0.isConfirmation);
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(4, 24, ctx_r0.isDialogMinimized ? "ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG_MAXIMIZE" : "ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG_MINIMIZE"))("aria-expanded", !ctx_r0.isDialogMinimized);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(6, 26, ctx_r0.isDialogMinimized ? "ADF_FILE_UPLOAD.BUTTON.MAXIMIZE" : "ADF_FILE_UPLOAD.BUTTON.MINIMIZE"));
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate1(" ", ctx_r0.isDialogMinimized ? "keyboard_arrow_up" : "keyboard_arrow_down", " ");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !_r4.isUploadCancelled());
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", _r4.isUploadCancelled());
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.totalErrors);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassProp("adf-upload-dialog--padding", ctx_r0.isConfirmation);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵclassProp("adf-upload-dialog--hide", ctx_r0.isConfirmation);
    ɵngcc0.ɵɵproperty("files", ctx_r0.filesUploadingList);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵclassProp("adf-upload-dialog--hide", !ctx_r0.isConfirmation);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(18, 28, "ADF_FILE_UPLOAD.CONFIRMATION.MESSAGE.TITLE"), " ");
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate1(" ", ɵngcc0.ɵɵpipeBind1(21, 30, "ADF_FILE_UPLOAD.CONFIRMATION.MESSAGE.TEXT"), " ");
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r0.isConfirmation);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.isConfirmation);
} }
export class FileUploadingDialogComponent {
    constructor(uploadService, changeDetector, userPreferencesService, elementRef) {
        this.uploadService = uploadService;
        this.changeDetector = changeDetector;
        this.userPreferencesService = userPreferencesService;
        this.elementRef = elementRef;
        this.direction = 'ltr';
        this.onDestroy$ = new Subject();
        this.position = 'right';
        this.alwaysVisible = false;
        this.error = new EventEmitter();
        this.filesUploadingList = [];
        this.isDialogActive = false;
        this.totalCompleted = 0;
        this.totalErrors = 0;
        this.isDialogMinimized = false;
        this.isConfirmation = false;
        this.dialogActive = new Subject();
    }
    get isPositionRight() {
        return (this.direction === 'ltr' && this.position === 'right')
            || (this.direction === 'rtl' && this.position === 'left')
            || null;
    }
    get isPositionLeft() {
        return (this.direction === 'ltr' && this.position === 'left')
            || (this.direction === 'rtl' && this.position === 'right')
            || null;
    }
    ngOnInit() {
        this.dialogActive
            .pipe(delay(100), takeUntil(this.onDestroy$))
            .subscribe(() => {
            const element = this.elementRef.nativeElement.querySelector('#upload-dialog');
            if (element) {
                element.focus();
            }
        });
        this.listSubscription = this.uploadService.queueChanged
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(fileList => {
            this.filesUploadingList = fileList;
            if (this.filesUploadingList.length && !this.isDialogActive) {
                this.isDialogActive = true;
                this.dialogActive.next();
            }
            else {
                this.dialogActive.next();
            }
        });
        this.counterSubscription = merge(this.uploadService.fileUploadComplete, this.uploadService.fileUploadDeleted)
            .pipe(takeUntil(this.onDestroy$))
            .subscribe((event) => {
            this.totalCompleted = event.totalComplete;
            this.changeDetector.detectChanges();
        });
        this.errorSubscription = this.uploadService.fileUploadError
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(event => {
            this.totalErrors = event.totalError;
            this.changeDetector.detectChanges();
        });
        this.fileUploadSubscription = this.uploadService.fileUpload
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(() => {
            this.changeDetector.detectChanges();
        });
        this.uploadService.fileDeleted
            .pipe(takeUntil(this.onDestroy$))
            .subscribe(objId => {
            if (this.filesUploadingList) {
                const uploadedFile = this.filesUploadingList.find((file) => {
                    return file.data ? file.data.entry.id === objId : false;
                });
                if (uploadedFile) {
                    uploadedFile.status = FileUploadStatus.Cancelled;
                    this.changeDetector.detectChanges();
                }
            }
        });
        this.userPreferencesService.select('textOrientation')
            .pipe(takeUntil(this.onDestroy$))
            .subscribe((textOrientation) => {
            this.direction = textOrientation;
        });
    }
    toggleConfirmation() {
        this.isConfirmation = !this.isConfirmation;
        if (!this.isConfirmation) {
            this.dialogActive.next();
        }
        if (this.isDialogMinimized) {
            this.isDialogMinimized = false;
        }
    }
    cancelAllUploads() {
        this.toggleConfirmation();
        this.dialogActive.next();
        this.uploadList.cancelAllFiles();
    }
    toggleMinimized() {
        this.isDialogMinimized = !this.isDialogMinimized;
        this.changeDetector.detectChanges();
    }
    close() {
        this.isConfirmation = false;
        this.totalCompleted = 0;
        this.totalErrors = 0;
        this.filesUploadingList = [];
        this.isDialogActive = false;
        this.isDialogMinimized = false;
        this.uploadService.clearQueue();
        this.changeDetector.detectChanges();
    }
    ngOnDestroy() {
        this.uploadService.clearQueue();
        this.listSubscription.unsubscribe();
        this.counterSubscription.unsubscribe();
        this.fileUploadSubscription.unsubscribe();
        this.errorSubscription.unsubscribe();
        this.onDestroy$.next(true);
        this.onDestroy$.complete();
    }
    canShowDialog() {
        return this.isDialogActive || this.alwaysVisible;
    }
    canShowCancelAll() {
        var _a;
        return ((_a = this.filesUploadingList) === null || _a === void 0 ? void 0 : _a.length) && this.hasUploadInProgress();
    }
    canCloseDialog() {
        return !this.hasUploadInProgress() && !this.alwaysVisible;
    }
    hasUploadInProgress() {
        var _a, _b;
        return (!((_a = this.uploadList) === null || _a === void 0 ? void 0 : _a.isUploadCompleted()) && !((_b = this.uploadList) === null || _b === void 0 ? void 0 : _b.isUploadCancelled()));
    }
}
FileUploadingDialogComponent.ɵfac = function FileUploadingDialogComponent_Factory(t) { return new (t || FileUploadingDialogComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.UploadService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.UserPreferencesService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
FileUploadingDialogComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: FileUploadingDialogComponent, selectors: [["adf-file-uploading-dialog"]], viewQuery: function FileUploadingDialogComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵviewQuery(_c0, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.uploadList = _t.first);
    } }, hostVars: 2, hostBindings: function FileUploadingDialogComponent_HostBindings(rf, ctx) { if (rf & 2) {
        ɵngcc0.ɵɵattribute("adfUploadDialogRight", ctx.isPositionRight)("adfUploadDialogLeft", ctx.isPositionLeft);
    } }, inputs: { position: "position", alwaysVisible: "alwaysVisible" }, outputs: { error: "error" }, decls: 1, vars: 1, consts: [["role", "dialog", "tabindex", "0", "class", "adf-upload-dialog", "id", "upload-dialog", 3, "adf-upload-dialog--minimized", 4, "ngIf"], ["role", "dialog", "tabindex", "0", "id", "upload-dialog", 1, "adf-upload-dialog"], [1, "adf-upload-dialog__header"], ["mat-button", "", 3, "disabled", "click"], ["mat-list-icon", "", 3, "title"], ["tabindex", "0", "class", "adf-upload-dialog__title", 4, "ngIf"], ["class", "adf-upload-dialog__info", "tabindex", "0", 4, "ngIf"], [1, "adf-upload-dialog__content"], [3, "files"], ["uploadList", ""], ["aria-live", "polite", "aria-labelledby", "confirmationTitle", "aria-describedby", "confirmationDescription", 1, "adf-upload-dialog__confirmation"], ["role", "heading", "id", "confirmationTitle", 1, "adf-upload-dialog__confirmation--title"], ["id", "confirmationDescription", 1, "adf-upload-dialog__confirmation--text"], ["class", "adf-upload-dialog__actions", 4, "ngIf"], ["class", "adf-upload-dialog__actions", "cdkTrapFocus", "", "cdkTrapFocusAutoCapture", "", 4, "ngIf"], ["tabindex", "0", 1, "adf-upload-dialog__title"], ["tabindex", "0", 1, "adf-upload-dialog__info"], [3, "file", "remove", "cancel"], [1, "adf-upload-dialog__actions"], ["id", "adf-upload-dialog-cancel-all", "color", "primary", "mat-button", "", 3, "click", 4, "ngIf"], ["id", "adf-upload-dialog-close", "mat-button", "", "color", "primary", 3, "click", 4, "ngIf"], ["id", "adf-upload-dialog-cancel-all", "color", "primary", "mat-button", "", 3, "click"], ["id", "adf-upload-dialog-close", "mat-button", "", "color", "primary", 3, "click"], ["cdkTrapFocus", "", "cdkTrapFocusAutoCapture", "", 1, "adf-upload-dialog__actions"], ["id", "adf-upload-dialog-cancel", "mat-button", "", 3, "click"], ["id", "adf-upload-dialog-confirm", "mat-button", "", "color", "primary", 3, "click"]], template: function FileUploadingDialogComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, FileUploadingDialogComponent_div_0_Template, 24, 32, "div", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.canShowDialog());
    } }, directives: [ɵngcc2.NgIf, ɵngcc3.MatButton, ɵngcc4.MatIcon, ɵngcc5.MatListIconCssMatStyler, ɵngcc6.FileUploadingListComponent, ɵngcc7.FileUploadingListRowComponent, ɵngcc8.CdkTrapFocus], pipes: [ɵngcc9.TranslatePipe], encapsulation: 2 });
FileUploadingDialogComponent.ctorParameters = () => [
    { type: UploadService },
    { type: ChangeDetectorRef },
    { type: UserPreferencesService },
    { type: ElementRef }
];
FileUploadingDialogComponent.propDecorators = {
    uploadList: [{ type: ViewChild, args: ['uploadList',] }],
    position: [{ type: Input }],
    alwaysVisible: [{ type: Input }],
    error: [{ type: Output }],
    isPositionRight: [{ type: HostBinding, args: ['attr.adfUploadDialogRight',] }],
    isPositionLeft: [{ type: HostBinding, args: ['attr.adfUploadDialogLeft',] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(FileUploadingDialogComponent, [{
        type: Component,
        args: [{
                selector: 'adf-file-uploading-dialog',
                template: "<div *ngIf=\"canShowDialog()\"\n     role=\"dialog\"\n     [attr.aria-label]=\"'ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG'| translate\"\n     tabindex=\"0\"\n     class=\"adf-upload-dialog\"\n     id=\"upload-dialog\"\n     [class.adf-upload-dialog--minimized]=\"isDialogMinimized\">\n    <header class=\"adf-upload-dialog__header\">\n        <button\n            mat-button\n            [attr.aria-label]=\"(isDialogMinimized ?\n                'ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG_MAXIMIZE':\n                'ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG_MINIMIZE') | translate\"\n            [disabled]=\"isConfirmation\"\n            [attr.aria-expanded]=\"!isDialogMinimized\"\n            (click)=\"toggleMinimized()\">\n            <mat-icon\n                mat-list-icon\n                title=\"{{ (isDialogMinimized ? 'ADF_FILE_UPLOAD.BUTTON.MAXIMIZE': 'ADF_FILE_UPLOAD.BUTTON.MINIMIZE') | translate }}\">\n                    {{ isDialogMinimized ? 'keyboard_arrow_up' : 'keyboard_arrow_down' }}\n            </mat-icon>\n        </button>\n\n        <span\n            tabindex=\"0\"\n            class=\"adf-upload-dialog__title\"\n            *ngIf=\"!uploadList.isUploadCancelled()\">\n            {{ 'FILE_UPLOAD.MESSAGES.UPLOAD_PROGRESS'\n                | translate: {\n                    completed: totalCompleted,\n                    total: filesUploadingList.length\n                }\n            }}\n        </span>\n\n        <span\n            tabindex=\"0\"\n            class=\"adf-upload-dialog__title\"\n            *ngIf=\"uploadList.isUploadCancelled()\">\n            {{ 'FILE_UPLOAD.MESSAGES.UPLOAD_CANCELED' | translate }}\n        </span>\n    </header>\n\n    <section class=\"adf-upload-dialog__info\"\n        tabindex=\"0\"\n        *ngIf=\"totalErrors\">\n        {{\n            (totalErrors > 1\n                 ? 'FILE_UPLOAD.MESSAGES.UPLOAD_ERRORS'\n                 : 'FILE_UPLOAD.MESSAGES.UPLOAD_ERROR')\n                 | translate: { total: totalErrors }\n        }}\n    </section>\n\n    <section class=\"adf-upload-dialog__content\"\n        [class.adf-upload-dialog--padding]=\"isConfirmation\">\n        <adf-file-uploading-list\n            [class.adf-upload-dialog--hide]=\"isConfirmation\"\n            #uploadList\n            [files]=\"filesUploadingList\">\n                <ng-template let-file=\"$implicit\">\n                     <adf-file-uploading-list-row\n                        [file]=\"file\"\n                        (remove)=\"uploadList.removeFile(file)\"\n                        (cancel)=\"uploadList.cancelFile(file)\">\n                    </adf-file-uploading-list-row>\n                </ng-template>\n        </adf-file-uploading-list>\n\n        <div\n            aria-live=\"polite\"\n            aria-labelledby=\"confirmationTitle\"\n            aria-describedby=\"confirmationDescription\"\n            class=\"adf-upload-dialog__confirmation\"\n            [class.adf-upload-dialog--hide]=\"!isConfirmation\">\n                <p role=\"heading\" id=\"confirmationTitle\" class=\"adf-upload-dialog__confirmation--title\">\n                    {{ 'ADF_FILE_UPLOAD.CONFIRMATION.MESSAGE.TITLE' | translate }}\n                </p>\n                <p id=\"confirmationDescription\" class=\"adf-upload-dialog__confirmation--text\">\n                    {{ 'ADF_FILE_UPLOAD.CONFIRMATION.MESSAGE.TEXT' | translate }}\n                </p>\n        </div>\n    </section>\n\n    <footer class=\"adf-upload-dialog__actions\" *ngIf=\"!isConfirmation\">\n        <button\n            id=\"adf-upload-dialog-cancel-all\"\n            [attr.aria-label]=\"'ADF_FILE_UPLOAD.ARIA-LABEL.CANCEL_ALL' | translate\"\n            color=\"primary\"\n            mat-button\n            *ngIf=\"canShowCancelAll()\"\n            (click)=\"toggleConfirmation()\"\n        >{{ 'ADF_FILE_UPLOAD.BUTTON.CANCEL_ALL' | translate }}</button>\n\n        <button\n            id=\"adf-upload-dialog-close\"\n            [attr.aria-label]=\"'ADF_FILE_UPLOAD.ARIA-LABEL.DIALOG_CLOSE' | translate\"\n            *ngIf=\"canCloseDialog()\"\n            mat-button\n            color=\"primary\"\n            (click)=\"close()\"\n        >{{ 'ADF_FILE_UPLOAD.BUTTON.CLOSE' | translate }}</button>\n    </footer>\n\n    <footer class=\"adf-upload-dialog__actions\"\n            *ngIf=\"isConfirmation\" cdkTrapFocus cdkTrapFocusAutoCapture>\n        <button\n            id=\"adf-upload-dialog-cancel\"\n            [attr.aria-label]=\"'ADF_FILE_UPLOAD.ARIA-LABEL.CONFIRMATION.CANCEL' | translate\"\n            mat-button\n            (click)=\"cancelAllUploads()\"\n        >{{ 'ADF_FILE_UPLOAD.CONFIRMATION.BUTTON.CANCEL' | translate }}</button>\n\n        <button\n            id=\"adf-upload-dialog-confirm\"\n            [attr.aria-label]=\"'ADF_FILE_UPLOAD.ARIA-LABEL.CONFIRMATION.CONTINUE' | translate\"\n            mat-button\n            color=\"primary\"\n            (click)=\"toggleConfirmation()\"\n        >{{ 'ADF_FILE_UPLOAD.CONFIRMATION.BUTTON.CONTINUE' | translate }}</button>\n    </footer>\n</div>\n"
            }]
    }], function () { return [{ type: ɵngcc1.UploadService }, { type: ɵngcc0.ChangeDetectorRef }, { type: ɵngcc1.UserPreferencesService }, { type: ɵngcc0.ElementRef }]; }, { position: [{
            type: Input
        }], alwaysVisible: [{
            type: Input
        }], error: [{
            type: Output
        }], isPositionRight: [{
            type: HostBinding,
            args: ['attr.adfUploadDialogRight']
        }], isPositionLeft: [{
            type: HostBinding,
            args: ['attr.adfUploadDialogLeft']
        }], uploadList: [{
            type: ViewChild,
            args: ['uploadList']
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmlsZS11cGxvYWRpbmctZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vaG9tZS90cmF2aXMvYnVpbGQvQWxmcmVzY28vYWxmcmVzY28tbmcyLWNvbXBvbmVudHMvbGliL2NvbnRlbnQtc2VydmljZXMvc3JjL2xpYi91cGxvYWQvY29tcG9uZW50cy9maWxlLXVwbG9hZGluZy1kaWFsb2cuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFFSCxPQUFPLEVBQWEsZ0JBQWdCLEVBQUUsYUFBYSxFQUFFLHNCQUFzQixFQUFrRCxNQUFNLG9CQUFvQixDQUFDO0FBQ3hKLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxZQUFZLEVBQXFCLFNBQVMsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ2pKLE9BQU8sRUFBZ0IsS0FBSyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUNwRCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUU3RSxPQUFPLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLGdCQUFnQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFNbEQsTUFBTSxPQUFPLDRCQUE0QjtBQUFHLElBOEN4QyxZQUNZ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O0FBQUc7QUFDbEcseUJBY3hCLFNBQVMsU0FBQyxZQUFZO0FBQ3RCLHVCQUdBLEtBQUs7QUFDUiw0QkFHRyxLQUFLO0FBQ1Isb0JBR0csTUFBTTtBQUNULDhCQUVHLFdBQVcsU0FBQywyQkFBMkI7QUFDdkMsNkJBS0EsV0FBVyxTQUFDLDBCQUEwQjtBQUN2Qzs7Ozs7aWtDQTdCcUQsY0FDeEQ7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQTRCSztBQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgQWxmcmVzY28gU29mdHdhcmUsIEx0ZC5cbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cblxuaW1wb3J0IHsgRmlsZU1vZGVsLCBGaWxlVXBsb2FkU3RhdHVzLCBVcGxvYWRTZXJ2aWNlLCBVc2VyUHJlZmVyZW5jZXNTZXJ2aWNlLCBGaWxlVXBsb2FkRGVsZXRlRXZlbnQsIEZpbGVVcGxvYWRDb21wbGV0ZUV2ZW50IH0gZnJvbSAnQGFsZnJlc2NvL2FkZi1jb3JlJztcbmltcG9ydCB7IENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIElucHV0LCBPdXRwdXQsIEV2ZW50RW1pdHRlciwgT25EZXN0cm95LCBPbkluaXQsIFZpZXdDaGlsZCwgSG9zdEJpbmRpbmcsIEVsZW1lbnRSZWYgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFN1YnNjcmlwdGlvbiwgbWVyZ2UsIFN1YmplY3QgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IEZpbGVVcGxvYWRpbmdMaXN0Q29tcG9uZW50IH0gZnJvbSAnLi9maWxlLXVwbG9hZGluZy1saXN0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBEaXJlY3Rpb24gfSBmcm9tICdAYW5ndWxhci9jZGsvYmlkaSc7XG5pbXBvcnQgeyB0YWtlVW50aWwsIGRlbGF5IH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2FkZi1maWxlLXVwbG9hZGluZy1kaWFsb2cnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi9maWxlLXVwbG9hZGluZy1kaWFsb2cuY29tcG9uZW50Lmh0bWwnXG59KVxuZXhwb3J0IGNsYXNzIEZpbGVVcGxvYWRpbmdEaWFsb2dDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uRGVzdHJveSB7XG4gICAgLyoqIERpYWxvZyBkaXJlY3Rpb24uIENhbiBiZSAnbHRyJyBvciAncnRsLiAqL1xuICAgIHByaXZhdGUgZGlyZWN0aW9uOiBEaXJlY3Rpb24gPSAnbHRyJztcbiAgICBwcml2YXRlIG9uRGVzdHJveSQgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuXG4gICAgQFZpZXdDaGlsZCgndXBsb2FkTGlzdCcpXG4gICAgdXBsb2FkTGlzdDogRmlsZVVwbG9hZGluZ0xpc3RDb21wb25lbnQ7XG5cbiAgICAvKiogRGlhbG9nIHBvc2l0aW9uLiBDYW4gYmUgJ2xlZnQnIG9yICdyaWdodCcuICovXG4gICAgQElucHV0KClcbiAgICBwb3NpdGlvbjogc3RyaW5nID0gJ3JpZ2h0JztcblxuICAgIC8qKiBNYWtlcyB0aGUgZGlhbG9nIGFsd2F5cyB2aXNpYmxlIGV2ZW4gd2hlbiB0aGVyZSBhcmUgbm8gdXBsb2Fkcy4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFsd2F5c1Zpc2libGU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gYSBmaWxlIGluIHRoZSBsaXN0IGhhcyBhbiBlcnJvci4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBlcnJvcjogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuYWRmVXBsb2FkRGlhbG9nUmlnaHQnKVxuICAgIHB1YmxpYyBnZXQgaXNQb3NpdGlvblJpZ2h0KCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKHRoaXMuZGlyZWN0aW9uID09PSAnbHRyJyAmJiB0aGlzLnBvc2l0aW9uID09PSAncmlnaHQnKVxuICAgICAgICAgICAgfHwgKHRoaXMuZGlyZWN0aW9uID09PSAncnRsJyAmJiB0aGlzLnBvc2l0aW9uID09PSAnbGVmdCcpXG4gICAgICAgICAgICB8fCBudWxsO1xuICAgIH1cbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuYWRmVXBsb2FkRGlhbG9nTGVmdCcpXG4gICAgcHVibGljIGdldCBpc1Bvc2l0aW9uTGVmdCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLmRpcmVjdGlvbiA9PT0gJ2x0cicgJiYgdGhpcy5wb3NpdGlvbiA9PT0gJ2xlZnQnKVxuICAgICAgICAgICAgfHwgKHRoaXMuZGlyZWN0aW9uID09PSAncnRsJyAmJiB0aGlzLnBvc2l0aW9uID09PSAncmlnaHQnKVxuICAgICAgICAgICAgfHwgbnVsbDtcbiAgICB9XG5cbiAgICBmaWxlc1VwbG9hZGluZ0xpc3Q6IEZpbGVNb2RlbFtdID0gW107XG4gICAgaXNEaWFsb2dBY3RpdmU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICB0b3RhbENvbXBsZXRlZDogbnVtYmVyID0gMDtcbiAgICB0b3RhbEVycm9yczogbnVtYmVyID0gMDtcbiAgICBpc0RpYWxvZ01pbmltaXplZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIGlzQ29uZmlybWF0aW9uOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIGxpc3RTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICBwcml2YXRlIGNvdW50ZXJTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICBwcml2YXRlIGZpbGVVcGxvYWRTdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjtcbiAgICBwcml2YXRlIGVycm9yU3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb247XG4gICAgcHJpdmF0ZSBkaWFsb2dBY3RpdmUgPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgdXBsb2FkU2VydmljZTogVXBsb2FkU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBjaGFuZ2VEZXRlY3RvcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIHByaXZhdGUgdXNlclByZWZlcmVuY2VzU2VydmljZTogVXNlclByZWZlcmVuY2VzU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmKSB7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nQWN0aXZlXG4gICAgICAgICAgICAucGlwZShcbiAgICAgICAgICAgICAgICBkZWxheSgxMDApLFxuICAgICAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50OiBhbnkgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjdXBsb2FkLWRpYWxvZycpO1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmxpc3RTdWJzY3JpcHRpb24gPSB0aGlzLnVwbG9hZFNlcnZpY2UucXVldWVDaGFuZ2VkXG4gICAgICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZmlsZUxpc3QgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZmlsZXNVcGxvYWRpbmdMaXN0ID0gZmlsZUxpc3Q7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWxlc1VwbG9hZGluZ0xpc3QubGVuZ3RoICYmICF0aGlzLmlzRGlhbG9nQWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNEaWFsb2dBY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0FjdGl2ZS5uZXh0KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaWFsb2dBY3RpdmUubmV4dCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY291bnRlclN1YnNjcmlwdGlvbiA9IG1lcmdlKFxuICAgICAgICAgICAgdGhpcy51cGxvYWRTZXJ2aWNlLmZpbGVVcGxvYWRDb21wbGV0ZSxcbiAgICAgICAgICAgIHRoaXMudXBsb2FkU2VydmljZS5maWxlVXBsb2FkRGVsZXRlZFxuICAgICAgICApXG4gICAgICAgICAgICAucGlwZSh0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoKGV2ZW50OiBGaWxlVXBsb2FkQ29tcGxldGVFdmVudCB8IEZpbGVVcGxvYWREZWxldGVFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMudG90YWxDb21wbGV0ZWQgPSBldmVudC50b3RhbENvbXBsZXRlO1xuICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5lcnJvclN1YnNjcmlwdGlvbiA9IHRoaXMudXBsb2FkU2VydmljZS5maWxlVXBsb2FkRXJyb3JcbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZShldmVudCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy50b3RhbEVycm9ycyA9IGV2ZW50LnRvdGFsRXJyb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VEZXRlY3Rvci5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmZpbGVVcGxvYWRTdWJzY3JpcHRpb24gPSB0aGlzLnVwbG9hZFNlcnZpY2UuZmlsZVVwbG9hZFxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMub25EZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMudXBsb2FkU2VydmljZS5maWxlRGVsZXRlZFxuICAgICAgICAgICAgLnBpcGUodGFrZVVudGlsKHRoaXMub25EZXN0cm95JCkpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKG9iaklkID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWxlc1VwbG9hZGluZ0xpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBsb2FkZWRGaWxlID0gdGhpcy5maWxlc1VwbG9hZGluZ0xpc3QuZmluZCgoZmlsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbGUuZGF0YSA/IGZpbGUuZGF0YS5lbnRyeS5pZCA9PT0gb2JqSWQgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cGxvYWRlZEZpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZGVkRmlsZS5zdGF0dXMgPSBGaWxlVXBsb2FkU3RhdHVzLkNhbmNlbGxlZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy51c2VyUHJlZmVyZW5jZXNTZXJ2aWNlLnNlbGVjdCgndGV4dE9yaWVudGF0aW9uJylcbiAgICAgICAgICAgIC5waXBlKHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpKVxuICAgICAgICAgICAgLnN1YnNjcmliZSgodGV4dE9yaWVudGF0aW9uOiBEaXJlY3Rpb24pID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHRleHRPcmllbnRhdGlvbjtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRvZ2dsZSBjb25maXJtYXRpb24gbWVzc2FnZS5cbiAgICAgKi9cbiAgICB0b2dnbGVDb25maXJtYXRpb24oKSB7XG4gICAgICAgIHRoaXMuaXNDb25maXJtYXRpb24gPSAhdGhpcy5pc0NvbmZpcm1hdGlvbjtcblxuICAgICAgICBpZiAoIXRoaXMuaXNDb25maXJtYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuZGlhbG9nQWN0aXZlLm5leHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmlzRGlhbG9nTWluaW1pemVkKSB7XG4gICAgICAgICAgICB0aGlzLmlzRGlhbG9nTWluaW1pemVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDYW5jZWwgdXBsb2FkcyBhbmQgaGlkZSBjb25maXJtYXRpb25cbiAgICAgKi9cbiAgICBjYW5jZWxBbGxVcGxvYWRzKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZUNvbmZpcm1hdGlvbigpO1xuICAgICAgICB0aGlzLmRpYWxvZ0FjdGl2ZS5uZXh0KCk7XG4gICAgICAgIHRoaXMudXBsb2FkTGlzdC5jYW5jZWxBbGxGaWxlcygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRvZ2dsZSBkaWFsb2cgbWluaW1pemVkIHN0YXRlLlxuICAgICAqL1xuICAgIHRvZ2dsZU1pbmltaXplZCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pc0RpYWxvZ01pbmltaXplZCA9ICF0aGlzLmlzRGlhbG9nTWluaW1pemVkO1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEaXNtaXNzIGRpYWxvZ1xuICAgICAqL1xuICAgIGNsb3NlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmlzQ29uZmlybWF0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMudG90YWxDb21wbGV0ZWQgPSAwO1xuICAgICAgICB0aGlzLnRvdGFsRXJyb3JzID0gMDtcbiAgICAgICAgdGhpcy5maWxlc1VwbG9hZGluZ0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5pc0RpYWxvZ0FjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzRGlhbG9nTWluaW1pemVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXBsb2FkU2VydmljZS5jbGVhclF1ZXVlKCk7XG4gICAgICAgIHRoaXMuY2hhbmdlRGV0ZWN0b3IuZGV0ZWN0Q2hhbmdlcygpO1xuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCkge1xuICAgICAgICB0aGlzLnVwbG9hZFNlcnZpY2UuY2xlYXJRdWV1ZSgpO1xuICAgICAgICB0aGlzLmxpc3RTdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgdGhpcy5jb3VudGVyU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMuZmlsZVVwbG9hZFN1YnNjcmlwdGlvbi51bnN1YnNjcmliZSgpO1xuICAgICAgICB0aGlzLmVycm9yU3Vic2NyaXB0aW9uLnVuc3Vic2NyaWJlKCk7XG4gICAgICAgIHRoaXMub25EZXN0cm95JC5uZXh0KHRydWUpO1xuICAgICAgICB0aGlzLm9uRGVzdHJveSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBjYW5TaG93RGlhbG9nKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5pc0RpYWxvZ0FjdGl2ZSB8fCB0aGlzLmFsd2F5c1Zpc2libGU7XG4gICAgfVxuXG4gICAgY2FuU2hvd0NhbmNlbEFsbCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlsZXNVcGxvYWRpbmdMaXN0Py5sZW5ndGggJiYgdGhpcy5oYXNVcGxvYWRJblByb2dyZXNzKCk7XG4gICAgfVxuXG4gICAgY2FuQ2xvc2VEaWFsb2coKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhdGhpcy5oYXNVcGxvYWRJblByb2dyZXNzKCkgJiYgIXRoaXMuYWx3YXlzVmlzaWJsZTtcbiAgICB9XG5cbiAgICBoYXNVcGxvYWRJblByb2dyZXNzKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gKCF0aGlzLnVwbG9hZExpc3Q/LmlzVXBsb2FkQ29tcGxldGVkKCkgJiYgIXRoaXMudXBsb2FkTGlzdD8uaXNVcGxvYWRDYW5jZWxsZWQoKSk7XG4gICAgfVxufVxuIl19
/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { __awaiter } from "tslib";
import { Component, ContentChild, EventEmitter, HostListener, ElementRef, Input, Output, TemplateRef, ViewEncapsulation } from '@angular/core';
import { BaseEvent } from '../../events';
import { AlfrescoApiService } from '../../services/alfresco-api.service';
import { LogService } from '../../services/log.service';
import { ViewerMoreActionsComponent } from './viewer-more-actions.component';
import { ViewerOpenWithComponent } from './viewer-open-with.component';
import { ViewerSidebarComponent } from './viewer-sidebar.component';
import { ViewerToolbarComponent } from './viewer-toolbar.component';
import { fromEvent, Subject } from 'rxjs';
import { ViewUtilService } from '../services/view-util.service';
import { AppExtensionService } from '@alfresco/adf-extensions';
import { filter, skipWhile, takeUntil } from 'rxjs/operators';
import { MatDialog } from '@angular/material/dialog';
import { ContentService } from '../../services/content.service';
import { UploadService } from '../../services/upload.service';
import { FileModel } from '../../models';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '../../services/alfresco-api.service';
import * as ɵngcc2 from '../services/view-util.service';
import * as ɵngcc3 from '../../services/log.service';
import * as ɵngcc4 from '@alfresco/adf-extensions';
import * as ɵngcc5 from '../../services/content.service';
import * as ɵngcc6 from '../../services/upload.service';
import * as ɵngcc7 from '@angular/material/dialog';
import * as ɵngcc8 from '@angular/common';
import * as ɵngcc9 from '@angular/flex-layout/flex';
import * as ɵngcc10 from '@angular/cdk/a11y';
import * as ɵngcc11 from '../../toolbar/toolbar.component';
import * as ɵngcc12 from '../../toolbar/toolbar-title.component';
import * as ɵngcc13 from '../../toolbar/toolbar-divider.component';
import * as ɵngcc14 from '@angular/material/button';
import * as ɵngcc15 from '@angular/material/icon';
import * as ɵngcc16 from '@angular/material/menu';
import * as ɵngcc17 from '../../directives/node-download.directive';
import * as ɵngcc18 from '@angular/flex-layout/extended';
import * as ɵngcc19 from '@angular/material/progress-spinner';
import * as ɵngcc20 from './pdf-viewer.component';
import * as ɵngcc21 from './img-viewer.component';
import * as ɵngcc22 from './media-player.component';
import * as ɵngcc23 from './txt-viewer.component';
import * as ɵngcc24 from './unknown-format/unknown-format.component';
import * as ɵngcc25 from '../../pipes/mime-type-icon.pipe';
import * as ɵngcc26 from '@ngx-translate/core';

function ViewerComponent_div_0_ng_container_3_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    const _r17 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "button", 17);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_ng_container_3_Template_button_click_1_listener() { ɵngcc0.ɵɵrestoreView(_r17); const ctx_r16 = ɵngcc0.ɵɵnextContext(3); return ctx_r16.toggleLeftSidebar(); });
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelementStart(4, "mat-icon");
    ɵngcc0.ɵɵtext(5, "info_outline");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r6 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(3, 6, "ADF_VIEWER.ACTIONS.INFO"));
    ɵngcc0.ɵɵproperty("color", ctx_r6.showLeftSidebar ? "accent" : null);
    ɵngcc0.ɵɵattribute("aria-expanded", ctx_r6.showLeftSidebar)("aria-label", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.INFO"));
} }
function ViewerComponent_div_0_ng_container_3_button_4_Template(rf, ctx) { if (rf & 1) {
    const _r19 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 18);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_button_4_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r19); const ctx_r18 = ɵngcc0.ɵɵnextContext(3); return ctx_r18.onBackButtonClick(); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "mat-icon");
    ɵngcc0.ɵɵtext(4, "close");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.CLOSE"));
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_VIEWER.ACTIONS.CLOSE"));
} }
function ViewerComponent_div_0_ng_container_3_button_6_Template(rf, ctx) { if (rf & 1) {
    const _r21 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 19);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_button_6_Template_button_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r21); const ctx_r20 = ɵngcc0.ɵɵnextContext(3); return ctx_r20.onNavigateBeforeClick($event); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "mat-icon");
    ɵngcc0.ɵɵtext(4, "navigate_before");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.PREV_FILE"));
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_VIEWER.ACTIONS.PREV_FILE"));
} }
function ViewerComponent_div_0_ng_container_3_button_11_Template(rf, ctx) { if (rf & 1) {
    const _r23 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 20);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_button_11_Template_button_click_0_listener($event) { ɵngcc0.ɵɵrestoreView(_r23); const ctx_r22 = ɵngcc0.ɵɵnextContext(3); return ctx_r22.onNavigateNextClick($event); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "mat-icon");
    ɵngcc0.ɵɵtext(4, "navigate_next");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.NEXT_FILE"));
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_VIEWER.ACTIONS.NEXT_FILE"));
} }
function ViewerComponent_div_0_ng_container_3_ng_container_13_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0, 21);
    ɵngcc0.ɵɵelementStart(1, "button", 22);
    ɵngcc0.ɵɵelementStart(2, "span");
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "mat-icon");
    ɵngcc0.ɵɵtext(6, "arrow_drop_down");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(7, "mat-menu", 23, 24);
    ɵngcc0.ɵɵprojection(9, 2);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const _r24 = ɵngcc0.ɵɵreference(8);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("matMenuTriggerFor", _r24);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(4, 3, "ADF_VIEWER.ACTIONS.OPEN_WITH"));
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵproperty("overlapTrigger", false);
} }
function ViewerComponent_div_0_ng_container_3_button_15_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "button", 25);
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "mat-icon");
    ɵngcc0.ɵɵtext(4, "file_download");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r11 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 6, "ADF_VIEWER.ACTIONS.DOWNLOAD"));
    ɵngcc0.ɵɵproperty("adfNodeDownload", ctx_r11.nodeEntry)("version", ctx_r11.versionEntry);
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 4, "ADF_VIEWER.ACTIONS.DOWNLOAD"));
} }
function ViewerComponent_div_0_ng_container_3_button_16_Template(rf, ctx) { if (rf & 1) {
    const _r26 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 26);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_button_16_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r26); const ctx_r25 = ɵngcc0.ɵɵnextContext(3); return ctx_r25.printContent(); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "mat-icon");
    ɵngcc0.ɵɵtext(4, "print");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.PRINT"));
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_VIEWER.ACTIONS.PRINT"));
} }
function ViewerComponent_div_0_ng_container_3_button_17_Template(rf, ctx) { if (rf & 1) {
    const _r28 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "button", 27);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_button_17_Template_button_click_0_listener() { ɵngcc0.ɵɵrestoreView(_r28); const ctx_r27 = ɵngcc0.ɵɵnextContext(3); return ctx_r27.enterFullScreen(); });
    ɵngcc0.ɵɵpipe(1, "translate");
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵelementStart(3, "mat-icon");
    ɵngcc0.ɵɵtext(4, "fullscreen");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.FULLSCREEN"));
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(1, 2, "ADF_VIEWER.ACTIONS.FULLSCREEN"));
} }
function ViewerComponent_div_0_ng_container_3_ng_container_18_Template(rf, ctx) { if (rf & 1) {
    const _r30 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "adf-toolbar-divider");
    ɵngcc0.ɵɵelementStart(2, "button", 28);
    ɵngcc0.ɵɵlistener("click", function ViewerComponent_div_0_ng_container_3_ng_container_18_Template_button_click_2_listener() { ɵngcc0.ɵɵrestoreView(_r30); const ctx_r29 = ɵngcc0.ɵɵnextContext(3); return ctx_r29.toggleSidebar(); });
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementStart(5, "mat-icon");
    ɵngcc0.ɵɵtext(6, "info_outline");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r14 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(4, 6, "ADF_VIEWER.ACTIONS.INFO"));
    ɵngcc0.ɵɵproperty("color", ctx_r14.showRightSidebar ? "accent" : null);
    ɵngcc0.ɵɵattribute("aria-expanded", ctx_r14.showRightSidebar)("aria-label", ɵngcc0.ɵɵpipeBind1(3, 4, "ADF_VIEWER.ACTIONS.INFO"));
} }
function ViewerComponent_div_0_ng_container_3_ng_container_19_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "button", 29);
    ɵngcc0.ɵɵpipe(2, "translate");
    ɵngcc0.ɵɵpipe(3, "translate");
    ɵngcc0.ɵɵelementStart(4, "mat-icon");
    ɵngcc0.ɵɵtext(5, "more_vert");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(6, "mat-menu", 23, 30);
    ɵngcc0.ɵɵprojection(8, 3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const _r31 = ɵngcc0.ɵɵreference(7);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵpropertyInterpolate("title", ɵngcc0.ɵɵpipeBind1(3, 6, "ADF_VIEWER.ACTIONS.MORE_ACTIONS"));
    ɵngcc0.ɵɵproperty("matMenuTriggerFor", _r31);
    ɵngcc0.ɵɵattribute("aria-label", ɵngcc0.ɵɵpipeBind1(2, 4, "ADF_VIEWER.ACTIONS.MORE_ACTIONS"));
    ɵngcc0.ɵɵadvance(5);
    ɵngcc0.ɵɵproperty("overlapTrigger", false);
} }
function ViewerComponent_div_0_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "adf-toolbar", 6);
    ɵngcc0.ɵɵelementStart(2, "adf-toolbar-title");
    ɵngcc0.ɵɵtemplate(3, ViewerComponent_div_0_ng_container_3_ng_container_3_Template, 6, 8, "ng-container", 3);
    ɵngcc0.ɵɵtemplate(4, ViewerComponent_div_0_ng_container_3_button_4_Template, 5, 6, "button", 7);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "div", 8);
    ɵngcc0.ɵɵtemplate(6, ViewerComponent_div_0_ng_container_3_button_6_Template, 5, 6, "button", 9);
    ɵngcc0.ɵɵelement(7, "img", 10);
    ɵngcc0.ɵɵpipe(8, "adfMimeTypeIcon");
    ɵngcc0.ɵɵelementStart(9, "span", 11);
    ɵngcc0.ɵɵtext(10);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(11, ViewerComponent_div_0_ng_container_3_button_11_Template, 5, 6, "button", 12);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵprojection(12, 1);
    ɵngcc0.ɵɵtemplate(13, ViewerComponent_div_0_ng_container_3_ng_container_13_Template, 10, 5, "ng-container", 13);
    ɵngcc0.ɵɵelement(14, "adf-toolbar-divider");
    ɵngcc0.ɵɵtemplate(15, ViewerComponent_div_0_ng_container_3_button_15_Template, 5, 8, "button", 14);
    ɵngcc0.ɵɵtemplate(16, ViewerComponent_div_0_ng_container_3_button_16_Template, 5, 6, "button", 15);
    ɵngcc0.ɵɵtemplate(17, ViewerComponent_div_0_ng_container_3_button_17_Template, 5, 6, "button", 16);
    ɵngcc0.ɵɵtemplate(18, ViewerComponent_div_0_ng_container_3_ng_container_18_Template, 7, 8, "ng-container", 3);
    ɵngcc0.ɵɵtemplate(19, ViewerComponent_div_0_ng_container_3_ng_container_19_Template, 9, 8, "ng-container", 3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowLeftSidebar);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowGoBack);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowNavigate && ctx_r1.canNavigateBefore);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("alt", ctx_r1.mimeType)("src", ɵngcc0.ɵɵpipeBind1(8, 13, ctx_r1.mimeType), ɵngcc0.ɵɵsanitizeUrl);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ctx_r1.fileTitle);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowNavigate && ctx_r1.canNavigateNext);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.mnuOpenWith);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowDownload);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowPrint);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.viewerType !== "media" && ctx_r1.allowFullScreen);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.allowRightSidebar);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.mnuMoreActions);
} }
function ViewerComponent_div_0_ng_container_5_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function ViewerComponent_div_0_ng_container_5_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, ViewerComponent_div_0_ng_container_5_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 32);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r32 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r32.sidebarRightTemplate)("ngTemplateOutletContext", ctx_r32.sidebarRightTemplateContext);
} }
function ViewerComponent_div_0_ng_container_5_ng_content_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵprojection(0, 4, ["*ngIf", "!sidebarRightTemplate"]);
} }
function ViewerComponent_div_0_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 31);
    ɵngcc0.ɵɵtemplate(2, ViewerComponent_div_0_ng_container_5_ng_container_2_Template, 2, 2, "ng-container", 3);
    ɵngcc0.ɵɵtemplate(3, ViewerComponent_div_0_ng_container_5_ng_content_3_Template, 1, 0, "ng-content", 3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r2 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", "adf-viewer__sidebar__right");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r2.sidebarRightTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r2.sidebarRightTemplate);
} }
function ViewerComponent_div_0_ng_container_6_ng_container_2_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function ViewerComponent_div_0_ng_container_6_ng_container_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, ViewerComponent_div_0_ng_container_6_ng_container_2_ng_container_1_Template, 1, 0, "ng-container", 32);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r35 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r35.sidebarLeftTemplate)("ngTemplateOutletContext", ctx_r35.sidebarLeftTemplateContext);
} }
function ViewerComponent_div_0_ng_container_6_ng_content_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵprojection(0, 5, ["*ngIf", "!sidebarLeftTemplate"]);
} }
function ViewerComponent_div_0_ng_container_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 33);
    ɵngcc0.ɵɵtemplate(2, ViewerComponent_div_0_ng_container_6_ng_container_2_Template, 2, 2, "ng-container", 3);
    ɵngcc0.ɵɵtemplate(3, ViewerComponent_div_0_ng_container_6_ng_content_3_Template, 1, 0, "ng-content", 3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r3 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", "adf-viewer__sidebar__left");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r3.sidebarLeftTemplate);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r3.sidebarLeftTemplate);
} }
function ViewerComponent_div_0_div_7_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 37);
    ɵngcc0.ɵɵelementStart(2, "h2");
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "div");
    ɵngcc0.ɵɵelement(6, "mat-spinner");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(4, 1, "ADF_VIEWER.LOADING"));
} }
function ViewerComponent_div_0_div_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 34);
    ɵngcc0.ɵɵelementStart(1, "div", 35);
    ɵngcc0.ɵɵelementStart(2, "div", 36);
    ɵngcc0.ɵɵtemplate(3, ViewerComponent_div_0_div_7_ng_container_3_Template, 7, 3, "ng-container", 3);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r4 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r4.isLoading);
} }
function ViewerComponent_div_0_div_8_ng_container_3_Template(rf, ctx) { if (rf & 1) {
    const _r47 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "adf-pdf-viewer", 41);
    ɵngcc0.ɵɵlistener("close", function ViewerComponent_div_0_div_8_ng_container_3_Template_adf_pdf_viewer_close_1_listener() { ɵngcc0.ɵɵrestoreView(_r47); const ctx_r46 = ɵngcc0.ɵɵnextContext(3); return ctx_r46.onBackButtonClick(); })("error", function ViewerComponent_div_0_div_8_ng_container_3_Template_adf_pdf_viewer_error_1_listener() { ɵngcc0.ɵɵrestoreView(_r47); const ctx_r48 = ɵngcc0.ɵɵnextContext(3); return ctx_r48.onUnsupportedFile(); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r39 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("thumbnailsTemplate", ctx_r39.thumbnailsTemplate)("allowThumbnails", ctx_r39.allowThumbnails)("blobFile", ctx_r39.blobFile)("urlFile", ctx_r39.urlFileContent)("nameFile", ctx_r39.displayName)("cacheType", ctx_r39.cacheTypeForContent);
} }
function ViewerComponent_div_0_div_8_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    const _r50 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "adf-img-viewer", 42);
    ɵngcc0.ɵɵlistener("error", function ViewerComponent_div_0_div_8_ng_container_4_Template_adf_img_viewer_error_1_listener() { ɵngcc0.ɵɵrestoreView(_r50); const ctx_r49 = ɵngcc0.ɵɵnextContext(3); return ctx_r49.onUnsupportedFile(); })("submit", function ViewerComponent_div_0_div_8_ng_container_4_Template_adf_img_viewer_submit_1_listener($event) { ɵngcc0.ɵɵrestoreView(_r50); const ctx_r51 = ɵngcc0.ɵɵnextContext(3); return ctx_r51.onSubmitFile($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r40 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("urlFile", ctx_r40.urlFileContent)("nameFile", ctx_r40.displayName)("blobFile", ctx_r40.blobFile)("readOnly", ctx_r40.readOnly);
} }
function ViewerComponent_div_0_div_8_ng_container_5_Template(rf, ctx) { if (rf & 1) {
    const _r53 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "adf-media-player", 43);
    ɵngcc0.ɵɵlistener("error", function ViewerComponent_div_0_div_8_ng_container_5_Template_adf_media_player_error_1_listener() { ɵngcc0.ɵɵrestoreView(_r53); const ctx_r52 = ɵngcc0.ɵɵnextContext(3); return ctx_r52.onUnsupportedFile(); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r41 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("urlFile", ctx_r41.urlFileContent)("nodeId", ctx_r41.nodeEntry == null ? null : ctx_r41.nodeEntry.entry == null ? null : ctx_r41.nodeEntry.entry.id)("mimeType", ctx_r41.mimeType)("blobFile", ctx_r41.blobFile)("nameFile", ctx_r41.displayName);
} }
function ViewerComponent_div_0_div_8_ng_container_6_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "adf-txt-viewer", 44);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r42 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("urlFile", ctx_r42.urlFileContent)("blobFile", ctx_r42.blobFile);
} }
function ViewerComponent_div_0_div_8_ng_container_7_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelementStart(1, "div", 37);
    ɵngcc0.ɵɵelementStart(2, "h2");
    ɵngcc0.ɵɵtext(3);
    ɵngcc0.ɵɵpipe(4, "translate");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(5, "div");
    ɵngcc0.ɵɵelement(6, "mat-spinner");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵtextInterpolate(ɵngcc0.ɵɵpipeBind1(4, 1, "ADF_VIEWER.LOADING"));
} }
function ViewerComponent_div_0_div_8_ng_container_8_ng_container_1_adf_preview_extension_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "adf-preview-extension", 48);
} if (rf & 2) {
    const ext_r56 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r57 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵproperty("id", ext_r56.component)("node", ctx_r57.nodeEntry.entry)("url", ctx_r57.urlFileContent)("extension", ctx_r57.extension);
    ɵngcc0.ɵɵattribute("data-automation-id", ext_r56.component);
} }
function ViewerComponent_div_0_div_8_ng_container_8_ng_container_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, ViewerComponent_div_0_div_8_ng_container_8_ng_container_1_adf_preview_extension_1_Template, 1, 5, "adf-preview-extension", 47);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ext_r56 = ctx.$implicit;
    const ctx_r54 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r54.checkExtensions(ext_r56.fileExtension));
} }
function ViewerComponent_div_0_div_8_ng_container_8_span_2_1_ng_template_0_Template(rf, ctx) { }
const _c0 = function (a0, a1) { return { urlFileContent: a0, extension: a1 }; };
function ViewerComponent_div_0_div_8_ng_container_8_span_2_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵtemplate(0, ViewerComponent_div_0_div_8_ng_container_8_span_2_1_ng_template_0_Template, 0, 0, "ng-template", 50);
} if (rf & 2) {
    const extensionTemplate_r59 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r60 = ɵngcc0.ɵɵnextContext(4);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", extensionTemplate_r59.template)("ngTemplateOutletContext", ɵngcc0.ɵɵpureFunction2(2, _c0, ctx_r60.urlFileContent, ctx_r60.extension));
} }
function ViewerComponent_div_0_div_8_ng_container_8_span_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 49);
    ɵngcc0.ɵɵtemplate(1, ViewerComponent_div_0_div_8_ng_container_8_span_2_1_Template, 1, 5, undefined, 3);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const extensionTemplate_r59 = ctx.$implicit;
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", extensionTemplate_r59.isVisible);
} }
function ViewerComponent_div_0_div_8_ng_container_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵtemplate(1, ViewerComponent_div_0_div_8_ng_container_8_ng_container_1_Template, 2, 1, "ng-container", 45);
    ɵngcc0.ɵɵtemplate(2, ViewerComponent_div_0_div_8_ng_container_8_span_2_Template, 2, 1, "span", 46);
    ɵngcc0.ɵɵelementContainerEnd();
} if (rf & 2) {
    const ctx_r44 = ɵngcc0.ɵɵnextContext(3);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r44.viewerExtensions);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r44.extensionTemplates);
} }
function ViewerComponent_div_0_div_8_ng_container_9_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainerStart(0);
    ɵngcc0.ɵɵelement(1, "adf-viewer-unknown-format");
    ɵngcc0.ɵɵelementContainerEnd();
} }
function ViewerComponent_div_0_div_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 34);
    ɵngcc0.ɵɵelementStart(1, "div", 35);
    ɵngcc0.ɵɵelementStart(2, "div", 38);
    ɵngcc0.ɵɵtemplate(3, ViewerComponent_div_0_div_8_ng_container_3_Template, 2, 6, "ng-container", 39);
    ɵngcc0.ɵɵtemplate(4, ViewerComponent_div_0_div_8_ng_container_4_Template, 2, 4, "ng-container", 39);
    ɵngcc0.ɵɵtemplate(5, ViewerComponent_div_0_div_8_ng_container_5_Template, 2, 5, "ng-container", 39);
    ɵngcc0.ɵɵtemplate(6, ViewerComponent_div_0_div_8_ng_container_6_Template, 2, 2, "ng-container", 39);
    ɵngcc0.ɵɵtemplate(7, ViewerComponent_div_0_div_8_ng_container_7_Template, 7, 3, "ng-container", 39);
    ɵngcc0.ɵɵtemplate(8, ViewerComponent_div_0_div_8_ng_container_8_Template, 3, 2, "ng-container", 39);
    ɵngcc0.ɵɵtemplate(9, ViewerComponent_div_0_div_8_ng_container_9_Template, 2, 0, "ng-container", 40);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r5 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngSwitch", ctx_r5.viewerType);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngSwitchCase", "pdf");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngSwitchCase", "image");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngSwitchCase", "media");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngSwitchCase", "text");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngSwitchCase", "in_creation");
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngSwitchCase", "custom");
} }
function ViewerComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 1);
    ɵngcc0.ɵɵelementStart(1, "div", 2);
    ɵngcc0.ɵɵprojection(2);
    ɵngcc0.ɵɵtemplate(3, ViewerComponent_div_0_ng_container_3_Template, 20, 15, "ng-container", 3);
    ɵngcc0.ɵɵelementStart(4, "div", 4);
    ɵngcc0.ɵɵtemplate(5, ViewerComponent_div_0_ng_container_5_Template, 4, 3, "ng-container", 3);
    ɵngcc0.ɵɵtemplate(6, ViewerComponent_div_0_ng_container_6_Template, 4, 3, "ng-container", 3);
    ɵngcc0.ɵɵtemplate(7, ViewerComponent_div_0_div_7_Template, 4, 1, "div", 5);
    ɵngcc0.ɵɵtemplate(8, ViewerComponent_div_0_div_8_Template, 10, 7, "div", 5);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassProp("adf-viewer-overlay-container", ctx_r0.overlayMode)("adf-viewer-inline-container", !ctx_r0.overlayMode);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("cdkTrapFocus", ctx_r0.overlayMode);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.showToolbar && !ctx_r0.toolbar);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.allowRightSidebar && ctx_r0.showRightSidebar);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.allowLeftSidebar && ctx_r0.showLeftSidebar);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r0.isLoading);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", !ctx_r0.isLoading);
} }
const _c1 = [[["adf-viewer-toolbar"]], [["adf-viewer-toolbar-actions"]], [["adf-viewer-open-with"]], [["adf-viewer-more-actions"]], [["adf-viewer-sidebar"]], [["adf-viewer-sidebar"]]];
const _c2 = ["adf-viewer-toolbar", "adf-viewer-toolbar-actions", "adf-viewer-open-with", "adf-viewer-more-actions", "adf-viewer-sidebar", "adf-viewer-sidebar"];
export class ViewerComponent {
    constructor(apiService, viewUtilService, logService, extensionService, contentService, uploadService, el, dialog) {
        this.apiService = apiService;
        this.viewUtilService = viewUtilService;
        this.logService = logService;
        this.extensionService = extensionService;
        this.contentService = contentService;
        this.uploadService = uploadService;
        this.el = el;
        this.dialog = dialog;
        this.urlFile = '';
        this.urlFileViewer = null;
        this.nodeId = null;
        this.versionId = null;
        this.sharedLinkId = null;
        this.overlayMode = false;
        this.showViewer = true;
        this.showToolbar = true;
        this.allowGoBack = true;
        this.allowDownload = true;
        this.allowPrint = false;
        this.allowFullScreen = true;
        this.allowNavigate = false;
        this.canNavigateBefore = true;
        this.canNavigateNext = true;
        this.allowLeftSidebar = false;
        this.allowRightSidebar = false;
        this.allowThumbnails = true;
        this.showRightSidebar = false;
        this.showLeftSidebar = false;
        this.sidebarRightTemplate = null;
        this.sidebarLeftTemplate = null;
        this.thumbnailsTemplate = null;
        this.maxRetries = 30;
        this.goBack = new EventEmitter();
        this.print = new EventEmitter();
        this.showViewerChange = new EventEmitter();
        this.extensionChange = new EventEmitter();
        this.navigateBefore = new EventEmitter();
        this.navigateNext = new EventEmitter();
        this.invalidSharedLink = new EventEmitter();
        this.TRY_TIMEOUT = 10000;
        this.viewerType = 'unknown';
        this.isLoading = false;
        this.extensionTemplates = [];
        this.externalExtensions = [];
        this.sidebarRightTemplateContext = { node: null };
        this.sidebarLeftTemplateContext = { node: null };
        this.viewerExtensions = [];
        this.readOnly = true;
        this.cacheTypeForContent = '';
        this.extensions = {
            image: ['png', 'jpg', 'jpeg', 'gif', 'bpm', 'svg'],
            media: ['wav', 'mp4', 'mp3', 'webm', 'ogg'],
            text: ['txt', 'xml', 'html', 'json', 'ts', 'css', 'md'],
            pdf: ['pdf']
        };
        this.mimeTypes = {
            text: ['text/plain', 'text/csv', 'text/xml', 'text/html', 'application/x-javascript'],
            pdf: ['application/pdf'],
            image: ['image/png', 'image/jpeg', 'image/gif', 'image/bmp', 'image/svg+xml'],
            media: ['video/mp4', 'video/webm', 'video/ogg', 'audio/mpeg', 'audio/mp3', 'audio/ogg', 'audio/wav']
        };
        this.onDestroy$ = new Subject();
        this.shouldCloseViewer = true;
        this.keyDown$ = fromEvent(document, 'keydown');
        viewUtilService.maxRetries = this.maxRetries;
    }
    isSourceDefined() {
        return !!(this.urlFile || this.blobFile || this.nodeId || this.sharedLinkId);
    }
    ngOnInit() {
        this.apiService.nodeUpdated.pipe(filter((node) => {
            return node && node.id === this.nodeId &&
                (node.name !== this.fileName ||
                    this.getNodeVersionProperty(this.nodeEntry.entry) !== this.getNodeVersionProperty(node));
        }), takeUntil(this.onDestroy$)).subscribe((node) => this.onNodeUpdated(node));
        this.viewUtilService.viewerTypeChange.pipe(takeUntil(this.onDestroy$)).subscribe((type) => {
            this.viewerType = type;
        });
        this.viewUtilService.urlFileContentChange.pipe(takeUntil(this.onDestroy$)).subscribe((content) => {
            this.urlFileContent = content;
        });
        this.closeOverlayManager();
        this.loadExtensions();
        this.cacheTypeForContent = '';
    }
    loadExtensions() {
        this.viewerExtensions = this.extensionService.getViewerExtensions();
        this.viewerExtensions
            .forEach((extension) => {
            this.externalExtensions.push(extension.fileExtension);
        });
    }
    getNodeVersionProperty(node) {
        var _a;
        return (_a = node === null || node === void 0 ? void 0 : node.properties['cm:versionLabel']) !== null && _a !== void 0 ? _a : '';
    }
    ngOnDestroy() {
        this.onDestroy$.next(true);
        this.onDestroy$.complete();
    }
    onNodeUpdated(node) {
        if (node && node.id === this.nodeId) {
            this.cacheTypeForContent = 'no-cache';
            this.generateCacheBusterNumber();
            this.isLoading = true;
            this.setUpNodeFile(node).then(() => {
                this.isLoading = false;
            });
        }
    }
    ngOnChanges() {
        if (this.showViewer) {
            if (!this.isSourceDefined()) {
                throw new Error('A content source attribute value is missing.');
            }
            this.isLoading = true;
            if (this.blobFile) {
                this.setUpBlobData();
                this.isLoading = false;
            }
            else if (this.urlFile) {
                this.setUpUrlFile();
                this.isLoading = false;
            }
            else if (this.nodeId) {
                this.apiService.nodesApi.getNode(this.nodeId, { include: ['allowableOperations'] }).then((node) => {
                    this.nodeEntry = node;
                    if (this.versionId) {
                        this.apiService.versionsApi.getVersion(this.nodeId, this.versionId).then((version) => {
                            this.versionEntry = version;
                            this.setUpNodeFile(node.entry, version.entry).then(() => {
                                this.isLoading = false;
                            });
                        });
                    }
                    else {
                        this.setUpNodeFile(node.entry).then(() => {
                            this.isLoading = false;
                        });
                    }
                }, () => {
                    this.isLoading = false;
                    this.logService.error('This node does not exist');
                });
            }
            else if (this.sharedLinkId) {
                this.allowGoBack = false;
                this.apiService.sharedLinksApi.getSharedLink(this.sharedLinkId).then((sharedLinkEntry) => {
                    this.setUpSharedLinkFile(sharedLinkEntry);
                    this.isLoading = false;
                }, () => {
                    this.isLoading = false;
                    this.logService.error('This sharedLink does not exist');
                    this.invalidSharedLink.next();
                });
            }
        }
    }
    setUpBlobData() {
        this.fileTitle = this.getDisplayName('Unknown');
        this.mimeType = this.blobFile.type;
        this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        this.allowDownload = false;
        this.extensionChange.emit(this.mimeType);
        this.scrollTop();
    }
    setUpUrlFile() {
        const filenameFromUrl = this.getFilenameFromUrl(this.urlFile);
        this.fileTitle = this.getDisplayName(filenameFromUrl);
        this.extension = this.getFileExtension(filenameFromUrl);
        this.urlFileContent = this.urlFile;
        this.fileName = this.displayName;
        this.viewerType = this.urlFileViewer || this.getViewerTypeByExtension(this.extension);
        if (this.viewerType === 'unknown') {
            this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        }
        this.extensionChange.emit(this.extension);
        this.scrollTop();
    }
    setUpNodeFile(nodeData, versionData) {
        var _a, _b, _c, _d;
        return __awaiter(this, void 0, void 0, function* () {
            this.readOnly = !this.contentService.hasAllowableOperations(nodeData, 'update');
            let setupNode;
            if (versionData && versionData.content) {
                this.mimeType = versionData.content.mimeType;
            }
            else if (nodeData.content) {
                this.mimeType = nodeData.content.mimeType;
            }
            this.fileTitle = this.getDisplayName(versionData ? versionData.name : nodeData.name);
            const currentFileVersion = ((_b = (_a = this.nodeEntry) === null || _a === void 0 ? void 0 : _a.entry) === null || _b === void 0 ? void 0 : _b.properties) && this.nodeEntry.entry.properties['cm:versionLabel'] ?
                encodeURI((_d = (_c = this.nodeEntry) === null || _c === void 0 ? void 0 : _c.entry) === null || _d === void 0 ? void 0 : _d.properties['cm:versionLabel']) : encodeURI('1.0');
            this.urlFileContent = versionData ? this.apiService.contentApi.getVersionContentUrl(this.nodeId, versionData.id) :
                this.apiService.contentApi.getContentUrl(this.nodeId);
            this.urlFileContent = this.cacheBusterNumber ? this.urlFileContent + '&' + currentFileVersion + '&' + this.cacheBusterNumber :
                this.urlFileContent + '&' + currentFileVersion;
            this.extension = this.getFileExtension(versionData ? versionData.name : nodeData.name);
            this.fileName = versionData ? versionData.name : nodeData.name;
            this.viewerType = this.getViewerTypeByExtension(this.extension);
            if (this.viewerType === 'unknown') {
                this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
            }
            if (this.viewerType === 'unknown') {
                if (versionData) {
                    setupNode = this.viewUtilService.displayNodeRendition(nodeData.id, versionData.id);
                }
                else {
                    setupNode = this.viewUtilService.displayNodeRendition(nodeData.id);
                }
            }
            this.extensionChange.emit(this.extension);
            this.sidebarRightTemplateContext.node = nodeData;
            this.sidebarLeftTemplateContext.node = nodeData;
            this.scrollTop();
            return setupNode;
        });
    }
    setUpSharedLinkFile(details) {
        this.mimeType = details.entry.content.mimeType;
        this.fileTitle = this.getDisplayName(details.entry.name);
        this.extension = this.getFileExtension(details.entry.name);
        this.fileName = details.entry.name;
        this.urlFileContent = this.apiService.contentApi.getSharedLinkContentUrl(this.sharedLinkId, false);
        this.viewerType = this.getViewerTypeByMimeType(this.mimeType);
        if (this.viewerType === 'unknown') {
            this.viewerType = this.getViewerTypeByExtension(this.extension);
        }
        if (this.viewerType === 'unknown') {
            this.displaySharedLinkRendition(this.sharedLinkId);
        }
        this.extensionChange.emit(this.extension);
    }
    toggleSidebar() {
        this.showRightSidebar = !this.showRightSidebar;
        if (this.showRightSidebar && this.nodeId) {
            this.apiService.getInstance().nodes.getNode(this.nodeId, { include: ['allowableOperations'] })
                .then((nodeEntry) => {
                this.sidebarRightTemplateContext.node = nodeEntry.entry;
            });
        }
    }
    toggleLeftSidebar() {
        this.showLeftSidebar = !this.showLeftSidebar;
        if (this.showRightSidebar && this.nodeId) {
            this.apiService.getInstance().nodes.getNode(this.nodeId, { include: ['allowableOperations'] })
                .then((nodeEntry) => {
                this.sidebarLeftTemplateContext.node = nodeEntry.entry;
            });
        }
    }
    getDisplayName(name) {
        return this.displayName || name;
    }
    scrollTop() {
        window.scrollTo(0, 1);
    }
    getViewerTypeByMimeType(mimeType) {
        if (mimeType) {
            mimeType = mimeType.toLowerCase();
            const editorTypes = Object.keys(this.mimeTypes);
            for (const type of editorTypes) {
                if (this.mimeTypes[type].indexOf(mimeType) >= 0) {
                    return type;
                }
            }
        }
        return 'unknown';
    }
    getViewerTypeByExtension(extension) {
        if (extension) {
            extension = extension.toLowerCase();
        }
        if (this.isCustomViewerExtension(extension)) {
            return 'custom';
        }
        if (this.extensions.image.indexOf(extension) >= 0) {
            return 'image';
        }
        if (this.extensions.media.indexOf(extension) >= 0) {
            return 'media';
        }
        if (this.extensions.text.indexOf(extension) >= 0) {
            return 'text';
        }
        if (this.extensions.pdf.indexOf(extension) >= 0) {
            return 'pdf';
        }
        return 'unknown';
    }
    onBackButtonClick() {
        this.close();
    }
    onNavigateBeforeClick(event) {
        this.navigateBefore.next(event);
    }
    onNavigateNextClick(event) {
        this.navigateNext.next(event);
    }
    close() {
        if (this.otherMenu) {
            this.otherMenu.hidden = false;
        }
        this.showViewer = false;
        this.showViewerChange.emit(this.showViewer);
    }
    getFilenameFromUrl(url) {
        const anchor = url.indexOf('#');
        const query = url.indexOf('?');
        const end = Math.min(anchor > 0 ? anchor : url.length, query > 0 ? query : url.length);
        return url.substring(url.lastIndexOf('/', end) + 1, end);
    }
    getFileExtension(fileName) {
        if (fileName) {
            const match = fileName.match(/\.([^\./\?\#]+)($|\?|\#)/);
            return match ? match[1] : null;
        }
        return null;
    }
    isCustomViewerExtension(extension) {
        const extensions = this.externalExtensions || [];
        if (extension && extensions.length > 0) {
            extension = extension.toLowerCase();
            return extensions.flat().indexOf(extension) >= 0;
        }
        return false;
    }
    handleKeyboardEvent(event) {
        if (event && event.defaultPrevented) {
            return;
        }
        const key = event.keyCode;
        if (key === 37 && this.canNavigateBefore) {
            event.preventDefault();
            this.onNavigateBeforeClick(event);
        }
        if (key === 39 && this.canNavigateNext) {
            event.preventDefault();
            this.onNavigateNextClick(event);
        }
        if (key === 70 && event.ctrlKey) {
            event.preventDefault();
            this.enterFullScreen();
        }
    }
    printContent() {
        if (this.allowPrint) {
            const args = new BaseEvent();
            this.print.next(args);
            if (!args.defaultPrevented) {
                this.viewUtilService.printFileGeneric(this.nodeId, this.mimeType);
            }
        }
    }
    enterFullScreen() {
        if (this.allowFullScreen) {
            const container = this.el.nativeElement.querySelector('.adf-viewer__fullscreen-container');
            if (container) {
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                }
                else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                }
                else if (container.mozRequestFullScreen) {
                    container.mozRequestFullScreen();
                }
                else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
            }
        }
    }
    displaySharedLinkRendition(sharedId) {
        return __awaiter(this, void 0, void 0, function* () {
            try {
                const rendition = yield this.apiService.renditionsApi.getSharedLinkRendition(sharedId, 'pdf');
                if (rendition.entry.status.toString() === 'CREATED') {
                    this.viewerType = 'pdf';
                    this.urlFileContent = this.apiService.contentApi.getSharedLinkRenditionUrl(sharedId, 'pdf');
                }
            }
            catch (error) {
                this.logService.error(error);
                try {
                    const rendition = yield this.apiService.renditionsApi.getSharedLinkRendition(sharedId, 'imgpreview');
                    if (rendition.entry.status.toString() === 'CREATED') {
                        this.viewerType = 'image';
                        this.urlFileContent = this.apiService.contentApi.getSharedLinkRenditionUrl(sharedId, 'imgpreview');
                    }
                }
                catch (error) {
                    this.logService.error(error);
                }
            }
        });
    }
    checkExtensions(extensionAllowed) {
        if (typeof extensionAllowed === 'string') {
            return this.extension.toLowerCase() === extensionAllowed.toLowerCase();
        }
        else if (extensionAllowed.length > 0) {
            return extensionAllowed.find((currentExtension) => {
                return this.extension.toLowerCase() === currentExtension.toLowerCase();
            });
        }
    }
    onSubmitFile(newImageBlob) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;
        if (((_b = (_a = this === null || this === void 0 ? void 0 : this.nodeEntry) === null || _a === void 0 ? void 0 : _a.entry) === null || _b === void 0 ? void 0 : _b.id) && !this.readOnly) {
            const newImageFile = new File([newImageBlob], (_d = (_c = this === null || this === void 0 ? void 0 : this.nodeEntry) === null || _c === void 0 ? void 0 : _c.entry) === null || _d === void 0 ? void 0 : _d.name, { type: (_g = (_f = (_e = this === null || this === void 0 ? void 0 : this.nodeEntry) === null || _e === void 0 ? void 0 : _e.entry) === null || _f === void 0 ? void 0 : _f.content) === null || _g === void 0 ? void 0 : _g.mimeType });
            const newFile = new FileModel(newImageFile, {
                majorVersion: false,
                newVersion: true,
                parentId: (_j = (_h = this === null || this === void 0 ? void 0 : this.nodeEntry) === null || _h === void 0 ? void 0 : _h.entry) === null || _j === void 0 ? void 0 : _j.parentId,
                nodeType: (_m = (_l = (_k = this === null || this === void 0 ? void 0 : this.nodeEntry) === null || _k === void 0 ? void 0 : _k.entry) === null || _l === void 0 ? void 0 : _l.content) === null || _m === void 0 ? void 0 : _m.mimeType
            }, (_p = (_o = this === null || this === void 0 ? void 0 : this.nodeEntry) === null || _o === void 0 ? void 0 : _o.entry) === null || _p === void 0 ? void 0 : _p.id);
            this.uploadService.addToQueue(...[newFile]);
            this.uploadService.uploadFilesInTheQueue();
        }
    }
    onUnsupportedFile() {
        this.viewerType = 'unknown';
    }
    closeOverlayManager() {
        this.dialog.afterOpened.pipe(skipWhile(() => !this.overlayMode), takeUntil(this.onDestroy$)).subscribe(() => this.shouldCloseViewer = false);
        this.dialog.afterAllClosed.pipe(skipWhile(() => !this.overlayMode), takeUntil(this.onDestroy$)).subscribe(() => this.shouldCloseViewer = true);
        this.keyDown$.pipe(skipWhile(() => !this.overlayMode), filter((e) => e.keyCode === 27), takeUntil(this.onDestroy$)).subscribe((event) => {
            event.preventDefault();
            if (this.shouldCloseViewer) {
                this.close();
            }
        });
    }
    generateCacheBusterNumber() {
        this.cacheBusterNumber = Date.now();
    }
}
ViewerComponent.ɵfac = function ViewerComponent_Factory(t) { return new (t || ViewerComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc1.AlfrescoApiService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.ViewUtilService), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.LogService), ɵngcc0.ɵɵdirectiveInject(ɵngcc4.AppExtensionService), ɵngcc0.ɵɵdirectiveInject(ɵngcc5.ContentService), ɵngcc0.ɵɵdirectiveInject(ɵngcc6.UploadService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc7.MatDialog)); };
ViewerComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ViewerComponent, selectors: [["adf-viewer"]], contentQueries: function ViewerComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, ViewerToolbarComponent, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ViewerSidebarComponent, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ViewerOpenWithComponent, true);
        ɵngcc0.ɵɵcontentQuery(dirIndex, ViewerMoreActionsComponent, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.toolbar = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.sidebar = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.mnuOpenWith = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.mnuMoreActions = _t.first);
    } }, hostAttrs: [1, "adf-viewer"], hostBindings: function ViewerComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("keyup", function ViewerComponent_keyup_HostBindingHandler($event) { return ctx.handleKeyboardEvent($event); }, false, ɵngcc0.ɵɵresolveDocument);
    } }, inputs: { urlFile: "urlFile", urlFileViewer: "urlFileViewer", nodeId: "nodeId", versionId: "versionId", sharedLinkId: "sharedLinkId", overlayMode: "overlayMode", showViewer: "showViewer", showToolbar: "showToolbar", allowGoBack: "allowGoBack", allowDownload: "allowDownload", allowPrint: "allowPrint", allowFullScreen: "allowFullScreen", allowNavigate: "allowNavigate", canNavigateBefore: "canNavigateBefore", canNavigateNext: "canNavigateNext", allowLeftSidebar: "allowLeftSidebar", allowRightSidebar: "allowRightSidebar", allowThumbnails: "allowThumbnails", showRightSidebar: "showRightSidebar", showLeftSidebar: "showLeftSidebar", sidebarRightTemplate: "sidebarRightTemplate", sidebarLeftTemplate: "sidebarLeftTemplate", thumbnailsTemplate: "thumbnailsTemplate", maxRetries: "maxRetries", mimeType: "mimeType", fileName: "fileName", blobFile: "blobFile", displayName: "displayName" }, outputs: { goBack: "goBack", print: "print", showViewerChange: "showViewerChange", extensionChange: "extensionChange", navigateBefore: "navigateBefore", navigateNext: "navigateNext", invalidSharedLink: "invalidSharedLink" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], ngContentSelectors: _c2, decls: 1, vars: 1, consts: [["class", "adf-viewer-container", 3, "adf-viewer-overlay-container", "adf-viewer-inline-container", 4, "ngIf"], [1, "adf-viewer-container"], ["fxLayout", "column", "cdkTrapFocusAutoCapture", "", 1, "adf-viewer-content", 3, "cdkTrapFocus"], [4, "ngIf"], ["fxLayout", "row", "fxFlex", "1 1 auto"], ["class", "adf-viewer-main", "fxFlexOrder", "1", "fxFlex", "1 1 auto", 4, "ngIf"], ["id", "adf-viewer-toolbar", 1, "adf-viewer-toolbar"], ["class", "adf-viewer-close-button", "data-automation-id", "adf-toolbar-back", "mat-icon-button", "", 3, "title", "click", 4, "ngIf"], ["fxFlex", "1 1 auto", 1, "adf-viewer__file-title"], ["data-automation-id", "adf-toolbar-pref-file", "mat-icon-button", "", 3, "title", "click", 4, "ngIf"], ["data-automation-id", "adf-file-thumbnail", 1, "adf-viewer__mimeicon", 3, "alt", "src"], ["id", "adf-viewer-display-name", 1, "adf-viewer__display-name"], ["data-automation-id", "adf-toolbar-next-file", "mat-icon-button", "", 3, "title", "click", 4, "ngIf"], ["data-automation-id", "adf-toolbar-custom-btn", 4, "ngIf"], ["id", "adf-viewer-download", "mat-icon-button", "", "data-automation-id", "adf-toolbar-download", 3, "title", "adfNodeDownload", "version", 4, "ngIf"], ["id", "adf-viewer-print", "mat-icon-button", "", "data-automation-id", "adf-toolbar-print", 3, "title", "click", 4, "ngIf"], ["id", "adf-viewer-fullscreen", "mat-icon-button", "", "data-automation-id", "adf-toolbar-fullscreen", 3, "title", "click", 4, "ngIf"], ["mat-icon-button", "", "data-automation-id", "adf-toolbar-left-sidebar", 3, "title", "color", "click"], ["data-automation-id", "adf-toolbar-back", "mat-icon-button", "", 1, "adf-viewer-close-button", 3, "title", "click"], ["data-automation-id", "adf-toolbar-pref-file", "mat-icon-button", "", 3, "title", "click"], ["data-automation-id", "adf-toolbar-next-file", "mat-icon-button", "", 3, "title", "click"], ["data-automation-id", "adf-toolbar-custom-btn"], ["id", "adf-viewer-openwith", "mat-button", "", "data-automation-id", "adf-toolbar-open-with", 3, "matMenuTriggerFor"], [3, "overlapTrigger"], ["mnuOpenWith", "matMenu"], ["id", "adf-viewer-download", "mat-icon-button", "", "data-automation-id", "adf-toolbar-download", 3, "title", "adfNodeDownload", "version"], ["id", "adf-viewer-print", "mat-icon-button", "", "data-automation-id", "adf-toolbar-print", 3, "title", "click"], ["id", "adf-viewer-fullscreen", "mat-icon-button", "", "data-automation-id", "adf-toolbar-fullscreen", 3, "title", "click"], ["mat-icon-button", "", "data-automation-id", "adf-toolbar-sidebar", 3, "title", "color", "click"], ["id", "adf-viewer-moreactions", "mat-icon-button", "", "data-automation-id", "adf-toolbar-more-actions", 3, "matMenuTriggerFor", "title"], ["mnuMoreActions", "matMenu"], ["fxFlexOrder", "4", "id", "adf-right-sidebar", 1, "adf-viewer__sidebar", 3, "ngClass"], [4, "ngTemplateOutlet", "ngTemplateOutletContext"], ["fxFlexOrder", "1", "id", "adf-left-sidebar", 1, "adf-viewer__sidebar", 3, "ngClass"], ["fxFlexOrder", "1", "fxFlex", "1 1 auto", 1, "adf-viewer-main"], [1, "adf-viewer-layout-content", "adf-viewer__fullscreen-container"], [1, "adf-viewer-content-container"], ["fxFlex", "1 1 auto", 1, "adf-viewer__loading-screen"], [1, "adf-viewer-content-container", 3, "ngSwitch"], [4, "ngSwitchCase"], [4, "ngSwitchDefault"], [3, "thumbnailsTemplate", "allowThumbnails", "blobFile", "urlFile", "nameFile", "cacheType", "close", "error"], [3, "urlFile", "nameFile", "blobFile", "readOnly", "error", "submit"], ["id", "adf-mdedia-player", 3, "urlFile", "nodeId", "mimeType", "blobFile", "nameFile", "error"], [3, "urlFile", "blobFile"], [4, "ngFor", "ngForOf"], ["class", "adf-viewer-custom-content", 4, "ngFor", "ngForOf"], [3, "id", "node", "url", "extension", 4, "ngIf"], [3, "id", "node", "url", "extension"], [1, "adf-viewer-custom-content"], [3, "ngTemplateOutlet", "ngTemplateOutletContext"]], template: function ViewerComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef(_c1);
        ɵngcc0.ɵɵtemplate(0, ViewerComponent_div_0_Template, 9, 10, "div", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.showViewer);
    } }, directives: [ɵngcc8.NgIf, ɵngcc9.DefaultLayoutDirective, ɵngcc10.CdkTrapFocus, ɵngcc9.DefaultFlexDirective, ɵngcc11.ToolbarComponent, ɵngcc12.ToolbarTitleComponent, ɵngcc13.ToolbarDividerComponent, ɵngcc14.MatButton, ɵngcc15.MatIcon, ɵngcc16.MatMenuTrigger, ɵngcc16._MatMenu, ɵngcc17.NodeDownloadDirective, ɵngcc9.DefaultFlexOrderDirective, ɵngcc8.NgClass, ɵngcc18.DefaultClassDirective, ɵngcc8.NgTemplateOutlet, ɵngcc19.MatSpinner, ɵngcc8.NgSwitch, ɵngcc8.NgSwitchCase, ɵngcc8.NgSwitchDefault, ɵngcc20.PdfViewerComponent, ɵngcc21.ImgViewerComponent, ɵngcc22.MediaPlayerComponent, ɵngcc23.TxtViewerComponent, ɵngcc8.NgForOf, ɵngcc4.PreviewExtensionComponent, ɵngcc24.UnknownFormatComponent], pipes: [ɵngcc25.MimeTypeIconPipe, ɵngcc26.TranslatePipe], encapsulation: 2 });
ViewerComponent.ctorParameters = () => [
    { type: AlfrescoApiService },
    { type: ViewUtilService },
    { type: LogService },
    { type: AppExtensionService },
    { type: ContentService },
    { type: UploadService },
    { type: ElementRef },
    { type: MatDialog }
];
ViewerComponent.propDecorators = {
    toolbar: [{ type: ContentChild, args: [ViewerToolbarComponent,] }],
    sidebar: [{ type: ContentChild, args: [ViewerSidebarComponent,] }],
    mnuOpenWith: [{ type: ContentChild, args: [ViewerOpenWithComponent,] }],
    mnuMoreActions: [{ type: ContentChild, args: [ViewerMoreActionsComponent,] }],
    urlFile: [{ type: Input }],
    urlFileViewer: [{ type: Input }],
    blobFile: [{ type: Input }],
    nodeId: [{ type: Input }],
    versionId: [{ type: Input }],
    sharedLinkId: [{ type: Input }],
    overlayMode: [{ type: Input }],
    showViewer: [{ type: Input }],
    showToolbar: [{ type: Input }],
    displayName: [{ type: Input }],
    allowGoBack: [{ type: Input }],
    allowDownload: [{ type: Input }],
    allowPrint: [{ type: Input }],
    allowFullScreen: [{ type: Input }],
    allowNavigate: [{ type: Input }],
    canNavigateBefore: [{ type: Input }],
    canNavigateNext: [{ type: Input }],
    allowLeftSidebar: [{ type: Input }],
    allowRightSidebar: [{ type: Input }],
    allowThumbnails: [{ type: Input }],
    showRightSidebar: [{ type: Input }],
    showLeftSidebar: [{ type: Input }],
    sidebarRightTemplate: [{ type: Input }],
    sidebarLeftTemplate: [{ type: Input }],
    thumbnailsTemplate: [{ type: Input }],
    mimeType: [{ type: Input }],
    fileName: [{ type: Input }],
    maxRetries: [{ type: Input }],
    goBack: [{ type: Output }],
    print: [{ type: Output }],
    showViewerChange: [{ type: Output }],
    extensionChange: [{ type: Output }],
    navigateBefore: [{ type: Output }],
    navigateNext: [{ type: Output }],
    invalidSharedLink: [{ type: Output }],
    handleKeyboardEvent: [{ type: HostListener, args: ['document:keyup', ['$event'],] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(ViewerComponent, [{
        type: Component,
        args: [{
                selector: 'adf-viewer',
                template: "<div *ngIf=\"showViewer\"\n     class=\"adf-viewer-container\"\n     [class.adf-viewer-overlay-container]=\"overlayMode\"\n     [class.adf-viewer-inline-container]=\"!overlayMode\">\n\n    <div class=\"adf-viewer-content\"\n         fxLayout=\"column\"\n         [cdkTrapFocus]=\"overlayMode\"\n         cdkTrapFocusAutoCapture>\n        <ng-content select=\"adf-viewer-toolbar\"></ng-content>\n        <ng-container *ngIf=\"showToolbar && !toolbar\">\n            <adf-toolbar id=\"adf-viewer-toolbar\" class=\"adf-viewer-toolbar\">\n                <adf-toolbar-title>\n\n                    <ng-container *ngIf=\"allowLeftSidebar\">\n                        <button mat-icon-button\n                                [attr.aria-expanded]=\"showLeftSidebar\"\n                                [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.INFO' | translate\"\n                                title=\"{{ 'ADF_VIEWER.ACTIONS.INFO' | translate }}\"\n                                data-automation-id=\"adf-toolbar-left-sidebar\"\n                                [color]=\"showLeftSidebar ? 'accent' : null\"\n                                (click)=\"toggleLeftSidebar()\">\n                            <mat-icon>info_outline</mat-icon>\n                        </button>\n                    </ng-container>\n\n                    <button *ngIf=\"allowGoBack\"\n                            class=\"adf-viewer-close-button\"\n                            data-automation-id=\"adf-toolbar-back\"\n                            [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.CLOSE' | translate\"\n                            mat-icon-button\n                            title=\"{{ 'ADF_VIEWER.ACTIONS.CLOSE' | translate }}\"\n                            (click)=\"onBackButtonClick()\">\n                        <mat-icon>close</mat-icon>\n                    </button>\n                </adf-toolbar-title>\n\n                <div fxFlex=\"1 1 auto\"\n                     class=\"adf-viewer__file-title\">\n                    <button *ngIf=\"allowNavigate && canNavigateBefore\"\n                            data-automation-id=\"adf-toolbar-pref-file\"\n                            mat-icon-button\n                            [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.PREV_FILE' | translate\"\n                            title=\"{{ 'ADF_VIEWER.ACTIONS.PREV_FILE' | translate }}\"\n                            (click)=\"onNavigateBeforeClick($event)\">\n                        <mat-icon>navigate_before</mat-icon>\n                    </button>\n                    <img class=\"adf-viewer__mimeicon\"\n                         [alt]=\"mimeType\"\n                         [src]=\"mimeType | adfMimeTypeIcon\"\n                         data-automation-id=\"adf-file-thumbnail\">\n                    <span class=\"adf-viewer__display-name\"\n                          id=\"adf-viewer-display-name\">{{ fileTitle }}</span>\n                    <button *ngIf=\"allowNavigate && canNavigateNext\"\n                            data-automation-id=\"adf-toolbar-next-file\"\n                            mat-icon-button\n                            [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.NEXT_FILE' | translate\"\n                            title=\"{{ 'ADF_VIEWER.ACTIONS.NEXT_FILE' | translate }}\"\n                            (click)=\"onNavigateNextClick($event)\">\n                        <mat-icon>navigate_next</mat-icon>\n                    </button>\n                </div>\n\n                <ng-content select=\"adf-viewer-toolbar-actions\"></ng-content>\n\n                <ng-container *ngIf=\"mnuOpenWith\"\n                              data-automation-id='adf-toolbar-custom-btn'>\n                    <button id=\"adf-viewer-openwith\"\n                            mat-button\n                            [matMenuTriggerFor]=\"mnuOpenWith\"\n                            data-automation-id=\"adf-toolbar-open-with\">\n                        <span>{{ 'ADF_VIEWER.ACTIONS.OPEN_WITH' | translate }}</span>\n                        <mat-icon>arrow_drop_down</mat-icon>\n                    </button>\n                    <mat-menu #mnuOpenWith=\"matMenu\"\n                              [overlapTrigger]=\"false\">\n                        <ng-content select=\"adf-viewer-open-with\"></ng-content>\n                    </mat-menu>\n                </ng-container>\n\n                <adf-toolbar-divider></adf-toolbar-divider>\n\n                <button id=\"adf-viewer-download\"\n                        *ngIf=\"allowDownload\"\n                        mat-icon-button\n                        [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.DOWNLOAD' | translate\"\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.DOWNLOAD' | translate }}\"\n                        data-automation-id=\"adf-toolbar-download\"\n                        [adfNodeDownload]=\"nodeEntry\"\n                        [version]=\"versionEntry\">\n                    <mat-icon>file_download</mat-icon>\n                </button>\n\n                <button id=\"adf-viewer-print\"\n                        *ngIf=\"allowPrint\"\n                        mat-icon-button\n                        [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.PRINT' | translate\"\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.PRINT' | translate }}\"\n                        data-automation-id=\"adf-toolbar-print\"\n                        (click)=\"printContent()\">\n                    <mat-icon>print</mat-icon>\n                </button>\n\n                <button id=\"adf-viewer-fullscreen\"\n                        *ngIf=\"viewerType !== 'media' && allowFullScreen\"\n                        mat-icon-button\n                        [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.FULLSCREEN' | translate\"\n                        title=\"{{ 'ADF_VIEWER.ACTIONS.FULLSCREEN' | translate }}\"\n                        data-automation-id=\"adf-toolbar-fullscreen\"\n                        (click)=\"enterFullScreen()\">\n                    <mat-icon>fullscreen</mat-icon>\n                </button>\n\n                <ng-container *ngIf=\"allowRightSidebar\">\n                    <adf-toolbar-divider></adf-toolbar-divider>\n\n                    <button mat-icon-button\n                            [attr.aria-expanded]=\"showRightSidebar\"\n                            [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.INFO' | translate\"\n                            title=\"{{ 'ADF_VIEWER.ACTIONS.INFO' | translate }}\"\n                            data-automation-id=\"adf-toolbar-sidebar\"\n                            [color]=\"showRightSidebar ? 'accent' : null\"\n                            (click)=\"toggleSidebar()\">\n                        <mat-icon>info_outline</mat-icon>\n                    </button>\n\n                </ng-container>\n\n                <ng-container *ngIf=\"mnuMoreActions\">\n                    <button id=\"adf-viewer-moreactions\"\n                            mat-icon-button\n                            [matMenuTriggerFor]=\"mnuMoreActions\"\n                            [attr.aria-label]=\"'ADF_VIEWER.ACTIONS.MORE_ACTIONS' | translate\"\n                            title=\"{{ 'ADF_VIEWER.ACTIONS.MORE_ACTIONS' | translate }}\"\n                            data-automation-id=\"adf-toolbar-more-actions\">\n                        <mat-icon>more_vert</mat-icon>\n                    </button>\n                    <mat-menu #mnuMoreActions=\"matMenu\"\n                              [overlapTrigger]=\"false\">\n                        <ng-content select=\"adf-viewer-more-actions\"></ng-content>\n                    </mat-menu>\n                </ng-container>\n\n            </adf-toolbar>\n        </ng-container>\n\n        <div fxLayout=\"row\"\n             fxFlex=\"1 1 auto\">\n            <ng-container *ngIf=\"allowRightSidebar && showRightSidebar\">\n                <div class=\"adf-viewer__sidebar\"\n                     [ngClass]=\"'adf-viewer__sidebar__right'\"\n                     fxFlexOrder=\"4\"\n                     id=\"adf-right-sidebar\">\n                    <ng-container *ngIf=\"sidebarRightTemplate\">\n                        <ng-container *ngTemplateOutlet=\"sidebarRightTemplate;context:sidebarRightTemplateContext\">\n                        </ng-container>\n                    </ng-container>\n                    <ng-content *ngIf=\"!sidebarRightTemplate\"\n                                select=\"adf-viewer-sidebar\"></ng-content>\n                </div>\n            </ng-container>\n\n            <ng-container *ngIf=\"allowLeftSidebar && showLeftSidebar\">\n                <div class=\"adf-viewer__sidebar\"\n                     [ngClass]=\"'adf-viewer__sidebar__left'\"\n                     fxFlexOrder=\"1\"\n                     id=\"adf-left-sidebar\">\n                    <ng-container *ngIf=\"sidebarLeftTemplate\">\n                        <ng-container *ngTemplateOutlet=\"sidebarLeftTemplate;context:sidebarLeftTemplateContext\">\n                        </ng-container>\n                    </ng-container>\n                    <ng-content *ngIf=\"!sidebarLeftTemplate\"\n                                select=\"adf-viewer-sidebar\"></ng-content>\n                </div>\n            </ng-container>\n\n            <div *ngIf=\"isLoading\"\n                 class=\"adf-viewer-main\"\n                 fxFlexOrder=\"1\"\n                 fxFlex=\"1 1 auto\">\n                <div class=\"adf-viewer-layout-content adf-viewer__fullscreen-container\">\n                    <div class=\"adf-viewer-content-container\">\n                        <ng-container *ngIf=\"isLoading\">\n                            <div class=\"adf-viewer__loading-screen\"\n                                 fxFlex=\"1 1 auto\">\n                                <h2>{{ 'ADF_VIEWER.LOADING' | translate }}</h2>\n                                <div>\n                                    <mat-spinner></mat-spinner>\n                                </div>\n                            </div>\n                        </ng-container>\n\n                    </div>\n                </div>\n            </div>\n\n            <div *ngIf=\"!isLoading\"\n                 class=\"adf-viewer-main\"\n                 fxFlexOrder=\"1\"\n                 fxFlex=\"1 1 auto\">\n                <div class=\"adf-viewer-layout-content adf-viewer__fullscreen-container\">\n                    <div class=\"adf-viewer-content-container\"\n                         [ngSwitch]=\"viewerType\">\n\n                        <ng-container *ngSwitchCase=\"'pdf'\">\n                            <adf-pdf-viewer (close)=\"onBackButtonClick()\"\n                                            [thumbnailsTemplate]=\"thumbnailsTemplate\"\n                                            [allowThumbnails]=\"allowThumbnails\"\n                                            [blobFile]=\"blobFile\"\n                                            [urlFile]=\"urlFileContent\"\n                                            [nameFile]=\"displayName\"\n                                            [cacheType]=\"cacheTypeForContent\"\n                                            (error)=\"onUnsupportedFile()\"></adf-pdf-viewer>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'image'\">\n                            <adf-img-viewer [urlFile]=\"urlFileContent\"\n                                            [nameFile]=\"displayName\"\n                                            [blobFile]=\"blobFile\"\n                                            [readOnly]=\"readOnly\"\n                                            (error)=\"onUnsupportedFile()\"\n                                            (submit)=\"onSubmitFile($event)\"\n                            ></adf-img-viewer>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'media'\">\n                            <adf-media-player id=\"adf-mdedia-player\"\n                                              [urlFile]=\"urlFileContent\"\n                                              [nodeId]=\"nodeEntry?.entry?.id\"\n                                              [mimeType]=\"mimeType\"\n                                              [blobFile]=\"blobFile\"\n                                              [nameFile]=\"displayName\"\n                                              (error)=\"onUnsupportedFile()\"></adf-media-player>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'text'\">\n                            <adf-txt-viewer [urlFile]=\"urlFileContent\"\n                                            [blobFile]=\"blobFile\"></adf-txt-viewer>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'in_creation'\">\n                            <div class=\"adf-viewer__loading-screen\"\n                                 fxFlex=\"1 1 auto\">\n                                <h2>{{ 'ADF_VIEWER.LOADING' | translate }}</h2>\n                                <div>\n                                    <mat-spinner></mat-spinner>\n                                </div>\n                            </div>\n                        </ng-container>\n\n                        <ng-container *ngSwitchCase=\"'custom'\">\n                            <ng-container *ngFor=\"let ext of viewerExtensions\">\n                                <adf-preview-extension *ngIf=\"checkExtensions(ext.fileExtension)\"\n                                                       [id]=\"ext.component\"\n                                                       [node]=\"nodeEntry.entry\"\n                                                       [url]=\"urlFileContent\"\n                                                       [extension]=\"extension\"\n                                                       [attr.data-automation-id]=\"ext.component\">\n                                </adf-preview-extension>\n                            </ng-container>\n\n                            <span class=\"adf-viewer-custom-content\"\n                                  *ngFor=\"let extensionTemplate of extensionTemplates\">\n                                <ng-template *ngIf=\"extensionTemplate.isVisible\"\n                                             [ngTemplateOutlet]=\"extensionTemplate.template\"\n                                             [ngTemplateOutletContext]=\"{ urlFileContent: urlFileContent, extension:extension }\">\n                                </ng-template>\n                            </span>\n                        </ng-container>\n\n                        <ng-container *ngSwitchDefault>\n                            <adf-viewer-unknown-format></adf-viewer-unknown-format>\n                        </ng-container>\n                    </div>\n                </div>\n            </div>\n\n        </div>\n    </div>\n</div>\n",
                host: { 'class': 'adf-viewer' },
                encapsulation: ViewEncapsulation.None
            }]
    }], function () { return [{ type: ɵngcc1.AlfrescoApiService }, { type: ɵngcc2.ViewUtilService }, { type: ɵngcc3.LogService }, { type: ɵngcc4.AppExtensionService }, { type: ɵngcc5.ContentService }, { type: ɵngcc6.UploadService }, { type: ɵngcc0.ElementRef }, { type: ɵngcc7.MatDialog }]; }, { urlFile: [{
            type: Input
        }], urlFileViewer: [{
            type: Input
        }], nodeId: [{
            type: Input
        }], versionId: [{
            type: Input
        }], sharedLinkId: [{
            type: Input
        }], overlayMode: [{
            type: Input
        }], showViewer: [{
            type: Input
        }], showToolbar: [{
            type: Input
        }], allowGoBack: [{
            type: Input
        }], allowDownload: [{
            type: Input
        }], allowPrint: [{
            type: Input
        }], allowFullScreen: [{
            type: Input
        }], allowNavigate: [{
            type: Input
        }], canNavigateBefore: [{
            type: Input
        }], canNavigateNext: [{
            type: Input
        }], allowLeftSidebar: [{
            type: Input
        }], allowRightSidebar: [{
            type: Input
        }], allowThumbnails: [{
            type: Input
        }], showRightSidebar: [{
            type: Input
        }], showLeftSidebar: [{
            type: Input
        }], sidebarRightTemplate: [{
            type: Input
        }], sidebarLeftTemplate: [{
            type: Input
        }], thumbnailsTemplate: [{
            type: Input
        }], maxRetries: [{
            type: Input
        }], goBack: [{
            type: Output
        }], print: [{
            type: Output
        }], showViewerChange: [{
            type: Output
        }], extensionChange: [{
            type: Output
        }], navigateBefore: [{
            type: Output
        }], navigateNext: [{
            type: Output
        }], invalidSharedLink: [{
            type: Output
        }], mimeType: [{
            type: Input
        }], fileName: [{
            type: Input
        }], handleKeyboardEvent: [{
            type: HostListener,
            args: ['document:keyup', ['$event']]
        }], toolbar: [{
            type: ContentChild,
            args: [ViewerToolbarComponent]
        }], sidebar: [{
            type: ContentChild,
            args: [ViewerSidebarComponent]
        }], mnuOpenWith: [{
            type: ContentChild,
            args: [ViewerOpenWithComponent]
        }], mnuMoreActions: [{
            type: ContentChild,
            args: [ViewerMoreActionsComponent]
        }], blobFile: [{
            type: Input
        }], displayName: [{
            type: Input
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlld2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vaG9tZS90cmF2aXMvYnVpbGQvQWxmcmVzY28vYWxmcmVzY28tbmcyLWNvbXBvbmVudHMvbGliL2NvcmUvdmlld2VyL2NvbXBvbmVudHMvdmlld2VyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxPQUFPLEVBQ0gsU0FBUyxFQUFFLFlBQVksRUFBRSxZQUFZLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFDL0QsS0FBSyxFQUFhLE1BQU0sRUFBRSxXQUFXLEVBQ3JDLGlCQUFpQixFQUNwQixNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ3pDLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHFDQUFxQyxDQUFDO0FBQ3pFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUN4RCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUM3RSxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSw4QkFBOEIsQ0FBQztBQUN2RSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNwRSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUNwRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUMxQyxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sK0JBQStCLENBQUM7QUFDaEUsT0FBTyxFQUFFLG1CQUFtQixFQUFzQixNQUFNLDBCQUEwQixDQUFDO0FBQ25GLE9BQU8sRUFBRSxNQUFNLEVBQUUsU0FB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QU07QUFDVCwrQkFHRyxNQUFNO0FBQ1QsOEJBR0csTUFBTTtBQUNULDZCQUdHLE1BQU07QUFDVCwyQkFHRyxNQUFNO0FBQ1QsZ0NBR0csTUFBTTtBQUNULGtDQTRZRyxZQUFZLFNBQUMsZ0JBQWdCLEVBQUUsQ0FBQyxRQUFRLENBQUM7QUFDMUM7Ozs7OysvSkFwakJzQyxrQkFDdEMsSUFBSSxFQUFFLEVBQUUsT0FBTyxFQUFFLFlBQVksRUFBRSxrQkFDL0IsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUksY0FDeEM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O29CQWlqQks7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7XG4gICAgQ29tcG9uZW50LCBDb250ZW50Q2hpbGQsIEV2ZW50RW1pdHRlciwgSG9zdExpc3RlbmVyLCBFbGVtZW50UmVmLFxuICAgIElucHV0LCBPbkNoYW5nZXMsIE91dHB1dCwgVGVtcGxhdGVSZWYsXG4gICAgVmlld0VuY2Fwc3VsYXRpb24sIE9uSW5pdCwgT25EZXN0cm95XG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgU2hhcmVkTGlua0VudHJ5LCBOb2RlLCBWZXJzaW9uLCBSZW5kaXRpb25FbnRyeSwgTm9kZUVudHJ5LCBWZXJzaW9uRW50cnkgfSBmcm9tICdAYWxmcmVzY28vanMtYXBpJztcbmltcG9ydCB7IEJhc2VFdmVudCB9IGZyb20gJy4uLy4uL2V2ZW50cyc7XG5pbXBvcnQgeyBBbGZyZXNjb0FwaVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9hbGZyZXNjby1hcGkuc2VydmljZSc7XG5pbXBvcnQgeyBMb2dTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvbG9nLnNlcnZpY2UnO1xuaW1wb3J0IHsgVmlld2VyTW9yZUFjdGlvbnNDb21wb25lbnQgfSBmcm9tICcuL3ZpZXdlci1tb3JlLWFjdGlvbnMuY29tcG9uZW50JztcbmltcG9ydCB7IFZpZXdlck9wZW5XaXRoQ29tcG9uZW50IH0gZnJvbSAnLi92aWV3ZXItb3Blbi13aXRoLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBWaWV3ZXJTaWRlYmFyQ29tcG9uZW50IH0gZnJvbSAnLi92aWV3ZXItc2lkZWJhci5jb21wb25lbnQnO1xuaW1wb3J0IHsgVmlld2VyVG9vbGJhckNvbXBvbmVudCB9IGZyb20gJy4vdmlld2VyLXRvb2xiYXIuY29tcG9uZW50JztcbmltcG9ydCB7IGZyb21FdmVudCwgU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgVmlld1V0aWxTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvdmlldy11dGlsLnNlcnZpY2UnO1xuaW1wb3J0IHsgQXBwRXh0ZW5zaW9uU2VydmljZSwgVmlld2VyRXh0ZW5zaW9uUmVmIH0gZnJvbSAnQGFsZnJlc2NvL2FkZi1leHRlbnNpb25zJztcbmltcG9ydCB7IGZpbHRlciwgc2tpcFdoaWxlLCB0YWtlVW50aWwgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBNYXREaWFsb2cgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9kaWFsb2cnO1xuaW1wb3J0IHsgQ29udGVudFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9jb250ZW50LnNlcnZpY2UnO1xuaW1wb3J0IHsgVXBsb2FkU2VydmljZSB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3VwbG9hZC5zZXJ2aWNlJztcbmltcG9ydCB7IEZpbGVNb2RlbCB9IGZyb20gJy4uLy4uL21vZGVscyc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAnYWRmLXZpZXdlcicsXG4gICAgdGVtcGxhdGVVcmw6ICcuL3ZpZXdlci5jb21wb25lbnQuaHRtbCcsXG4gICAgaG9zdDogeyAnY2xhc3MnOiAnYWRmLXZpZXdlcicgfSxcbiAgICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXG59KVxuZXhwb3J0IGNsYXNzIFZpZXdlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcywgT25Jbml0LCBPbkRlc3Ryb3kge1xuXG4gICAgQENvbnRlbnRDaGlsZChWaWV3ZXJUb29sYmFyQ29tcG9uZW50KVxuICAgIHRvb2xiYXI6IFZpZXdlclRvb2xiYXJDb21wb25lbnQ7XG5cbiAgICBAQ29udGVudENoaWxkKFZpZXdlclNpZGViYXJDb21wb25lbnQpXG4gICAgc2lkZWJhcjogVmlld2VyU2lkZWJhckNvbXBvbmVudDtcblxuICAgIEBDb250ZW50Q2hpbGQoVmlld2VyT3BlbldpdGhDb21wb25lbnQpXG4gICAgbW51T3BlbldpdGg6IFZpZXdlck9wZW5XaXRoQ29tcG9uZW50O1xuXG4gICAgQENvbnRlbnRDaGlsZChWaWV3ZXJNb3JlQWN0aW9uc0NvbXBvbmVudClcbiAgICBtbnVNb3JlQWN0aW9uczogVmlld2VyTW9yZUFjdGlvbnNDb21wb25lbnQ7XG5cbiAgICAvKiogSWYgeW91IHdhbnQgdG8gbG9hZCBhbiBleHRlcm5hbCBmaWxlIHRoYXQgZG9lcyBub3QgY29tZSBmcm9tIEFDUyB5b3VcbiAgICAgKiBjYW4gdXNlIHRoaXMgVVJMIHRvIHNwZWNpZnkgd2hlcmUgdG8gbG9hZCB0aGUgZmlsZSBmcm9tLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgdXJsRmlsZSA9ICcnO1xuXG4gICAgLyoqIFZpZXdlciB0byB1c2Ugd2l0aCB0aGUgYHVybEZpbGVgIGFkZHJlc3MgKGBwZGZgLCBgaW1hZ2VgLCBgbWVkaWFgLCBgdGV4dGApLlxuICAgICAqIFVzZWQgd2hlbiBgdXJsRmlsZWAgaGFzIG5vIGZpbGVuYW1lIGFuZCBleHRlbnNpb24uXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICB1cmxGaWxlVmlld2VyOiBzdHJpbmcgPSBudWxsO1xuXG4gICAgLyoqIExvYWRzIGEgQmxvYiBGaWxlICovXG4gICAgQElucHV0KClcbiAgICBibG9iRmlsZTogQmxvYjtcblxuICAgIC8qKiBOb2RlIElkIG9mIHRoZSBmaWxlIHRvIGxvYWQuICovXG4gICAgQElucHV0KClcbiAgICBub2RlSWQ6IHN0cmluZyA9IG51bGw7XG5cbiAgICAvKiogVmVyc2lvbiBJZCBvZiB0aGUgZmlsZSB0byBsb2FkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgdmVyc2lvbklkOiBzdHJpbmcgPSBudWxsO1xuXG4gICAgLyoqIFNoYXJlZCBsaW5rIGlkICh0byBkaXNwbGF5IHNoYXJlZCBmaWxlKS4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNoYXJlZExpbmtJZDogc3RyaW5nID0gbnVsbDtcblxuICAgIC8qKiBJZiBgdHJ1ZWAgdGhlbiBzaG93IHRoZSBWaWV3ZXIgYXMgYSBmdWxsIHBhZ2Ugb3ZlciB0aGUgY3VycmVudCBjb250ZW50LlxuICAgICAqIE90aGVyd2lzZSBmaXQgaW5zaWRlIHRoZSBwYXJlbnQgZGl2LlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgb3ZlcmxheU1vZGUgPSBmYWxzZTtcblxuICAgIC8qKiBIaWRlIG9yIHNob3cgdGhlIHZpZXdlciAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2hvd1ZpZXdlciA9IHRydWU7XG5cbiAgICAvKiogSGlkZSBvciBzaG93IHRoZSB0b29sYmFyICovXG4gICAgQElucHV0KClcbiAgICBzaG93VG9vbGJhciA9IHRydWU7XG5cbiAgICAvKiogU3BlY2lmaWVzIHRoZSBuYW1lIG9mIHRoZSBmaWxlIHdoZW4gaXQgaXMgbm90IGF2YWlsYWJsZSBmcm9tIHRoZSBVUkwuICovXG4gICAgQElucHV0KClcbiAgICBkaXNwbGF5TmFtZTogc3RyaW5nO1xuXG4gICAgLyoqIEBkZXByZWNhdGVkIDMuMi4wICovXG4gICAgLyoqIEFsbG93cyBgYmFja2AgbmF2aWdhdGlvbiAqL1xuICAgIEBJbnB1dCgpXG4gICAgYWxsb3dHb0JhY2sgPSB0cnVlO1xuXG4gICAgLyoqIFRvZ2dsZXMgZG93bmxvYWRpbmcuICovXG4gICAgQElucHV0KClcbiAgICBhbGxvd0Rvd25sb2FkID0gdHJ1ZTtcblxuICAgIC8qKiBUb2dnbGVzIHByaW50aW5nLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgYWxsb3dQcmludCA9IGZhbHNlO1xuXG4gICAgLyoqIFRvZ2dsZXMgdGhlICdGdWxsIFNjcmVlbicgZmVhdHVyZS4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFsbG93RnVsbFNjcmVlbiA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyBiZWZvcmUvbmV4dCBuYXZpZ2F0aW9uLiBZb3UgY2FuIHVzZSB0aGUgYXJyb3cgYnV0dG9ucyB0byBuYXZpZ2F0ZVxuICAgICAqIGJldHdlZW4gZG9jdW1lbnRzIGluIHRoZSBjb2xsZWN0aW9uLlxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgYWxsb3dOYXZpZ2F0ZSA9IGZhbHNlO1xuXG4gICAgLyoqIFRvZ2dsZXMgdGhlIFwiYmVmb3JlXCIgKFwiPFwiKSBidXR0b24uIFJlcXVpcmVzIGBhbGxvd05hdmlnYXRlYCB0byBiZSBlbmFibGVkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgY2FuTmF2aWdhdGVCZWZvcmUgPSB0cnVlO1xuXG4gICAgLyoqIFRvZ2dsZXMgdGhlIG5leHQgKFwiPlwiKSBidXR0b24uIFJlcXVpcmVzIGBhbGxvd05hdmlnYXRlYCB0byBiZSBlbmFibGVkLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgY2FuTmF2aWdhdGVOZXh0ID0gdHJ1ZTtcblxuICAgIC8qKiBBbGxvdyB0aGUgbGVmdCB0aGUgc2lkZWJhci4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFsbG93TGVmdFNpZGViYXIgPSBmYWxzZTtcblxuICAgIC8qKiBBbGxvdyB0aGUgcmlnaHQgc2lkZWJhci4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFsbG93UmlnaHRTaWRlYmFyID0gZmFsc2U7XG5cbiAgICAvKiogVG9nZ2xlcyBQREYgdGh1bWJuYWlscy4gKi9cbiAgICBASW5wdXQoKVxuICAgIGFsbG93VGh1bWJuYWlscyA9IHRydWU7XG5cbiAgICAvKiogVG9nZ2xlcyByaWdodCBzaWRlYmFyIHZpc2liaWxpdHkuIFJlcXVpcmVzIGBhbGxvd1JpZ2h0U2lkZWJhcmAgdG8gYmUgc2V0IHRvIGB0cnVlYC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dSaWdodFNpZGViYXIgPSBmYWxzZTtcblxuICAgIC8qKiBUb2dnbGVzIGxlZnQgc2lkZWJhciB2aXNpYmlsaXR5LiBSZXF1aXJlcyBgYWxsb3dMZWZ0U2lkZWJhcmAgdG8gYmUgc2V0IHRvIGB0cnVlYC4gKi9cbiAgICBASW5wdXQoKVxuICAgIHNob3dMZWZ0U2lkZWJhciA9IGZhbHNlO1xuXG4gICAgLyoqIFRoZSB0ZW1wbGF0ZSBmb3IgdGhlIHJpZ2h0IHNpZGViYXIuIFRoZSB0ZW1wbGF0ZSBjb250ZXh0IGNvbnRhaW5zIHRoZSBsb2FkZWQgbm9kZSBkYXRhLiAqL1xuICAgIEBJbnB1dCgpXG4gICAgc2lkZWJhclJpZ2h0VGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT4gPSBudWxsO1xuXG4gICAgLyoqIFRoZSB0ZW1wbGF0ZSBmb3IgdGhlIGxlZnQgc2lkZWJhci4gVGhlIHRlbXBsYXRlIGNvbnRleHQgY29udGFpbnMgdGhlIGxvYWRlZCBub2RlIGRhdGEuICovXG4gICAgQElucHV0KClcbiAgICBzaWRlYmFyTGVmdFRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+ID0gbnVsbDtcblxuICAgIC8qKiBUaGUgdGVtcGxhdGUgZm9yIHRoZSBwZGYgdGh1bWJuYWlscy4gKi9cbiAgICBASW5wdXQoKVxuICAgIHRodW1ibmFpbHNUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PiA9IG51bGw7XG5cbiAgICAvKiogTUlNRSB0eXBlIG9mIHRoZSBmaWxlIGNvbnRlbnQgKHdoZW4gbm90IGRldGVybWluZWQgYnkgdGhlIGZpbGVuYW1lIGV4dGVuc2lvbikuICovXG4gICAgQElucHV0KClcbiAgICBtaW1lVHlwZTogc3RyaW5nO1xuXG4gICAgLyoqIENvbnRlbnQgZmlsZW5hbWUuICovXG4gICAgQElucHV0KClcbiAgICBmaWxlTmFtZTogc3RyaW5nO1xuXG4gICAgLyoqIE51bWJlciBvZiB0aW1lcyB0aGUgVmlld2VyIHdpbGwgcmV0cnkgZmV0Y2hpbmcgY29udGVudCBSZW5kaXRpb24uXG4gICAgICogVGhlcmUgaXMgYSBkZWxheSBvZiBhdCBsZWFzdCBvbmUgc2Vjb25kIGJldHdlZW4gYXR0ZW1wdHMuXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBtYXhSZXRyaWVzID0gMzA7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHVzZXIgY2xpY2tzIHRoZSAnQmFjaycgYnV0dG9uLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIGdvQmFjayA9IG5ldyBFdmVudEVtaXR0ZXI8QmFzZUV2ZW50PGFueT4+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHVzZXIgY2xpY2tzIHRoZSAnUHJpbnQnIGJ1dHRvbi4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBwcmludCA9IG5ldyBFdmVudEVtaXR0ZXI8QmFzZUV2ZW50PGFueT4+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSB2aWV3ZXIgaXMgc2hvd24gb3IgaGlkZGVuLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHNob3dWaWV3ZXJDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPGJvb2xlYW4+KCk7XG5cbiAgICAvKiogRW1pdHRlZCB3aGVuIHRoZSBmaWxlbmFtZSBleHRlbnNpb24gY2hhbmdlcy4gKi9cbiAgICBAT3V0cHV0KClcbiAgICBleHRlbnNpb25DaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPHN0cmluZz4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gdXNlciBjbGlja3MgJ05hdmlnYXRlIEJlZm9yZScgKFwiPFwiKSBidXR0b24uICovXG4gICAgQE91dHB1dCgpXG4gICAgbmF2aWdhdGVCZWZvcmUgPSBuZXcgRXZlbnRFbWl0dGVyPE1vdXNlRXZlbnR8S2V5Ym9hcmRFdmVudD4oKTtcblxuICAgIC8qKiBFbWl0dGVkIHdoZW4gdXNlciBjbGlja3MgJ05hdmlnYXRlIE5leHQnIChcIj5cIikgYnV0dG9uLiAqL1xuICAgIEBPdXRwdXQoKVxuICAgIG5hdmlnYXRlTmV4dCA9IG5ldyBFdmVudEVtaXR0ZXI8TW91c2VFdmVudHxLZXlib2FyZEV2ZW50PigpO1xuXG4gICAgLyoqIEVtaXR0ZWQgd2hlbiB0aGUgc2hhcmVkIGxpbmsgdXNlZCBpcyBub3QgdmFsaWQuICovXG4gICAgQE91dHB1dCgpXG4gICAgaW52YWxpZFNoYXJlZExpbmsgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgICBUUllfVElNRU9VVDogbnVtYmVyID0gMTAwMDA7XG5cbiAgICB2aWV3ZXJUeXBlID0gJ3Vua25vd24nO1xuICAgIGlzTG9hZGluZyA9IGZhbHNlO1xuICAgIG5vZGVFbnRyeTogTm9kZUVudHJ5O1xuICAgIHZlcnNpb25FbnRyeTogVmVyc2lvbkVudHJ5O1xuXG4gICAgZXh0ZW5zaW9uVGVtcGxhdGVzOiB7IHRlbXBsYXRlOiBUZW1wbGF0ZVJlZjxhbnk+LCBpc1Zpc2libGU6IGJvb2xlYW4gfVtdID0gW107XG4gICAgZXh0ZXJuYWxFeHRlbnNpb25zOiBzdHJpbmdbXSA9IFtdO1xuICAgIHVybEZpbGVDb250ZW50OiBzdHJpbmc7XG4gICAgb3RoZXJNZW51OiBhbnk7XG4gICAgZXh0ZW5zaW9uOiBzdHJpbmc7XG4gICAgc2lkZWJhclJpZ2h0VGVtcGxhdGVDb250ZXh0OiB7IG5vZGU6IE5vZGUgfSA9IHsgbm9kZTogbnVsbCB9O1xuICAgIHNpZGViYXJMZWZ0VGVtcGxhdGVDb250ZXh0OiB7IG5vZGU6IE5vZGUgfSA9IHsgbm9kZTogbnVsbCB9O1xuICAgIGZpbGVUaXRsZTogc3RyaW5nO1xuICAgIHZpZXdlckV4dGVuc2lvbnM6IEFycmF5PFZpZXdlckV4dGVuc2lvblJlZj4gPSBbXTtcbiAgICByZWFkT25seSA9IHRydWU7XG5cbiAgICBwcml2YXRlIGNhY2hlQnVzdGVyTnVtYmVyO1xuICAgIGNhY2hlVHlwZUZvckNvbnRlbnQgPSAnJztcblxuICAgIC8vIEV4dGVuc2lvbnMgdGhhdCBhcmUgc3VwcG9ydGVkIGJ5IHRoZSBWaWV3ZXIgd2l0aG91dCBjb252ZXJzaW9uXG4gICAgcHJpdmF0ZSBleHRlbnNpb25zID0ge1xuICAgICAgICBpbWFnZTogWydwbmcnLCAnanBnJywgJ2pwZWcnLCAnZ2lmJywgJ2JwbScsICdzdmcnXSxcbiAgICAgICAgbWVkaWE6IFsnd2F2JywgJ21wNCcsICdtcDMnLCAnd2VibScsICdvZ2cnXSxcbiAgICAgICAgdGV4dDogWyd0eHQnLCAneG1sJywgJ2h0bWwnLCAnanNvbicsICd0cycsICdjc3MnLCAnbWQnXSxcbiAgICAgICAgcGRmOiBbJ3BkZiddXG4gICAgfTtcblxuICAgIC8vIE1pbWUgdHlwZXMgdGhhdCBhcmUgc3VwcG9ydGVkIGJ5IHRoZSBWaWV3ZXIgd2l0aG91dCBjb252ZXJzaW9uXG4gICAgcHJpdmF0ZSBtaW1lVHlwZXMgPSB7XG4gICAgICAgIHRleHQ6IFsndGV4dC9wbGFpbicsICd0ZXh0L2NzdicsICd0ZXh0L3htbCcsICd0ZXh0L2h0bWwnLCAnYXBwbGljYXRpb24veC1qYXZhc2NyaXB0J10sXG4gICAgICAgIHBkZjogWydhcHBsaWNhdGlvbi9wZGYnXSxcbiAgICAgICAgaW1hZ2U6IFsnaW1hZ2UvcG5nJywgJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvZ2lmJywgJ2ltYWdlL2JtcCcsICdpbWFnZS9zdmcreG1sJ10sXG4gICAgICAgIG1lZGlhOiBbJ3ZpZGVvL21wNCcsICd2aWRlby93ZWJtJywgJ3ZpZGVvL29nZycsICdhdWRpby9tcGVnJywgJ2F1ZGlvL21wMycsICdhdWRpby9vZ2cnLCAnYXVkaW8vd2F2J11cbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBvbkRlc3Ryb3kkID0gbmV3IFN1YmplY3Q8Ym9vbGVhbj4oKTtcbiAgICBwcml2YXRlIHNob3VsZENsb3NlVmlld2VyID0gdHJ1ZTtcbiAgICBwcml2YXRlIGtleURvd24kID0gZnJvbUV2ZW50PEtleWJvYXJkRXZlbnQ+KGRvY3VtZW50LCAna2V5ZG93bicpO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcGlTZXJ2aWNlOiBBbGZyZXNjb0FwaVNlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSB2aWV3VXRpbFNlcnZpY2U6IFZpZXdVdGlsU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGxvZ1NlcnZpY2U6IExvZ1NlcnZpY2UsXG4gICAgICAgICAgICAgICAgcHJpdmF0ZSBleHRlbnNpb25TZXJ2aWNlOiBBcHBFeHRlbnNpb25TZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgY29udGVudFNlcnZpY2U6IENvbnRlbnRTZXJ2aWNlLFxuICAgICAgICAgICAgICAgIHByaXZhdGUgdXBsb2FkU2VydmljZTogVXBsb2FkU2VydmljZSxcbiAgICAgICAgICAgICAgICBwcml2YXRlIGVsOiBFbGVtZW50UmVmLFxuICAgICAgICAgICAgICAgIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZykge1xuICAgICAgICB2aWV3VXRpbFNlcnZpY2UubWF4UmV0cmllcyA9IHRoaXMubWF4UmV0cmllcztcbiAgICB9XG5cbiAgICBpc1NvdXJjZURlZmluZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhISh0aGlzLnVybEZpbGUgfHwgdGhpcy5ibG9iRmlsZSB8fCB0aGlzLm5vZGVJZCB8fCB0aGlzLnNoYXJlZExpbmtJZCk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuYXBpU2VydmljZS5ub2RlVXBkYXRlZC5waXBlKFxuICAgICAgICAgICAgZmlsdGVyKChub2RlKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5pZCA9PT0gdGhpcy5ub2RlSWQgJiZcbiAgICAgICAgICAgICAgICAgICAgKG5vZGUubmFtZSAhPT0gdGhpcy5maWxlTmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXROb2RlVmVyc2lvblByb3BlcnR5KHRoaXMubm9kZUVudHJ5LmVudHJ5KSAhPT0gdGhpcy5nZXROb2RlVmVyc2lvblByb3BlcnR5KG5vZGUpKTtcbiAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMub25EZXN0cm95JClcbiAgICAgICAgKS5zdWJzY3JpYmUoKG5vZGUpID0+IHRoaXMub25Ob2RlVXBkYXRlZChub2RlKSk7XG5cbiAgICAgICAgdGhpcy52aWV3VXRpbFNlcnZpY2Uudmlld2VyVHlwZUNoYW5nZS5waXBlKHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpKS5zdWJzY3JpYmUoKHR5cGU6IHN0cmluZykgPT4ge1xuICAgICAgICAgICAgdGhpcy52aWV3ZXJUeXBlID0gdHlwZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52aWV3VXRpbFNlcnZpY2UudXJsRmlsZUNvbnRlbnRDaGFuZ2UucGlwZSh0YWtlVW50aWwodGhpcy5vbkRlc3Ryb3kkKSkuc3Vic2NyaWJlKChjb250ZW50OiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIHRoaXMudXJsRmlsZUNvbnRlbnQgPSBjb250ZW50O1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNsb3NlT3ZlcmxheU1hbmFnZXIoKTtcbiAgICAgICAgdGhpcy5sb2FkRXh0ZW5zaW9ucygpO1xuICAgICAgICB0aGlzLmNhY2hlVHlwZUZvckNvbnRlbnQgPSAnJztcbiAgICB9XG5cbiAgICBwcml2YXRlIGxvYWRFeHRlbnNpb25zKCkge1xuICAgICAgICB0aGlzLnZpZXdlckV4dGVuc2lvbnMgPSB0aGlzLmV4dGVuc2lvblNlcnZpY2UuZ2V0Vmlld2VyRXh0ZW5zaW9ucygpO1xuICAgICAgICB0aGlzLnZpZXdlckV4dGVuc2lvbnNcbiAgICAgICAgICAgIC5mb3JFYWNoKChleHRlbnNpb246IFZpZXdlckV4dGVuc2lvblJlZikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZXh0ZXJuYWxFeHRlbnNpb25zLnB1c2goZXh0ZW5zaW9uLmZpbGVFeHRlbnNpb24pO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXROb2RlVmVyc2lvblByb3BlcnR5KG5vZGU6IE5vZGUpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gbm9kZT8ucHJvcGVydGllc1snY206dmVyc2lvbkxhYmVsJ10gPz8gJyc7XG4gICAgfVxuXG4gICAgbmdPbkRlc3Ryb3koKSB7XG4gICAgICAgIHRoaXMub25EZXN0cm95JC5uZXh0KHRydWUpO1xuICAgICAgICB0aGlzLm9uRGVzdHJveSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uTm9kZVVwZGF0ZWQobm9kZTogTm9kZSkge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmlkID09PSB0aGlzLm5vZGVJZCkge1xuICAgICAgICAgICAgdGhpcy5jYWNoZVR5cGVGb3JDb250ZW50ID0gJ25vLWNhY2hlJztcbiAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVDYWNoZUJ1c3Rlck51bWJlcigpO1xuICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5zZXRVcE5vZGVGaWxlKG5vZGUpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nT25DaGFuZ2VzKCkge1xuICAgICAgICBpZiAodGhpcy5zaG93Vmlld2VyKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNTb3VyY2VEZWZpbmVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgY29udGVudCBzb3VyY2UgYXR0cmlidXRlIHZhbHVlIGlzIG1pc3NpbmcuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmJsb2JGaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcEJsb2JEYXRhKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy51cmxGaWxlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRVcFVybEZpbGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzTG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm5vZGVJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBpU2VydmljZS5ub2Rlc0FwaS5nZXROb2RlKHRoaXMubm9kZUlkLCB7IGluY2x1ZGU6IFsnYWxsb3dhYmxlT3BlcmF0aW9ucyddIH0pLnRoZW4oXG4gICAgICAgICAgICAgICAgICAgIChub2RlOiBOb2RlRW50cnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubm9kZUVudHJ5ID0gbm9kZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZlcnNpb25JZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBpU2VydmljZS52ZXJzaW9uc0FwaS5nZXRWZXJzaW9uKHRoaXMubm9kZUlkLCB0aGlzLnZlcnNpb25JZCkudGhlbihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHZlcnNpb246IFZlcnNpb25FbnRyeSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52ZXJzaW9uRW50cnkgPSB2ZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXRVcE5vZGVGaWxlKG5vZGUuZW50cnksIHZlcnNpb24uZW50cnkpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VXBOb2RlRmlsZShub2RlLmVudHJ5KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nU2VydmljZS5lcnJvcignVGhpcyBub2RlIGRvZXMgbm90IGV4aXN0Jyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNoYXJlZExpbmtJZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWxsb3dHb0JhY2sgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYXBpU2VydmljZS5zaGFyZWRMaW5rc0FwaS5nZXRTaGFyZWRMaW5rKHRoaXMuc2hhcmVkTGlua0lkKS50aGVuKFxuICAgICAgICAgICAgICAgICAgICAoc2hhcmVkTGlua0VudHJ5OiBTaGFyZWRMaW5rRW50cnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0VXBTaGFyZWRMaW5rRmlsZShzaGFyZWRMaW5rRW50cnkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubG9nU2VydmljZS5lcnJvcignVGhpcyBzaGFyZWRMaW5rIGRvZXMgbm90IGV4aXN0Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWRTaGFyZWRMaW5rLm5leHQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFVwQmxvYkRhdGEoKSB7XG4gICAgICAgIHRoaXMuZmlsZVRpdGxlID0gdGhpcy5nZXREaXNwbGF5TmFtZSgnVW5rbm93bicpO1xuICAgICAgICB0aGlzLm1pbWVUeXBlID0gdGhpcy5ibG9iRmlsZS50eXBlO1xuICAgICAgICB0aGlzLnZpZXdlclR5cGUgPSB0aGlzLmdldFZpZXdlclR5cGVCeU1pbWVUeXBlKHRoaXMubWltZVR5cGUpO1xuXG4gICAgICAgIHRoaXMuYWxsb3dEb3dubG9hZCA9IGZhbHNlO1xuICAgICAgICAvLyBUT0RPOiB3cmFwIGJsb2IgaW50byB0aGUgZGF0YSB1cmwgYW5kIGFsbG93IGRvd25sb2FkaW5nXG5cbiAgICAgICAgdGhpcy5leHRlbnNpb25DaGFuZ2UuZW1pdCh0aGlzLm1pbWVUeXBlKTtcbiAgICAgICAgdGhpcy5zY3JvbGxUb3AoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHNldFVwVXJsRmlsZSgpIHtcbiAgICAgICAgY29uc3QgZmlsZW5hbWVGcm9tVXJsID0gdGhpcy5nZXRGaWxlbmFtZUZyb21VcmwodGhpcy51cmxGaWxlKTtcbiAgICAgICAgdGhpcy5maWxlVGl0bGUgPSB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGVuYW1lRnJvbVVybCk7XG4gICAgICAgIHRoaXMuZXh0ZW5zaW9uID0gdGhpcy5nZXRGaWxlRXh0ZW5zaW9uKGZpbGVuYW1lRnJvbVVybCk7XG4gICAgICAgIHRoaXMudXJsRmlsZUNvbnRlbnQgPSB0aGlzLnVybEZpbGU7XG5cbiAgICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuZGlzcGxheU5hbWU7XG5cbiAgICAgICAgdGhpcy52aWV3ZXJUeXBlID0gdGhpcy51cmxGaWxlVmlld2VyIHx8IHRoaXMuZ2V0Vmlld2VyVHlwZUJ5RXh0ZW5zaW9uKHRoaXMuZXh0ZW5zaW9uKTtcbiAgICAgICAgaWYgKHRoaXMudmlld2VyVHlwZSA9PT0gJ3Vua25vd24nKSB7XG4gICAgICAgICAgICB0aGlzLnZpZXdlclR5cGUgPSB0aGlzLmdldFZpZXdlclR5cGVCeU1pbWVUeXBlKHRoaXMubWltZVR5cGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5leHRlbnNpb25DaGFuZ2UuZW1pdCh0aGlzLmV4dGVuc2lvbik7XG4gICAgICAgIHRoaXMuc2Nyb2xsVG9wKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhc3luYyBzZXRVcE5vZGVGaWxlKG5vZGVEYXRhOiBOb2RlLCB2ZXJzaW9uRGF0YT86IFZlcnNpb24pIHtcbiAgICAgICAgdGhpcy5yZWFkT25seSA9ICF0aGlzLmNvbnRlbnRTZXJ2aWNlLmhhc0FsbG93YWJsZU9wZXJhdGlvbnMobm9kZURhdGEsICd1cGRhdGUnKTtcblxuICAgICAgICBsZXQgc2V0dXBOb2RlO1xuXG4gICAgICAgIGlmICh2ZXJzaW9uRGF0YSAmJiB2ZXJzaW9uRGF0YS5jb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLm1pbWVUeXBlID0gdmVyc2lvbkRhdGEuY29udGVudC5taW1lVHlwZTtcbiAgICAgICAgfSBlbHNlIGlmIChub2RlRGF0YS5jb250ZW50KSB7XG4gICAgICAgICAgICB0aGlzLm1pbWVUeXBlID0gbm9kZURhdGEuY29udGVudC5taW1lVHlwZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZmlsZVRpdGxlID0gdGhpcy5nZXREaXNwbGF5TmFtZSh2ZXJzaW9uRGF0YSA/IHZlcnNpb25EYXRhLm5hbWUgOiBub2RlRGF0YS5uYW1lKTtcblxuICAgICAgICBjb25zdCBjdXJyZW50RmlsZVZlcnNpb24gPSB0aGlzLm5vZGVFbnRyeT8uZW50cnk/LnByb3BlcnRpZXMgJiYgdGhpcy5ub2RlRW50cnkuZW50cnkucHJvcGVydGllc1snY206dmVyc2lvbkxhYmVsJ10gP1xuICAgICAgICAgICAgZW5jb2RlVVJJKHRoaXMubm9kZUVudHJ5Py5lbnRyeT8ucHJvcGVydGllc1snY206dmVyc2lvbkxhYmVsJ10pIDogZW5jb2RlVVJJKCcxLjAnKTtcblxuICAgICAgICB0aGlzLnVybEZpbGVDb250ZW50ID0gdmVyc2lvbkRhdGEgPyB0aGlzLmFwaVNlcnZpY2UuY29udGVudEFwaS5nZXRWZXJzaW9uQ29udGVudFVybCh0aGlzLm5vZGVJZCwgdmVyc2lvbkRhdGEuaWQpIDpcbiAgICAgICAgICAgIHRoaXMuYXBpU2VydmljZS5jb250ZW50QXBpLmdldENvbnRlbnRVcmwodGhpcy5ub2RlSWQpO1xuICAgICAgICB0aGlzLnVybEZpbGVDb250ZW50ID0gdGhpcy5jYWNoZUJ1c3Rlck51bWJlciA/IHRoaXMudXJsRmlsZUNvbnRlbnQgKyAnJicgKyBjdXJyZW50RmlsZVZlcnNpb24gKyAnJicgKyB0aGlzLmNhY2hlQnVzdGVyTnVtYmVyIDpcbiAgICAgICAgICAgIHRoaXMudXJsRmlsZUNvbnRlbnQgKyAnJicgKyBjdXJyZW50RmlsZVZlcnNpb247XG5cbiAgICAgICAgdGhpcy5leHRlbnNpb24gPSB0aGlzLmdldEZpbGVFeHRlbnNpb24odmVyc2lvbkRhdGEgPyB2ZXJzaW9uRGF0YS5uYW1lIDogbm9kZURhdGEubmFtZSk7XG5cbiAgICAgICAgdGhpcy5maWxlTmFtZSA9IHZlcnNpb25EYXRhID8gdmVyc2lvbkRhdGEubmFtZSA6IG5vZGVEYXRhLm5hbWU7XG5cbiAgICAgICAgdGhpcy52aWV3ZXJUeXBlID0gdGhpcy5nZXRWaWV3ZXJUeXBlQnlFeHRlbnNpb24odGhpcy5leHRlbnNpb24pO1xuICAgICAgICBpZiAodGhpcy52aWV3ZXJUeXBlID09PSAndW5rbm93bicpIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyVHlwZSA9IHRoaXMuZ2V0Vmlld2VyVHlwZUJ5TWltZVR5cGUodGhpcy5taW1lVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy52aWV3ZXJUeXBlID09PSAndW5rbm93bicpIHtcbiAgICAgICAgICAgIGlmICh2ZXJzaW9uRGF0YSkge1xuICAgICAgICAgICAgICAgIHNldHVwTm9kZSA9IHRoaXMudmlld1V0aWxTZXJ2aWNlLmRpc3BsYXlOb2RlUmVuZGl0aW9uKG5vZGVEYXRhLmlkLCB2ZXJzaW9uRGF0YS5pZCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNldHVwTm9kZSA9IHRoaXMudmlld1V0aWxTZXJ2aWNlLmRpc3BsYXlOb2RlUmVuZGl0aW9uKG5vZGVEYXRhLmlkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZXh0ZW5zaW9uQ2hhbmdlLmVtaXQodGhpcy5leHRlbnNpb24pO1xuICAgICAgICB0aGlzLnNpZGViYXJSaWdodFRlbXBsYXRlQ29udGV4dC5ub2RlID0gbm9kZURhdGE7XG4gICAgICAgIHRoaXMuc2lkZWJhckxlZnRUZW1wbGF0ZUNvbnRleHQubm9kZSA9IG5vZGVEYXRhO1xuICAgICAgICB0aGlzLnNjcm9sbFRvcCgpO1xuXG4gICAgICAgIHJldHVybiBzZXR1cE5vZGU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzZXRVcFNoYXJlZExpbmtGaWxlKGRldGFpbHM6IGFueSkge1xuICAgICAgICB0aGlzLm1pbWVUeXBlID0gZGV0YWlscy5lbnRyeS5jb250ZW50Lm1pbWVUeXBlO1xuICAgICAgICB0aGlzLmZpbGVUaXRsZSA9IHRoaXMuZ2V0RGlzcGxheU5hbWUoZGV0YWlscy5lbnRyeS5uYW1lKTtcbiAgICAgICAgdGhpcy5leHRlbnNpb24gPSB0aGlzLmdldEZpbGVFeHRlbnNpb24oZGV0YWlscy5lbnRyeS5uYW1lKTtcbiAgICAgICAgdGhpcy5maWxlTmFtZSA9IGRldGFpbHMuZW50cnkubmFtZTtcblxuICAgICAgICB0aGlzLnVybEZpbGVDb250ZW50ID0gdGhpcy5hcGlTZXJ2aWNlLmNvbnRlbnRBcGkuZ2V0U2hhcmVkTGlua0NvbnRlbnRVcmwodGhpcy5zaGFyZWRMaW5rSWQsIGZhbHNlKTtcblxuICAgICAgICB0aGlzLnZpZXdlclR5cGUgPSB0aGlzLmdldFZpZXdlclR5cGVCeU1pbWVUeXBlKHRoaXMubWltZVR5cGUpO1xuICAgICAgICBpZiAodGhpcy52aWV3ZXJUeXBlID09PSAndW5rbm93bicpIHtcbiAgICAgICAgICAgIHRoaXMudmlld2VyVHlwZSA9IHRoaXMuZ2V0Vmlld2VyVHlwZUJ5RXh0ZW5zaW9uKHRoaXMuZXh0ZW5zaW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLnZpZXdlclR5cGUgPT09ICd1bmtub3duJykge1xuICAgICAgICAgICAgdGhpcy5kaXNwbGF5U2hhcmVkTGlua1JlbmRpdGlvbih0aGlzLnNoYXJlZExpbmtJZCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmV4dGVuc2lvbkNoYW5nZS5lbWl0KHRoaXMuZXh0ZW5zaW9uKTtcbiAgICB9XG5cbiAgICB0b2dnbGVTaWRlYmFyKCkge1xuICAgICAgICB0aGlzLnNob3dSaWdodFNpZGViYXIgPSAhdGhpcy5zaG93UmlnaHRTaWRlYmFyO1xuICAgICAgICBpZiAodGhpcy5zaG93UmlnaHRTaWRlYmFyICYmIHRoaXMubm9kZUlkKSB7XG4gICAgICAgICAgICB0aGlzLmFwaVNlcnZpY2UuZ2V0SW5zdGFuY2UoKS5ub2Rlcy5nZXROb2RlKHRoaXMubm9kZUlkLCB7IGluY2x1ZGU6IFsnYWxsb3dhYmxlT3BlcmF0aW9ucyddIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oKG5vZGVFbnRyeTogTm9kZUVudHJ5KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2lkZWJhclJpZ2h0VGVtcGxhdGVDb250ZXh0Lm5vZGUgPSBub2RlRW50cnkuZW50cnk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2dnbGVMZWZ0U2lkZWJhcigpIHtcbiAgICAgICAgdGhpcy5zaG93TGVmdFNpZGViYXIgPSAhdGhpcy5zaG93TGVmdFNpZGViYXI7XG4gICAgICAgIGlmICh0aGlzLnNob3dSaWdodFNpZGViYXIgJiYgdGhpcy5ub2RlSWQpIHtcbiAgICAgICAgICAgIHRoaXMuYXBpU2VydmljZS5nZXRJbnN0YW5jZSgpLm5vZGVzLmdldE5vZGUodGhpcy5ub2RlSWQsIHsgaW5jbHVkZTogWydhbGxvd2FibGVPcGVyYXRpb25zJ10gfSlcbiAgICAgICAgICAgICAgICAudGhlbigobm9kZUVudHJ5OiBOb2RlRW50cnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zaWRlYmFyTGVmdFRlbXBsYXRlQ29udGV4dC5ub2RlID0gbm9kZUVudHJ5LmVudHJ5O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXREaXNwbGF5TmFtZShuYW1lKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpc3BsYXlOYW1lIHx8IG5hbWU7XG4gICAgfVxuXG4gICAgc2Nyb2xsVG9wKCkge1xuICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMSk7XG4gICAgfVxuXG4gICAgZ2V0Vmlld2VyVHlwZUJ5TWltZVR5cGUobWltZVR5cGU6IHN0cmluZykge1xuICAgICAgICBpZiAobWltZVR5cGUpIHtcbiAgICAgICAgICAgIG1pbWVUeXBlID0gbWltZVR5cGUudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgY29uc3QgZWRpdG9yVHlwZXMgPSBPYmplY3Qua2V5cyh0aGlzLm1pbWVUeXBlcyk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHR5cGUgb2YgZWRpdG9yVHlwZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5taW1lVHlwZXNbdHlwZV0uaW5kZXhPZihtaW1lVHlwZSkgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICd1bmtub3duJztcbiAgICB9XG5cbiAgICBnZXRWaWV3ZXJUeXBlQnlFeHRlbnNpb24oZXh0ZW5zaW9uOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKGV4dGVuc2lvbikge1xuICAgICAgICAgICAgZXh0ZW5zaW9uID0gZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pc0N1c3RvbVZpZXdlckV4dGVuc2lvbihleHRlbnNpb24pKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2N1c3RvbSc7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5leHRlbnNpb25zLmltYWdlLmluZGV4T2YoZXh0ZW5zaW9uKSA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJ2ltYWdlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmV4dGVuc2lvbnMubWVkaWEuaW5kZXhPZihleHRlbnNpb24pID49IDApIHtcbiAgICAgICAgICAgIHJldHVybiAnbWVkaWEnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucy50ZXh0LmluZGV4T2YoZXh0ZW5zaW9uKSA+PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3RleHQnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZXh0ZW5zaW9ucy5wZGYuaW5kZXhPZihleHRlbnNpb24pID49IDApIHtcbiAgICAgICAgICAgIHJldHVybiAncGRmJztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAndW5rbm93bic7XG4gICAgfVxuXG4gICAgb25CYWNrQnV0dG9uQ2xpY2soKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG5cbiAgICBvbk5hdmlnYXRlQmVmb3JlQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnR8S2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB0aGlzLm5hdmlnYXRlQmVmb3JlLm5leHQoZXZlbnQpO1xuICAgIH1cblxuICAgIG9uTmF2aWdhdGVOZXh0Q2xpY2soZXZlbnQ6IE1vdXNlRXZlbnR8S2V5Ym9hcmRFdmVudCkge1xuICAgICAgICB0aGlzLm5hdmlnYXRlTmV4dC5uZXh0KGV2ZW50KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjbG9zZSB0aGUgdmlld2VyXG4gICAgICovXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLm90aGVyTWVudSkge1xuICAgICAgICAgICAgdGhpcy5vdGhlck1lbnUuaGlkZGVuID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zaG93Vmlld2VyID0gZmFsc2U7XG4gICAgICAgIHRoaXMuc2hvd1ZpZXdlckNoYW5nZS5lbWl0KHRoaXMuc2hvd1ZpZXdlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZ2V0IEZpbGUgbmFtZSBmcm9tIHVybFxuICAgICAqXG4gICAgICogQHBhcmFtICB1cmwgLSB1cmwgZmlsZVxuICAgICAqL1xuICAgIGdldEZpbGVuYW1lRnJvbVVybCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGFuY2hvciA9IHVybC5pbmRleE9mKCcjJyk7XG4gICAgICAgIGNvbnN0IHF1ZXJ5ID0gdXJsLmluZGV4T2YoJz8nKTtcbiAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4oXG4gICAgICAgICAgICBhbmNob3IgPiAwID8gYW5jaG9yIDogdXJsLmxlbmd0aCxcbiAgICAgICAgICAgIHF1ZXJ5ID4gMCA/IHF1ZXJ5IDogdXJsLmxlbmd0aCk7XG4gICAgICAgIHJldHVybiB1cmwuc3Vic3RyaW5nKHVybC5sYXN0SW5kZXhPZignLycsIGVuZCkgKyAxLCBlbmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldCBmaWxlIGV4dGVuc2lvbiBmcm9tIHRoZSBzdHJpbmcuXG4gICAgICogU3VwcG9ydHMgdGhlIFVSTCBmb3JtYXRzIGxpa2U6XG4gICAgICogaHR0cDovL2xvY2FsaG9zdC90ZXN0LmpwZz9jYWNoZT0xMDAwXG4gICAgICogaHR0cDovL2xvY2FsaG9zdC90ZXN0LmpwZyNjYWNoZT0xMDAwXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmlsZU5hbWUgLSBmaWxlIG5hbWVcbiAgICAgKi9cbiAgICBnZXRGaWxlRXh0ZW5zaW9uKGZpbGVOYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBpZiAoZmlsZU5hbWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gZmlsZU5hbWUubWF0Y2goL1xcLihbXlxcLi9cXD9cXCNdKykoJHxcXD98XFwjKS8pO1xuICAgICAgICAgICAgcmV0dXJuIG1hdGNoID8gbWF0Y2hbMV0gOiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlzQ3VzdG9tVmlld2VyRXh0ZW5zaW9uKGV4dGVuc2lvbjogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGV4dGVuc2lvbnM6IGFueSA9IHRoaXMuZXh0ZXJuYWxFeHRlbnNpb25zIHx8IFtdO1xuXG4gICAgICAgIGlmIChleHRlbnNpb24gJiYgZXh0ZW5zaW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBleHRlbnNpb24gPSBleHRlbnNpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIHJldHVybiBleHRlbnNpb25zLmZsYXQoKS5pbmRleE9mKGV4dGVuc2lvbikgPj0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBLZXlib2FyZCBldmVudCBsaXN0ZW5lclxuICAgICAqIEBwYXJhbSAgZXZlbnRcbiAgICAgKi9cbiAgICBASG9zdExpc3RlbmVyKCdkb2N1bWVudDprZXl1cCcsIFsnJGV2ZW50J10pXG4gICAgaGFuZGxlS2V5Ym9hcmRFdmVudChldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBpZiAoZXZlbnQgJiYgZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qga2V5ID0gZXZlbnQua2V5Q29kZTtcblxuICAgICAgICAvLyBMZWZ0IGFycm93XG4gICAgICAgIGlmIChrZXkgPT09IDM3ICYmIHRoaXMuY2FuTmF2aWdhdGVCZWZvcmUpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLm9uTmF2aWdhdGVCZWZvcmVDbGljayhldmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSaWdodCBhcnJvd1xuICAgICAgICBpZiAoa2V5ID09PSAzOSAmJiB0aGlzLmNhbk5hdmlnYXRlTmV4dCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMub25OYXZpZ2F0ZU5leHRDbGljayhldmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDdHJsK0ZcbiAgICAgICAgaWYgKGtleSA9PT0gNzAgJiYgZXZlbnQuY3RybEtleSkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuZW50ZXJGdWxsU2NyZWVuKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcmludENvbnRlbnQoKSB7XG4gICAgICAgIGlmICh0aGlzLmFsbG93UHJpbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IGFyZ3MgPSBuZXcgQmFzZUV2ZW50KCk7XG4gICAgICAgICAgICB0aGlzLnByaW50Lm5leHQoYXJncyk7XG5cbiAgICAgICAgICAgIGlmICghYXJncy5kZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52aWV3VXRpbFNlcnZpY2UucHJpbnRGaWxlR2VuZXJpYyh0aGlzLm5vZGVJZCwgdGhpcy5taW1lVHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VycyBmdWxsIHNjcmVlbiBtb2RlIHdpdGggYSBtYWluIGNvbnRlbnQgYXJlYSBkaXNwbGF5ZWQuXG4gICAgICovXG4gICAgZW50ZXJGdWxsU2NyZWVuKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5hbGxvd0Z1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZWwubmF0aXZlRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuYWRmLXZpZXdlcl9fZnVsbHNjcmVlbi1jb250YWluZXInKTtcbiAgICAgICAgICAgIGlmIChjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoY29udGFpbmVyLnJlcXVlc3RGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5yZXF1ZXN0RnVsbHNjcmVlbigpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci53ZWJraXRSZXF1ZXN0RnVsbHNjcmVlbigpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLm1velJlcXVlc3RGdWxsU2NyZWVuKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5tb3pSZXF1ZXN0RnVsbFNjcmVlbigpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY29udGFpbmVyLm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLm1zUmVxdWVzdEZ1bGxzY3JlZW4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGRpc3BsYXlTaGFyZWRMaW5rUmVuZGl0aW9uKHNoYXJlZElkOiBzdHJpbmcpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRpdGlvbjogUmVuZGl0aW9uRW50cnkgPSBhd2FpdCB0aGlzLmFwaVNlcnZpY2UucmVuZGl0aW9uc0FwaS5nZXRTaGFyZWRMaW5rUmVuZGl0aW9uKHNoYXJlZElkLCAncGRmJyk7XG4gICAgICAgICAgICBpZiAocmVuZGl0aW9uLmVudHJ5LnN0YXR1cy50b1N0cmluZygpID09PSAnQ1JFQVRFRCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZpZXdlclR5cGUgPSAncGRmJztcbiAgICAgICAgICAgICAgICB0aGlzLnVybEZpbGVDb250ZW50ID0gdGhpcy5hcGlTZXJ2aWNlLmNvbnRlbnRBcGkuZ2V0U2hhcmVkTGlua1JlbmRpdGlvblVybChzaGFyZWRJZCwgJ3BkZicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5sb2dTZXJ2aWNlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGl0aW9uOiBSZW5kaXRpb25FbnRyeSA9IGF3YWl0IHRoaXMuYXBpU2VydmljZS5yZW5kaXRpb25zQXBpLmdldFNoYXJlZExpbmtSZW5kaXRpb24oc2hhcmVkSWQsICdpbWdwcmV2aWV3Jyk7XG4gICAgICAgICAgICAgICAgaWYgKHJlbmRpdGlvbi5lbnRyeS5zdGF0dXMudG9TdHJpbmcoKSA9PT0gJ0NSRUFURUQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudmlld2VyVHlwZSA9ICdpbWFnZSc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudXJsRmlsZUNvbnRlbnQgPSB0aGlzLmFwaVNlcnZpY2UuY29udGVudEFwaS5nZXRTaGFyZWRMaW5rUmVuZGl0aW9uVXJsKHNoYXJlZElkLCAnaW1ncHJldmlldycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5sb2dTZXJ2aWNlLmVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGNoZWNrRXh0ZW5zaW9ucyhleHRlbnNpb25BbGxvd2VkKSB7XG4gICAgICAgIGlmICh0eXBlb2YgZXh0ZW5zaW9uQWxsb3dlZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpID09PSBleHRlbnNpb25BbGxvd2VkLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZXh0ZW5zaW9uQWxsb3dlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gZXh0ZW5zaW9uQWxsb3dlZC5maW5kKChjdXJyZW50RXh0ZW5zaW9uKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkgPT09IGN1cnJlbnRFeHRlbnNpb24udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBvblN1Ym1pdEZpbGUobmV3SW1hZ2VCbG9iOiBCbG9iKSB7XG4gICAgICAgIGlmICh0aGlzPy5ub2RlRW50cnk/LmVudHJ5Py5pZCAmJiAhdGhpcy5yZWFkT25seSkge1xuICAgICAgICAgICAgY29uc3QgbmV3SW1hZ2VGaWxlOiBGaWxlID0gbmV3IEZpbGUoW25ld0ltYWdlQmxvYl0sIHRoaXM/Lm5vZGVFbnRyeT8uZW50cnk/Lm5hbWUsIHsgdHlwZTogdGhpcz8ubm9kZUVudHJ5Py5lbnRyeT8uY29udGVudD8ubWltZVR5cGUgfSk7XG4gICAgICAgICAgICBjb25zdCBuZXdGaWxlID0gbmV3IEZpbGVNb2RlbChcbiAgICAgICAgICAgICAgICBuZXdJbWFnZUZpbGUsXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBtYWpvclZlcnNpb246IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBuZXdWZXJzaW9uOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRJZDogdGhpcz8ubm9kZUVudHJ5Py5lbnRyeT8ucGFyZW50SWQsXG4gICAgICAgICAgICAgICAgICAgIG5vZGVUeXBlOiB0aGlzPy5ub2RlRW50cnk/LmVudHJ5Py5jb250ZW50Py5taW1lVHlwZVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgdGhpcz8ubm9kZUVudHJ5Py5lbnRyeT8uaWRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnVwbG9hZFNlcnZpY2UuYWRkVG9RdWV1ZSguLi5bbmV3RmlsZV0pO1xuICAgICAgICAgICAgdGhpcy51cGxvYWRTZXJ2aWNlLnVwbG9hZEZpbGVzSW5UaGVRdWV1ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25VbnN1cHBvcnRlZEZpbGUoKSB7XG4gICAgICAgIHRoaXMudmlld2VyVHlwZSA9ICd1bmtub3duJztcbiAgICB9XG5cbiAgICBwcml2YXRlIGNsb3NlT3ZlcmxheU1hbmFnZXIoKSB7XG4gICAgICAgIHRoaXMuZGlhbG9nLmFmdGVyT3BlbmVkLnBpcGUoXG4gICAgICAgICAgICBza2lwV2hpbGUoKCkgPT4gIXRoaXMub3ZlcmxheU1vZGUpLFxuICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMub25EZXN0cm95JClcbiAgICAgICAgKS5zdWJzY3JpYmUoKCkgPT4gdGhpcy5zaG91bGRDbG9zZVZpZXdlciA9IGZhbHNlKTtcblxuICAgICAgICB0aGlzLmRpYWxvZy5hZnRlckFsbENsb3NlZC5waXBlKFxuICAgICAgICAgICAgc2tpcFdoaWxlKCgpID0+ICF0aGlzLm92ZXJsYXlNb2RlKSxcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgICkuc3Vic2NyaWJlKCgpID0+IHRoaXMuc2hvdWxkQ2xvc2VWaWV3ZXIgPSB0cnVlKTtcblxuICAgICAgICB0aGlzLmtleURvd24kLnBpcGUoXG4gICAgICAgICAgICBza2lwV2hpbGUoKCkgPT4gIXRoaXMub3ZlcmxheU1vZGUpLFxuICAgICAgICAgICAgZmlsdGVyKChlOiBLZXlib2FyZEV2ZW50KSA9PiBlLmtleUNvZGUgPT09IDI3KSxcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLm9uRGVzdHJveSQpXG4gICAgICAgICkuc3Vic2NyaWJlKCAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZENsb3NlVmlld2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdlbmVyYXRlQ2FjaGVCdXN0ZXJOdW1iZXIoKSB7XG4gICAgICAgIHRoaXMuY2FjaGVCdXN0ZXJOdW1iZXIgPSBEYXRlLm5vdygpO1xuICAgIH1cbn1cbiJdfQ==
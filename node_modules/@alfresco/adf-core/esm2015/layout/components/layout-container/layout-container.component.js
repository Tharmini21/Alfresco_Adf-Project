/*!
 * @license
 * Copyright 2019 Alfresco Software, Ltd.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import { Component, Input, ViewChild, ViewEncapsulation } from '@angular/core';
import { MatSidenav } from '@angular/material/sidenav';
import { sidenavAnimation, contentAnimation } from '../../helpers/animations';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/material/sidenav';
import * as ɵngcc2 from '@angular/common';

const _c0 = [[["", "app-layout-navigation", ""]], [["", "app-layout-content", ""]]];
const _c1 = function (a0) { return { "adf-sidenav--hidden": a0 }; };
const _c2 = ["[app-layout-navigation]", "[app-layout-content]"];
export class LayoutContainerComponent {
    constructor() {
        this.hideSidenav = false;
        this.expandedSidenav = true;
        this.position = 'start';
        this.direction = 'ltr';
        this.SIDENAV_STATES = { MOBILE: {}, EXPANDED: {}, COMPACT: {} };
        this.CONTENT_STATES = { MOBILE: {}, EXPANDED: {}, COMPACT: {} };
        this.onMediaQueryChange = this.onMediaQueryChange.bind(this);
    }
    ngOnInit() {
        this.SIDENAV_STATES.MOBILE = { value: 'expanded', params: { width: this.sidenavMax } };
        this.SIDENAV_STATES.EXPANDED = { value: 'expanded', params: { width: this.sidenavMax } };
        this.SIDENAV_STATES.COMPACT = { value: 'compact', params: { width: this.sidenavMin } };
        this.CONTENT_STATES.MOBILE = { value: 'expanded' };
        this.mediaQueryList.addListener(this.onMediaQueryChange);
        if (this.isMobileScreenSize) {
            this.sidenavAnimationState = this.SIDENAV_STATES.MOBILE;
            this.contentAnimationState = this.CONTENT_STATES.MOBILE;
        }
        else if (this.expandedSidenav) {
            this.sidenavAnimationState = this.SIDENAV_STATES.EXPANDED;
            this.contentAnimationState = this.toggledContentAnimation;
        }
        else {
            this.sidenavAnimationState = this.SIDENAV_STATES.COMPACT;
            this.contentAnimationState = this.toggledContentAnimation;
        }
    }
    ngOnDestroy() {
        this.mediaQueryList.removeListener(this.onMediaQueryChange);
    }
    ngOnChanges(changes) {
        if (changes && changes.direction) {
            this.contentAnimationState = this.toggledContentAnimation;
        }
    }
    toggleMenu() {
        if (this.isMobileScreenSize) {
            this.sidenav.toggle();
        }
        else {
            this.sidenavAnimationState = this.toggledSidenavAnimation;
            this.contentAnimationState = this.toggledContentAnimation;
        }
    }
    get isMobileScreenSize() {
        return this.mediaQueryList.matches;
    }
    getContentAnimationState() {
        return this.contentAnimationState;
    }
    get toggledSidenavAnimation() {
        return this.sidenavAnimationState === this.SIDENAV_STATES.EXPANDED
            ? this.SIDENAV_STATES.COMPACT
            : this.SIDENAV_STATES.EXPANDED;
    }
    get toggledContentAnimation() {
        if (this.isMobileScreenSize) {
            return this.CONTENT_STATES.MOBILE;
        }
        if (this.sidenavAnimationState === this.SIDENAV_STATES.EXPANDED) {
            if (this.position === 'start' && this.direction === 'ltr') {
                return { value: 'compact', params: { 'margin-left': this.sidenavMax } };
            }
            if (this.position === 'start' && this.direction === 'rtl') {
                return { value: 'compact', params: { 'margin-right': this.sidenavMax } };
            }
            if (this.position === 'end' && this.direction === 'ltr') {
                return { value: 'compact', params: { 'margin-right': this.sidenavMax } };
            }
            if (this.position === 'end' && this.direction === 'rtl') {
                return { value: 'compact', params: { 'margin-left': this.sidenavMax } };
            }
        }
        else {
            if (this.position === 'start' && this.direction === 'ltr') {
                return { value: 'expanded', params: { 'margin-left': this.sidenavMin } };
            }
            if (this.position === 'start' && this.direction === 'rtl') {
                return { value: 'expanded', params: { 'margin-right': this.sidenavMin } };
            }
            if (this.position === 'end' && this.direction === 'ltr') {
                return { value: 'expanded', params: { 'margin-right': this.sidenavMin } };
            }
            if (this.position === 'end' && this.direction === 'rtl') {
                return { value: 'expanded', params: { 'margin-left': this.sidenavMin } };
            }
        }
    }
    onMediaQueryChange() {
        this.sidenavAnimationState = this.SIDENAV_STATES.EXPANDED;
        this.contentAnimationState = this.toggledContentAnimation;
    }
}
LayoutContainerComponent.ɵfac = function LayoutContainerComponent_Factory(t) { return new (t || LayoutContainerComponent)(); };
LayoutContainerComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: LayoutContainerComponent, selectors: [["adf-layout-container"]], viewQuery: function LayoutContainerComponent_Query(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵstaticViewQuery(MatSidenav, true);
    } if (rf & 2) {
        var _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.sidenav = _t.first);
    } }, inputs: { hideSidenav: "hideSidenav", expandedSidenav: "expandedSidenav", position: "position", direction: "direction", sidenavMin: "sidenavMin", sidenavMax: "sidenavMax", mediaQueryList: "mediaQueryList" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], ngContentSelectors: _c2, decls: 6, vars: 9, consts: [[3, "position", "disableClose", "ngClass", "opened", "mode"], [1, "adf-container-full-width"]], template: function LayoutContainerComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵprojectionDef(_c0);
        ɵngcc0.ɵɵelementStart(0, "mat-sidenav-container");
        ɵngcc0.ɵɵelementStart(1, "mat-sidenav", 0);
        ɵngcc0.ɵɵprojection(2, 0, ["sidenav", ""]);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementStart(3, "div");
        ɵngcc0.ɵɵelementStart(4, "div", 1);
        ɵngcc0.ɵɵprojection(5, 1);
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("position", ctx.position)("disableClose", !ctx.isMobileScreenSize)("ngClass", ɵngcc0.ɵɵpureFunction1(7, _c1, ctx.hideSidenav))("@sidenavAnimation", ctx.sidenavAnimationState)("opened", !ctx.isMobileScreenSize)("mode", ctx.isMobileScreenSize ? "over" : "side");
        ɵngcc0.ɵɵadvance(3);
        ɵngcc0.ɵɵproperty("@contentAnimationLeft", ctx.getContentAnimationState());
    } }, directives: [ɵngcc1.MatSidenavContainer, ɵngcc1.MatSidenav, ɵngcc2.NgClass], encapsulation: 2, data: { animation: [sidenavAnimation, contentAnimation] } });
LayoutContainerComponent.ctorParameters = () => [];
LayoutContainerComponent.propDecorators = {
    sidenavMin: [{ type: Input }],
    sidenavMax: [{ type: Input }],
    mediaQueryList: [{ type: Input }],
    hideSidenav: [{ type: Input }],
    expandedSidenav: [{ type: Input }],
    position: [{ type: Input }],
    direction: [{ type: Input }],
    sidenav: [{ type: ViewChild, args: [MatSidenav, { static: true },] }]
};
/*@__PURE__*/ (function () { ɵngcc0.ɵsetClassMetadata(LayoutContainerComponent, [{
        type: Component,
        args: [{
                selector: 'adf-layout-container',
                template: "<mat-sidenav-container>\n    <mat-sidenav\n        [position]=\"position\"\n        [disableClose]=\"!isMobileScreenSize\"\n        [ngClass]=\"{ 'adf-sidenav--hidden': hideSidenav }\"\n        [@sidenavAnimation]=\"sidenavAnimationState\"\n        [opened]=\"!isMobileScreenSize\"\n        [mode]=\"isMobileScreenSize ? 'over' : 'side'\">\n        <ng-content sidenav select=\"[app-layout-navigation]\"></ng-content>\n    </mat-sidenav>\n\n    <div>\n        <div class=\"adf-container-full-width\" [@contentAnimationLeft]=\"getContentAnimationState()\">\n            <ng-content select=\"[app-layout-content]\"></ng-content>\n        </div>\n    </div>\n</mat-sidenav-container>\n",
                encapsulation: ViewEncapsulation.None,
                animations: [sidenavAnimation, contentAnimation]
            }]
    }], function () { return []; }, { hideSidenav: [{
            type: Input
        }], expandedSidenav: [{
            type: Input
        }], position: [{
            type: Input
        }], direction: [{
            type: Input
        }], sidenavMin: [{
            type: Input
        }], sidenavMax: [{
            type: Input
        }], mediaQueryList: [{
            type: Input
        }], sidenav: [{
            type: ViewChild,
            args: [MatSidenav, { static: true }]
        }] }); })();

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5b3V0LWNvbnRhaW5lci5jb21wb25lbnQuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uLy4uL2hvbWUvdHJhdmlzL2J1aWxkL0FsZnJlc2NvL2FsZnJlc2NvLW5nMi1jb21wb25lbnRzL2xpYi9jb3JlL2xheW91dC9jb21wb25lbnRzL2xheW91dC1jb250YWluZXIvbGF5b3V0LWNvbnRhaW5lci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUVILE9BQU8sRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLFNBQVMsRUFBcUIsaUJBQWlCLEVBQTRCLE1BQU0sZUFBZSxDQUFDO0FBQzVILE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSwyQkFBMkIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQzs7Ozs7Ozs7QUFTOUUsTUFBTSxPQUFPLHdCQUF3QjtBQUFHLElBd0JwQztBQUNKLFFBbEJhLGdCQUFXLEdBQUcsS0FBSyxDQUFDO0FBQ2pDLFFBQWEsb0JBQWUsR0FBRyxJQUFJLENBQUM7QUFDcEMsUUFFYSxhQUFRLEdBQW9CLE9BQU8sQ0FBQztBQUNqRCxRQUVhLGNBQVMsR0FBYyxLQUFLLENBQUM7QUFDMUMsUUFNSSxtQkFBYyxHQUFHLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxFQUFFLEVBQUUsQ0FBQztBQUMvRCxRQUFJLG1CQUFjLEdBQUcsRUFBRSxNQUFNLEVBQUUsRUFBRSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRSxDQUFDO0FBQy9ELFFBRVEsSUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FB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Q2IsU0FBUztBQUNULElBQUksQ0FBQztBQUNMLElBQ1ksa0JBQWtCO0FBQUssUUFDM0IsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDO0FBQ2xFLFFBQVEsSUFBSSxDQUFDLHFCQUFxQixHQUFHLElBQUksQ0FBQyx1QkFBdUIsQ0FBQztBQUNsRSxJQUFJLENBQUM7QUFDTDtvREFySUMsU0FBUyxTQUFDLGtCQUNQLFFBQVEsRUFBRSxzQkFBc0I7VUFDaEM7Ozs7O29VQUFnRCxrQkFDaEQsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUksa0JBQ3JDLFVBQVUsRUFBRSxDQUFDLGdCQUFnQixFQUFFLGdCQUFnQixDQUFDLGNBQ25EOzs7Ozs7Ozs7Ozs7Ozs7OztxS0FDSTtBQUFDO0FBQW9EO0FBQ3BDLHlCQUFqQixLQUFLO0FBQUsseUJBQ1YsS0FBSztBQUFLLDZCQUdWLEtBQUs7QUFBSywwQkFFVixLQUFLO0FBQUssOEJBQ1YsS0FBSztBQUFLLHVCQUdWLEtBQUs7QUFBSyx3QkFHVixLQUFLO0FBQUssc0JBRVYsU0FBUyxTQUFDLFVBQVUsRUFBRSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFBTTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEFsZnJlc2NvIFNvZnR3YXJlLCBMdGQuXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmltcG9ydCB7IENvbXBvbmVudCwgSW5wdXQsIFZpZXdDaGlsZCwgT25Jbml0LCBPbkRlc3Ryb3ksIFZpZXdFbmNhcHN1bGF0aW9uLCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IE1hdFNpZGVuYXYgfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9zaWRlbmF2JztcbmltcG9ydCB7IHNpZGVuYXZBbmltYXRpb24sIGNvbnRlbnRBbmltYXRpb24gfSBmcm9tICcuLi8uLi9oZWxwZXJzL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgRGlyZWN0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY2RrL2JpZGknO1xuXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ2FkZi1sYXlvdXQtY29udGFpbmVyJyxcbiAgICB0ZW1wbGF0ZVVybDogJy4vbGF5b3V0LWNvbnRhaW5lci5jb21wb25lbnQuaHRtbCcsXG4gICAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgICBhbmltYXRpb25zOiBbc2lkZW5hdkFuaW1hdGlvbiwgY29udGVudEFuaW1hdGlvbl1cbn0pXG5leHBvcnQgY2xhc3MgTGF5b3V0Q29udGFpbmVyQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBPbkRlc3Ryb3ksIE9uQ2hhbmdlcyB7XG4gICAgQElucHV0KCkgc2lkZW5hdk1pbjogbnVtYmVyO1xuICAgIEBJbnB1dCgpIHNpZGVuYXZNYXg6IG51bWJlcjtcblxuICAgIC8vIFwiIHwgYW55XCIsIGJlY2F1c2UgU2FmYXJpIHRocm93cyBhbiBlcnJvciBvdGhlcndpc2UuLi5cbiAgICBASW5wdXQoKSBtZWRpYVF1ZXJ5TGlzdDogTWVkaWFRdWVyeUxpc3QgfCBhbnk7XG5cbiAgICBASW5wdXQoKSBoaWRlU2lkZW5hdiA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIGV4cGFuZGVkU2lkZW5hdiA9IHRydWU7XG5cbiAgICAvKiogVGhlIHNpZGUgdGhhdCB0aGUgZHJhd2VyIGlzIGF0dGFjaGVkIHRvICdzdGFydCcgfCAnZW5kJyBwYWdlICovXG4gICAgQElucHV0KCkgcG9zaXRpb246ICdzdGFydCcgfCAnZW5kJyA9ICdzdGFydCc7XG5cbiAgICAvKiogTGF5b3V0IHRleHQgb3JpZW50YXRpb24gJ2x0cicgfCAncnRsJyAqL1xuICAgIEBJbnB1dCgpIGRpcmVjdGlvbjogRGlyZWN0aW9uID0gJ2x0cic7XG5cbiAgICBAVmlld0NoaWxkKE1hdFNpZGVuYXYsIHsgc3RhdGljOiB0cnVlIH0pIHNpZGVuYXY6IE1hdFNpZGVuYXY7XG5cbiAgICBzaWRlbmF2QW5pbWF0aW9uU3RhdGU6IGFueTtcbiAgICBjb250ZW50QW5pbWF0aW9uU3RhdGU6IGFueTtcblxuICAgIFNJREVOQVZfU1RBVEVTID0geyBNT0JJTEU6IHt9LCBFWFBBTkRFRDoge30sIENPTVBBQ1Q6IHt9IH07XG4gICAgQ09OVEVOVF9TVEFURVMgPSB7IE1PQklMRToge30sIEVYUEFOREVEOiB7fSwgQ09NUEFDVDoge30gfTtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm9uTWVkaWFRdWVyeUNoYW5nZSA9IHRoaXMub25NZWRpYVF1ZXJ5Q2hhbmdlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIHRoaXMuU0lERU5BVl9TVEFURVMuTU9CSUxFID0geyB2YWx1ZTogJ2V4cGFuZGVkJywgcGFyYW1zOiB7IHdpZHRoOiB0aGlzLnNpZGVuYXZNYXggfSB9O1xuICAgICAgICB0aGlzLlNJREVOQVZfU1RBVEVTLkVYUEFOREVEID0geyB2YWx1ZTogJ2V4cGFuZGVkJywgcGFyYW1zOiB7IHdpZHRoOiB0aGlzLnNpZGVuYXZNYXggfSB9O1xuICAgICAgICB0aGlzLlNJREVOQVZfU1RBVEVTLkNPTVBBQ1QgPSB7IHZhbHVlOiAnY29tcGFjdCcsIHBhcmFtczogeyB3aWR0aDogdGhpcy5zaWRlbmF2TWluIH0gfTtcblxuICAgICAgICB0aGlzLkNPTlRFTlRfU1RBVEVTLk1PQklMRSA9IHsgdmFsdWU6ICdleHBhbmRlZCcgfTtcblxuICAgICAgICB0aGlzLm1lZGlhUXVlcnlMaXN0LmFkZExpc3RlbmVyKHRoaXMub25NZWRpYVF1ZXJ5Q2hhbmdlKTtcblxuICAgICAgICBpZiAodGhpcy5pc01vYmlsZVNjcmVlblNpemUpIHtcbiAgICAgICAgICAgIHRoaXMuc2lkZW5hdkFuaW1hdGlvblN0YXRlID0gdGhpcy5TSURFTkFWX1NUQVRFUy5NT0JJTEU7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRBbmltYXRpb25TdGF0ZSA9IHRoaXMuQ09OVEVOVF9TVEFURVMuTU9CSUxFO1xuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZXhwYW5kZWRTaWRlbmF2KSB7XG4gICAgICAgICAgICB0aGlzLnNpZGVuYXZBbmltYXRpb25TdGF0ZSA9IHRoaXMuU0lERU5BVl9TVEFURVMuRVhQQU5ERUQ7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRBbmltYXRpb25TdGF0ZSA9IHRoaXMudG9nZ2xlZENvbnRlbnRBbmltYXRpb247XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNpZGVuYXZBbmltYXRpb25TdGF0ZSA9IHRoaXMuU0lERU5BVl9TVEFURVMuQ09NUEFDVDtcbiAgICAgICAgICAgIHRoaXMuY29udGVudEFuaW1hdGlvblN0YXRlID0gdGhpcy50b2dnbGVkQ29udGVudEFuaW1hdGlvbjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgICAgICB0aGlzLm1lZGlhUXVlcnlMaXN0LnJlbW92ZUxpc3RlbmVyKHRoaXMub25NZWRpYVF1ZXJ5Q2hhbmdlKTtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgICAgIGlmIChjaGFuZ2VzICYmIGNoYW5nZXMuZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRBbmltYXRpb25TdGF0ZSA9IHRoaXMudG9nZ2xlZENvbnRlbnRBbmltYXRpb247XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0b2dnbGVNZW51KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc01vYmlsZVNjcmVlblNpemUpIHtcbiAgICAgICAgICAgIHRoaXMuc2lkZW5hdi50b2dnbGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2lkZW5hdkFuaW1hdGlvblN0YXRlID0gdGhpcy50b2dnbGVkU2lkZW5hdkFuaW1hdGlvbjtcbiAgICAgICAgICAgIHRoaXMuY29udGVudEFuaW1hdGlvblN0YXRlID0gdGhpcy50b2dnbGVkQ29udGVudEFuaW1hdGlvbjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBpc01vYmlsZVNjcmVlblNpemUoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLm1lZGlhUXVlcnlMaXN0Lm1hdGNoZXM7XG4gICAgfVxuXG4gICAgZ2V0Q29udGVudEFuaW1hdGlvblN0YXRlKCk6IGFueSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRlbnRBbmltYXRpb25TdGF0ZTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldCB0b2dnbGVkU2lkZW5hdkFuaW1hdGlvbigpOiBhbnkge1xuICAgICAgICByZXR1cm4gdGhpcy5zaWRlbmF2QW5pbWF0aW9uU3RhdGUgPT09IHRoaXMuU0lERU5BVl9TVEFURVMuRVhQQU5ERURcbiAgICAgICAgICAgID8gdGhpcy5TSURFTkFWX1NUQVRFUy5DT01QQUNUXG4gICAgICAgICAgICA6IHRoaXMuU0lERU5BVl9TVEFURVMuRVhQQU5ERUQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXQgdG9nZ2xlZENvbnRlbnRBbmltYXRpb24oKTogYW55IHtcbiAgICAgICAgaWYgKHRoaXMuaXNNb2JpbGVTY3JlZW5TaXplKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5DT05URU5UX1NUQVRFUy5NT0JJTEU7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zaWRlbmF2QW5pbWF0aW9uU3RhdGUgPT09IHRoaXMuU0lERU5BVl9TVEFURVMuRVhQQU5ERUQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBvc2l0aW9uID09PSAnc3RhcnQnICYmIHRoaXMuZGlyZWN0aW9uID09PSAnbHRyJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiAnY29tcGFjdCcsIHBhcmFtczogeyAnbWFyZ2luLWxlZnQnOiB0aGlzLnNpZGVuYXZNYXggfSB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5wb3NpdGlvbiA9PT0gJ3N0YXJ0JyAmJiB0aGlzLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogJ2NvbXBhY3QnLCBwYXJhbXM6IHsgJ21hcmdpbi1yaWdodCc6IHRoaXMuc2lkZW5hdk1heCB9IH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBvc2l0aW9uID09PSAnZW5kJyAmJiB0aGlzLmRpcmVjdGlvbiA9PT0gJ2x0cicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogJ2NvbXBhY3QnLCBwYXJhbXM6IHsgJ21hcmdpbi1yaWdodCc6IHRoaXMuc2lkZW5hdk1heCB9IH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBvc2l0aW9uID09PSAnZW5kJyAmJiB0aGlzLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogJ2NvbXBhY3QnLCBwYXJhbXM6IHsgJ21hcmdpbi1sZWZ0JzogdGhpcy5zaWRlbmF2TWF4IH0gfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucG9zaXRpb24gPT09ICdzdGFydCcgJiYgdGhpcy5kaXJlY3Rpb24gPT09ICdsdHInKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6ICdleHBhbmRlZCcsIHBhcmFtczogeyAnbWFyZ2luLWxlZnQnOiB0aGlzLnNpZGVuYXZNaW4gfSB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5wb3NpdGlvbiA9PT0gJ3N0YXJ0JyAmJiB0aGlzLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogJ2V4cGFuZGVkJywgcGFyYW1zOiB7ICdtYXJnaW4tcmlnaHQnOiB0aGlzLnNpZGVuYXZNaW4gfSB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5wb3NpdGlvbiA9PT0gJ2VuZCcgJiYgdGhpcy5kaXJlY3Rpb24gPT09ICdsdHInKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6ICdleHBhbmRlZCcsIHBhcmFtczogeyAnbWFyZ2luLXJpZ2h0JzogdGhpcy5zaWRlbmF2TWluIH0gfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMucG9zaXRpb24gPT09ICdlbmQnICYmIHRoaXMuZGlyZWN0aW9uID09PSAncnRsJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiAnZXhwYW5kZWQnLCBwYXJhbXM6IHsgJ21hcmdpbi1sZWZ0JzogdGhpcy5zaWRlbmF2TWluIH0gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgb25NZWRpYVF1ZXJ5Q2hhbmdlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnNpZGVuYXZBbmltYXRpb25TdGF0ZSA9IHRoaXMuU0lERU5BVl9TVEFURVMuRVhQQU5ERUQ7XG4gICAgICAgIHRoaXMuY29udGVudEFuaW1hdGlvblN0YXRlID0gdGhpcy50b2dnbGVkQ29udGVudEFuaW1hdGlvbjtcbiAgICB9XG59XG4iXX0=